# 快速幂

快速幂（Fast Power）是一种高效的幂运算算法，其时间复杂度为O(log₂N)，与朴素的O(N)算法相比，效率有了极大的提高。以下是对快速幂的详细解释：

## 一、定义与原理

* **定义**：快速幂就是快速算底数的n次幂，即计算a的b次方（a^b）。
* **原理**：快速幂算法的核心思想是利用幂运算的特性进行优化。对于任意整数a和非负整数n，可以将a^n分解为更小的幂运算的组合。具体来说，通过二进制分解指数，将指数逐渐减半，同时底数做平方运算，从而大大减少乘法运算的次数。
    >原理 ACM快速幂算法的核心思想是利用幂运算的特性进行优化。对于任意整数 a 和非负整数 n，可以将 a^n 分解为 a^(n/2) * a^(n/2)。通过递归调用快速幂算法，可以将计算次数从 n 降低到 n/2，从而大大减少了计算量。当 n 为奇数时，可以通过多乘一个 a 来补全。 作者：一点冷知识儿 [https://www.bilibili.com/read/cv24300887/] 出处：bilibili

## 二、实现方法

快速幂算法的实现方法通常有两种：递归版和非递归版（也称为迭代版）。

* **递归版**：通过递归调用快速幂函数，每次将指数减半，直到指数为0时返回1。在递归过程中，根据指数的奇偶性选择是否多乘一个底数。
* **非递归版**：使用循环来实现快速幂算法。通常将指数转换为二进制数，然后逐位处理。对于二进制表示中的每一位，如果为1，则将当前结果乘以底数的相应幂次；如果为0，则不乘。同时，每次循环都将底数平方，并将指数右移一位。

## 三、应用场景

快速幂算法在多个领域有广泛的应用，包括但不限于：

* **大数运算**：当进行大数的幂运算时，传统方法可能会面临内存溢出或计算时间过长的问题。快速幂算法通过分治和递归的优化，可以有效地解决这些问题。
* **模幂运算**：在密码学和数据安全领域中，模幂运算是常见的操作。快速幂算法可以高效计算模幂运算，使得数据加密和解密等过程更加快速和安全。
* **优化算法**：快速幂算法可以在一些数学问题的求解中提供高效的优化。例如，计算Fibonacci数列、计算组合数、矩阵的快速幂等问题都可以借助快速幂算法来加速计算过程。

## 四、示例代码

以下是快速幂算法的非递归版C++实现示例：

```cpp
int fastpow(int a, int n) {
    int ans = 1; // 用ans作为返回值
    while (n) { // 把n看作二进制数，逐个处理最后一位
        if (n & 1) ans *= a; // 如果n的最后一位为1，表示这个地方需要乘. 为啥需要乘，因为奇数次要单独 *a
        a *= a; // 递推a^1, a^2, a^4...  这里就是偶数次，a = a*a 
        n >>= 1; // 把n右移一位, 循环直接 /2，减少了循环次数。
    }
    return ans;
}
```

对于模幂运算，可以在上述代码的基础上进行取模操作，以防止整数溢出：

```cpp
ll fastpow(ll a, ll n, ll mod) {
    ll ans = 1; // 用ans作为返回值
    a %= mod; // 在一定程度上防止a*a越界
    while (n) { // 把n看作二进制数，逐个处理最后一位
        if (n & 1) ans = (ans * a) % mod; // 如果n的最后一位为1，表示这个地方需要乘
        a = (a * a) % mod; // 递推a^1, a^2, a^4...
        n >>= 1; // 把n右移一位
    }
    return ans;
}
```

综上所述，快速幂算法是一种高效计算幂运算的算法，通过分治和二进制分解的思想，可以大大提高计算效率。它在多个领域有广泛的应用价值，是算法竞赛和计算机科学领域中的重要工具。
