# 文件读写

在 Objective-C 中，文件读写是一个常见的操作，可以通过多种方式实现。以下是一些常用的文件读写方法：

## 1. 使用 `NSString` 的 `stringByAppendingPathComponent:` 方法

这个方法可以用来构建文件路径。

```objc
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"file" ofType:@"txt"];
```

## 2. 使用 `NSData` 和 `NSString` 的读写方法

`NSData` 可以用来读取和写入二进制数据，而 `NSString` 提供了将字符串写入文件的方法。

### 写入字符串到文件

```objc
NSString *content = @"This is the content of the file.";
[content writeToFile:filePath atomically:YES encoding:NSUTF8StringEncoding error:nil];
```

### 从文件读取字符串

```objc
NSString *contentFromFile = [NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];
```

## 3. 使用 `NSFileManager` 检查文件是否存在

`NSFileManager` 是文件系统的基础类，可以用来查询文件是否存在。

```objc
NSFileManager *fileManager = [NSFileManager defaultManager];
BOOL fileExists = [fileManager fileExistsAtPath:filePath];
```

## 4. 使用 `NSData` 读写二进制数据

如果需要读写非文本数据，可以使用 `NSData`。

### 写入 `NSData` 到文件

```objc
NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
[data writeToFile:filePath atomically:YES];
```

### 从文件读取 `NSData`

```objc
NSData *dataFromFile = [NSData dataWithContentsOfFile:filePath];
```

## 5. 使用文件流（`NSInputStream` 和 `NSOutputStream`）

对于更复杂的读写操作，可以使用文件流。

### 写入文件流

```objc
NSOutputStream *outputStream = [NSOutputStream outputStreamToFileAtPath:filePath append:NO];
[outputStream open];
[outputStream write:[content dataUsingEncoding:NSUTF8StringEncoding]];
[outputStream close];
```

### 读取文件流

```objc
NSInputStream *inputStream = [NSInputStream inputStreamWithFileAtPath:filePath];
[inputStream open];
NSMutableData *readData = [NSMutableData dataWithCapacity:1024];
while ([inputStream hasBytesAvailable]) {
    [readData appendBytes:[inputStream read:1024]];
}
[inputStream close];
NSString *contentFromStream = [[NSString alloc] initWithData:readData encoding:NSUTF8StringEncoding];
```

## 6. 使用 `FileManager` 的高级功能

`FileManager` 类提供了许多高级功能，如复制、移动、删除文件等。

### 创建目录

```objc
NSString *directoryPath = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents"];
[fileManager createDirectoryAtPath:directoryPath withIntermediateDirectories:YES attributes:nil error:nil];
```

### 删除文件

```objc
[fileManager removeItemAtPath:filePath error:nil];
```

## 注意事项

- 处理文件读写时，始终要检查错误，并为用户提供相应的反馈。
- 使用 `atomically:YES` 参数可以确保写操作的原子性，避免数据损坏。
- 根据需要选择合适的编码方式，如 UTF-8、ASCII 等。
- 确保在应用程序的适当位置请求用户权限，以访问文件系统。

通过这些方法，你可以在 Objective-C 应用程序中实现基本的文件读写操作。
