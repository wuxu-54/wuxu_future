# 操作符

以下是 Rust 语言的操作符大全及其详细说明，按功能分类整理：

---

## 一、**算术操作符**

| 操作符 | 名称       | 示例                | 备注                                                                 |
|--------|------------|---------------------|----------------------------------------------------------------------|
| `+`    | 加法       | `a + b`             | 数值相加，或字符串拼接（`String` + `&str`）                          |
| `-`    | 减法       | `a - b`             | 数值相减                                                             |
| `*`    | 乘法       | `a * b`             | 数值相乘                                                             |
| `/`    | 除法       | `a / b`             | 整数除法会截断（如 `5 / 2` = `2`），浮点数除法保留小数               |
| `%`    | 取模       | `a % b`             | 结果的符号与被除数相同（如 `-5 % 3` = `-2`）                        |
| `-`    | 负号       | `-a`                | 数值取反                                                             |

**注意**：  

- 整数溢出在 **Debug 模式**下会 panic，**Release 模式**下自动使用二进制补码环绕（可通过 `Wrapping<T>` 显式控制）。

---

## 二、**比较操作符**

| 操作符 | 名称           | 示例         | 返回类型  |
|--------|----------------|--------------|-----------|
| `==`   | 等于           | `a == b`     | `bool`    |
| `!=`   | 不等于         | `a != b`     | `bool`    |
| `>`    | 大于           | `a > b`      | `bool`    |
| `<`    | 小于           | `a < b`      | `bool`    |
| `>=`   | 大于等于       | `a >= b`     | `bool`    |
| `<=`   | 小于等于       | `a <= b`     | `bool`    |

**注意**：  

- 比较操作符的实现依赖于 `PartialEq` 和 `PartialOrd` trait。

---

## 三、**逻辑操作符**

| 操作符 | 名称       | 示例         | 备注                          |
|--------|------------|--------------|-------------------------------|
| `&&`   | 逻辑与     | `a && b`     | 短路求值（若 `a` 为 `false`，不执行 `b`） |
| &#124;&#124;   | 逻辑或     | `a` &#124;&#124; `b`    | 短路求值（若 `a` 为 `true`，不执行 `b`）  |
| `!`    | 逻辑非     | `!a`         | 布尔取反                       |

---

## 四、**位运算操作符**

| 操作符 | 名称           | 示例         | 备注                          |
|--------|----------------|--------------|-------------------------------|
| `&`    | 按位与         | `a & b`      | 二进制位与操作                |
| &#124;    | 按位或         | `a` &#124; `b`      | 二进制位或操作                |
| `^`    | 按位异或       | `a ^ b`      | 二进制位异或操作              |
| `<<`   | 左移位         | `a << b`     | 左移 `b` 位（高位丢弃，低位补0） |
| `>>`   | 右移位         | `a >> b`     | 右移 `b` 位（无符号数补0，有符号数补符号位） |
| `!`    | 按位取反       | `!a`         | 二进制位取反                  |

---

## 五、**赋值操作符**

| 操作符 | 名称           | 示例          | 等价于       |
|--------|----------------|---------------|--------------|
| `=`    | 赋值           | `a = b`       | -            |
| `+=`   | 加法赋值       | `a += b`      | `a = a + b`  |
| `-=`   | 减法赋值       | `a -= b`      | `a = a - b`  |
| `*=`   | 乘法赋值       | `a *= b`      | `a = a * b`  |
| `/=`   | 除法赋值       | `a /= b`      | `a = a / b`  |
| `%=`   | 取模赋值       | `a %= b`      | `a = a % b`  |
| `&=`   | 按位与赋值     | `a &= b`      | `a = a & b`  |
| &#124;=   | 按位或赋值     | `a` &#124;= `b`      | `a = a` &#124; `b`  |
| `^=`   | 按位异或赋值   | `a ^= b`      | `a = a ^ b`  |
| `<<=`  | 左移赋值       | `a <<= b`     | `a = a << b` |
| `>>=`  | 右移赋值       | `a >>= b`     | `a = a >> b` |

---

## 六、**类型转换操作符**

| 操作符 | 名称       | 示例          | 备注                                                                 |
|--------|------------|---------------|----------------------------------------------------------------------|
| `as`   | 类型转换   | `x as i32`    | 用于基本类型之间的转换（如 `u8` 转 `i32`），或指针转换（需谨慎使用） |

**注意**：  

- `as` 不会检查数值是否溢出（如 `300u16 as u8` 会截断为 `44`）。

---

## 七、**范围操作符**

| 操作符 | 名称           | 示例               | 用途                          |
|--------|----------------|--------------------|-------------------------------|
| `start..end`   | 左闭右开范围   | `0..5`             | 生成 `0, 1, 2, 3, 4`          |
| `start..=end`  | 闭区间范围     | `0..=5`            | 生成 `0, 1, 2, 3, 4, 5`       |
| `..`   | 全范围         | `..`               | 用于模式匹配（如 `match x { 1..=5 => ... }`） |

全范围补充：

- `..end`：表示小于 end 的所有值。
- `start..`：表示大于等于 start 的所有值。
- `..`：表示所有可能的值。

```rust
fn main() {
    let numbers = vec![1, 2, 3, 4, 5];

    // 从索引 2 到结尾
    let slice1 = &numbers[2..];
    println!("从索引 2 到结尾: {:?}", slice1);

    // 从开头到索引 3（不包含）
    let slice2 = &numbers[..3];
    println!("从开头到索引 3（不包含）: {:?}", slice2);

    // 所有元素
    let slice3 = &numbers[..];
    println!("所有元素: {:?}", slice3);

    let num = 5;
    match num {
        ..=3 => println!("小于等于 3"),
        4..=6 => println!("在 4 到 6 之间"),
        7.. => println!("大于等于 7"),
        _ => println!("其他情况"),
    }
}    
```

---

## 八、**借用与解引用操作符**

| 操作符 | 名称       | 示例        | 用途                          |
|--------|------------|-------------|-------------------------------|
| `&`    | 借用       | `&x`        | 创建不可变引用                |
| `&mut` | 可变借用   | `&mut x`    | 创建可变引用（需变量本身为 `mut`） |
| `*`    | 解引用     | `*x`        | 访问引用指向的值（需在 `unsafe` 或实现 `Deref` 时使用） |

---

## 九、**错误处理操作符**

| 操作符 | 名称       | 示例          | 用途                          |
|--------|------------|---------------|-------------------------------|
| `?`    | 错误传播   | `let x = f()?;` | 自动将 `Result` 或 `Option` 的 `Err`/`None` 提前返回 |

---

## 十、**其他符号操作符**

| 符号        | 用途                                                                 |
|-------------|----------------------------------------------------------------------|
| `.`         | 方法调用（如 `x.len()`）或访问结构体字段（如 `point.x`）             |
| `::`        | 关联函数或模块路径（如 `std::io::stdin()`）                          |
| `@`         | 模式绑定（如 `x @ 1..=5` 表示匹配范围并绑定到 `x`）                  |
| `..`        | 结构体更新语法（如 `let p2 = Point { x: 1, ..p1 }`）                |
| `_`         | 忽略值（如 `let _ = x;`）或类型占位符（如 `let x: Vec<_> = ...`）   |
| `move`      | 强制闭包捕获所有权（如 `move` &#124;&#124; `x`）                                |

---

## 十一、**操作符优先级表**

从高到低排列（同一行优先级相同）：

| 优先级 | 操作符                                  |
|--------|-----------------------------------------|
| 最高   | `?`                                     |
|        | `[]` `()` `.` `::`                     |
|        | `!` `-` `*` `&` `&mut`                 |
|        | `as`                                    |
|        | `*` `/` `%`                            |
|        | `+` `-`                                |
|        | `<<` `>>`                              |
|        | `&`                                    |
|        | `^`                                    |
|        | &#124;                                    |
|        | `==` `!=` `<` `>` `<=` `>=`            |
|        | `&&`                                   |
|        | &#124;&#124;                                   |
|        | `..` `..=`                             |
|        | `=` `+=` `-=` 等赋值操作符             |

---

## 十二、**总结**

1. **严格类型系统**：Rust 的操作符要求操作数类型匹配，避免隐式转换。
2. **所有权与借用**：借用操作符（`&`/`&mut`）和解引用（`*`）直接影响所有权规则。
3. **错误处理**：`?` 操作符简化了错误传播逻辑。
4. **无运算符重载**：Rust 允许通过实现 `std::ops` trait 重载部分操作符（如 `Add`、`Mul`）。

**示例代码**：

```rust
// 类型转换
let x: u8 = 255;
let y = x as i32; // y = 255

// 错误传播
fn read_file() -> Result<String, std::io::Error> {
    let content = std::fs::read_to_string("file.txt")?;
    Ok(content)
}

// 范围操作符
for i in 1..=5 {
    println!("{}", i); // 输出 1 到 5
}
```

建议通过实际编码练习掌握操作符的具体行为！
