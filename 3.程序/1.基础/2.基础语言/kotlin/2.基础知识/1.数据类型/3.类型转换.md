# 数据类型转换

在Kotlin中，类型转换指的是将一个类型的值转换为另一个类型的值。Kotlin提供了几种类型转换的方式，包括安全转换和非安全转换。以下是一些常用的类型转换方法：

1. **安全调用操作符 (`?.`)**：
   当不确定一个对象是否不为`null`时，可以使用安全调用操作符来避免`NullPointerException`。（其他如swift叫可选操作符）

   ```kotlin
   val length = string?.length
   ```

2. **非安全转换 (!!)**：
   使用非安全转换操作符可以断言一个对象不为`null`，但如果对象为`null`，将抛出`NullPointerException`。

   ```kotlin
   val length = string!!.length
   ```

3. **自动类型转换**：
   Kotlin在某些情况下会自动进行类型转换，例如，从子类到超类或接口的转换。

   ```kotlin
   open class Animal
   class Dog : Animal()
   val dog: Dog = Dog()
   val animal: Animal = dog // 自动类型转换
   ```

4. **显式类型转换**：
   使用`as`关键字进行显式类型转换，但需要注意，如果转换不兼容，将抛出`ClassCastException`。

   ```kotlin
   val animal: Animal = "not an animal"
   val dog: Dog = animal as Dog // 错误的类型转换，将抛出异常
   ```

5. **安全类型转换**：
   使用`as?`进行安全类型转换，如果转换不兼容，将返回`null`。

   ```kotlin
   val animal: Animal = "not an animal"
   val dog: Dog? = animal as? Dog // 安全的类型转换，dog 将是 null
   ```

6. **数字类型转换**：
   使用数字类型的转换函数，如`toInt()`, `toDouble()`等，将数字转换为不同的数字类型。

   ```kotlin
   val number = 123
   val floatNumber = number.toFloat()
   ```

7. **字符和字符串转换**：
   使用`Char`和`String`的构造函数或`toString()`方法进行转换。

   ```kotlin
   val char: Char = 'A'
   val stringFromChar = char.toString()
   val charFromString = string[0]
   ```

8. **可空类型转换**：
   对于可空类型，可以使用`?:`操作符进行类型转换，同时处理`null`情况。

   ```kotlin
   val string: String? = "Kotlin"
   val length = string?.length ?: 0

   val x: String = y as String
   val x: String? = y as String?//可空不能转换为非空
   ```

9. **集合类型转换**：
   使用集合的`map`, `filter`, `filterNotNull`等函数进行元素的类型转换。

   ```kotlin
   val list: List<String?> = listOf("Kotlin", null, "Programming")
   val filteredList = list.filterNotNull() // 过滤掉null元素
   ```

10. **类型检查与转换**：
    使用`is`关键字进行类型检查，然后使用`as`或`as?`进行转换。

    ```kotlin
    val any = "Hello"
    if (any is String) {
        val length = any.length // any 被识别为 String 类型
    }
    ```

Kotlin的类型系统是灵活的，提供了多种方式来进行类型转换，同时保持代码的安全性和表达性。开发者应根据实际情况选择合适的转换方式。

---

## 基础数据类型转换

在Kotlin中，基础数据类型之间的转换通常指的是将一种原始数据类型的值转换为另一种。这些转换可以是隐式的，也就是说，编译器会自动进行类型转换，当转换是安全的时候；也可以是显式的，需要开发者明确指定。以下是一些常见的基础数据类型转换：

### 1. 整数类型转换

- **从小范围类型到大范围类型**（隐式转换）:

  ```kotlin
  val byte: Byte = 1
  val int: Int = byte // 自动转换为更大范围的整数类型
  ```

- **从大范围类型到小范围类型**（显式转换）:

  ```kotlin
  val int: Int = 1
  val byte: Byte = int.toByte() // 显式转换，可能会有精度损失
  ```

### 2. 浮点类型转换

- **转换为更高精度类型**（隐式转换）:

  ```kotlin
  val float: Float = 1.0f
  val double: Double = float // 自动转换为更高精度的浮点类型
  ```

- **转换为较低精度类型**（显式转换）:

  ```kotlin
  val double: Double = 1.0
  val float: Float = double.toFloat() // 显式转换，可能会有精度损失
  ```

### 3. 整数与浮点类型转换

- **从整数到浮点**（隐式转换）:

  ```kotlin
  val int: Int = 1
  val double: Double = int // 自动转换为浮点类型
  ```

- **从浮点到整数**（显式转换）:

  ```kotlin
  val double: Double = 1.9
  val int: Int = double.toInt() // 显式转换，小数部分将被截断
  ```

### 4. 字符类型转换

- **从整数到字符**（显式转换）:

  ```kotlin
  val int: Int = 65
  val char: Char = int.toChar() // 将整数值转换为对应的ASCII字符
  ```

- **从字符到整数**（隐式转换）:

  ```kotlin
  val char: Char = 'A'
  val int: Int = char // 字符自动转换为其ASCII码的整数值
  ```

- **从字符到整数**（显式转换）:

  ```kotlin
  val char: Char = 'A'
  val int: Int = char.digitToInt() // 字符显示转换为整数值
  ```

### 5. 字符串与基本数据类型的相互转换

- **从基本数据类型到字符串**（隐式转换）:

  ```kotlin
  val int: Int = 123
  val string: String = int // 基本数据类型自动转换为字符串
  ```

- **从字符串到基本数据类型**（显式转换，需要转换函数）:

  ```kotlin
  val string: String = "123"
  val int: Int = string.toInt() // 字符串显式转换为整数
  ```

### 注意事项

- 当进行显式类型转换时，特别是从大范围类型转换到小范围类型时，可能会发生精度损失或数据溢出。在这种情况下，Kotlin要求显式调用相应的转换函数，如`toInt()`, `toDouble()`, `toFloat()`, `toByte()`, `toChar()`等。
- 隐式转换通常是安全的，但也要注意在特定情况下可能会有意外的数据丢失或类型不匹配问题。
- 使用字符串转换为数值类型时，如果字符串不是有效的数值格式，将抛出`NumberFormatException`。

通过这些转换，Kotlin提供了灵活的方式来处理不同类型的数据，并确保数据类型的正确性和程序的健壮性。
