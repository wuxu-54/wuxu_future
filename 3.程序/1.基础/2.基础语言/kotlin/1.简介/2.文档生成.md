# 文档生成

在 Kotlin 中生成文档，你可以使用 Dokka，这是 Kotlin 推荐的文档生成工具。以下是使用 Dokka 生成 Kotlin 源代码文档的步骤：

## 1. 添加 Dokka 到你的项目

如果你使用的是 Gradle 作为构建工具，你可以在 `build.gradle.kts`（Kotlin DSL）或 `build.gradle`（Groovy DSL）文件中添加 Dokka 插件。

**对于 Kotlin DSL (`build.gradle.kts`):**

```kotlin
plugins {
    kotlin("jvm") version "1.6.0" // 确保使用与你的 Kotlin 版本相匹配的版本号
    id("org.jetbrains.dokka") version "1.6.0" // Dokka 的版本号
}

// 确保你的项目已经应用了 'kotlin("jvm")' 插件
```

**对于 Groovy DSL (`build.gradle`):**

```groovy
plugins {
    id 'org.jetbrains.kotlin.jvm' version '1.6.0' // 确保使用与你的 Kotlin 版本相匹配的版本号
    id 'org.jetbrains.dokka' version '1.6.0' // Dokka 的版本号
}

// 确保你的项目已经应用了 'kotlin-jvm' 插件
```

## 2. 配置 Dokka 插件

你可以在 Gradle 脚本中配置 Dokka 插件来指定输出格式和目录等。

**Kotlin DSL (`build.gradle.kts`) 示例配置:**

```kotlin
tasks.named<DokkaTask>("dokkaHtml") {
    outputDirectory.set(buildDir.resolve("docs"))
    // 其他配置...
}
```

**Groovy DSL (`build.gradle`) 示例配置:**

```groovy
tasks.named('dokkaHtml', DokkaTask) {
    outputDirectory = buildDir.resolve("docs")
    // 其他配置...
}
```

## 3. 生成文档

配置完成后，你可以通过运行相应的 Gradle 任务来生成文档：

```shell
./gradlew dokkaHtml
```

这将生成 HTML 格式的文档，输出到你在配置中指定的目录。

## 4. 查看生成的文档

生成的文档将位于你在 Dokka 配置中指定的输出目录中。你可以直接打开生成的 `index.html` 文件来查看文档。

## 注意事项

- 确保你使用的 Dokka 版本与你的 Kotlin 版本兼容。
- Dokka 支持多种输出格式，包括 HTML、Javadoc、Markdown 等。你可以根据需要选择合适的格式。
- 如果你的项目同时包含 Kotlin 和 Java 代码，Dokka 也可以生成它们的联合文档。

Dokka 是一个非常强大的工具，它不仅可以从你的 Kotlin 代码注释中生成文档，还可以集成源代码、生成类和成员索引等。你可以在 [Dokka 的官方文档](https://kotlinlang.org/docs/dokka-gradle.html)中找到更多关于配置和使用 Dokka 的信息。

---

## Android项目完整示例

1. 根Gradle配置plugins，dokka版本要尽量与kotlin插件的版本一致

    ```groovy
    plugins {
        id 'org.jetbrains.dokka' version '1.9.20'
    }
    ```

    ![步骤1](../images/%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90-dokka-1.png)

2. app或module的gradle引入插件

    ```groovy
    plugins {
        id 'org.jetbrains.dokka'
    }
    ```

    ![步骤2](../images/%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90-dokka-2.png)

3. 在app或module的gradle里设置task任务，配置导出信息

    ```groovy
        // 配置导出信息
    tasks.dokkaJavadoc.configure {
        // 导出的文档目录路径
        outputDirectory.set(new File(rootDir, "doc"))
        dokkaSourceSets {
            named("main") {
                noAndroidSdkLink.set(true)
                noStdlibLink.set(true)
                noJdkLink.set(true)
            }
            configureEach {
                // 包的定义
                includes.from("packages.md")
            }
        }
    }
    ```

    ![步骤3](../images/%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90-dokka-3.png)

4. 创建`packages.md`文件，与步骤3 `includes.from("packages.md")`里面相同路径，内容可以为空。

    ![步骤4](../images/%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90-dokka-4.png)
