# 简介

---

**TOML（Tom's Obvious, Minimal Language）** 是一种专注于可读性和简洁性的配置文件格式，由 GitHub 联合创始人 Tom Preston-Werner 设计。它旨在取代 JSON、YAML 或传统的 `.properties` 文件，特别适合人类编写和阅读的配置场景（如项目配置、环境变量管理）。以下是 TOML 的核心特性和详细用法。

---

## **1. TOML 的核心特点**

- **明确的语法**：结构清晰，无歧义，避免 YAML 的缩进陷阱。
- **强类型支持**：支持字符串、整数、浮点数、布尔值、日期时间等数据类型。
- **嵌套结构**：通过表格（Table）和数组表格（Array of Tables）实现多层配置。
- **注释支持**：以 `#` 开头的单行注释。
- **跨语言支持**：主流编程语言（如 Python、Rust、Java、Go）均有解析库。

---

## **2. 基本语法**

### **2.1 键值对**

```toml
# 字符串（双引号或单引号）
name = "TOML Example"
version = '1.0.0'

# 数值
port = 8080
ratio = 3.14

# 布尔值
debug = true

# 日期时间
timestamp = 2023-10-05T12:34:56Z
```

### **2.2 多行字符串**

使用 `"""` 或 `'''`：

```toml
description = """
This is a multi-line
string in TOML.
"""
```

### **2.3 数组**

使用方括号 `[]`，元素类型需一致：

```toml
ports = [80, 443, 8080]
colors = ["red", "green", "blue"]
```

### **2.4 表格（嵌套结构）**

通过 `[table]` 定义一级表格：

```toml
[database]
host = "localhost"
port = 3306
username = "admin"
```

### **2.5 点分隔符定义嵌套表格**

```toml
# 等效于 [database.server]
database.server.host = "db.example.com"
database.server.port = 3306
```

### **2.6 数组表格**

使用 `[[table]]` 定义数组内的多个表格对象：

```toml
[[servers]]
name = "server1"
ip = "192.168.1.1"

[[servers]]
name = "server2"
ip = "192.168.1.2"
```

---

## **3. 高级特性**

### **3.1 内联表格**

使用 `{}` 定义紧凑的嵌套结构：

```toml
[database]
connection = { host = "localhost", port = 3306, timeout = 30 }
```

### **3.2 多行数组**

通过换行和逗号分隔：

```toml
dependencies = [
  "toml4j",
  "log4j",
  "junit",
]
```

### **3.3 特殊数据类型**

- **日期时间**：支持 ISO 8601 格式。

  ```toml
  event_time = 2023-10-05T12:34:56+08:00
  ```

- **十六进制/二进制/八进制数**：

  ```toml
  hex = 0xDEADBEEF
  binary = 0b11010110
  octal = 0o755
  ```

---

## **4. 注释**

以 `#` 开头，仅支持单行注释：

```toml
# 这是全局配置
title = "TOML Demo"
```

---

## **5. 完整示例**

```toml
# 全局配置
name = "My App"
version = "1.0.0"
env = "production"

# 数据库配置
[database]
host = "localhost"
port = 3306
credentials = { username = "admin", password = "secret" }

# 服务器列表（数组表格）
[[servers]]
name = "web-server"
ip = "192.168.1.10"
ports = [80, 443]

[[servers]]
name = "db-server"
ip = "192.168.1.20"
ports = [3306]

# 日志配置
[logging]
level = "info"
rotation = { enabled = true, max_size = "100MB", keep_days = 7 }
```

---

## **6. 与其他格式对比**

| 特性               | TOML                          | YAML              | JSON               | .properties       |
|--------------------|-------------------------------|-------------------|--------------------|-------------------|
| **可读性**         | ⭐️⭐️⭐️⭐️⭐️         | ⭐️⭐️⭐️⭐️       | ⭐️⭐️             | ⭐️⭐️⭐️         |
| **嵌套支持**       | 表格和数组表格                | 缩进或 `{}`       | 对象和数组         | 无                |
| **注释**           | 支持（`#`）                   | 支持（`#`）       | 不支持             | 支持（`#`或`!`）  |
| **类型系统**       | 强类型（日期、数值等）        | 弱类型            | 弱类型             | 字符串            |
| **适用场景**       | 配置文件                      | 配置文件/数据序列化 | API 数据交换       | 简单键值对配置    |

---

## **7. 在 Java 中使用 TOML**

Java 生态中可通过以下库解析 TOML：

- **toml4j**：轻量级解析库。

  ```xml
  <dependency>
      <groupId>com.moandjiezana.toml</groupId>
      <artifactId>toml4j</artifactId>
      <version>0.7.2</version>
  </dependency>
  ```

- **示例代码**：

  ```java
  import com.moandjiezana.toml.Toml;
  
  public class TomlDemo {
      public static void main(String[] args) {
          Toml toml = new Toml().read(new File("config.toml"));
          String dbHost = toml.getString("database.host");
          List<Map<String, Object>> servers = toml.getList("servers");
      }
  }
  ```

---

## **8. 适用场景**

- **项目配置**：如 Rust 的 `Cargo.toml`、Python 的 `pyproject.toml`。
- **环境变量管理**：替代 `.env` 文件。
- **静态站点生成**：如 Hugo 的 `config.toml`。
- **微服务配置**：集中管理多环境参数。

---

## **9. 注意事项**

- **键名规则**：仅允许字母、数字、下划线和连字符（不能以数字开头）。
- **大小写敏感**：`Key` 和 `key` 视为不同。
- **避免过度嵌套**：深层嵌套会降低可读性。

---

## **10. 官方资源**

- TOML 官方规范：[toml.io](https://toml.io)
- 在线验证工具：[TOML Lint](https://www.toml-lint.com)

---

TOML 凭借其简洁性和明确性，成为现代开发中配置管理的理想选择。对于需要强类型和清晰结构的场景，它是 JSON 或 YAML 的优质替代方案。
