# 模块解析跟踪

通过`--traceResolution`诊断模块为什么没有被解析，或解析到了错误的位置，它会告诉我们在模块解析过程中发生了什么。（就是编译时输出模块解析过程）

## 使用

假设我们有一个使用了typescript模块的简单应用。 app.ts里有一个这样的导入`import * as ts from "typescript"`。

```txt
│   tsconfig.json
├───node_modules
│   └───typescript
│       └───lib
│               typescript.d.ts
└───src
        app.ts
```

使用`--traceResolution`调用编译器。

```txt
tsc --traceResolution
```

输出结果:

```txt
======== Resolving module 'typescript' from 'src/app.ts'. ========
Module resolution kind is not specified, using 'NodeJs'.
Loading module 'typescript' from 'node_modules' folder.
File 'src/node_modules/typescript.ts' does not exist.
File 'src/node_modules/typescript.tsx' does not exist.
File 'src/node_modules/typescript.d.ts' does not exist.
File 'src/node_modules/typescript/package.json' does not exist.
File 'node_modules/typescript.ts' does not exist.
File 'node_modules/typescript.tsx' does not exist.
File 'node_modules/typescript.d.ts' does not exist.
Found 'package.json' at 'node_modules/typescript/package.json'.
'package.json' has 'types' field './lib/typescript.d.ts' that references 'node_modules/typescript/lib/typescript.d.ts'.
File 'node_modules/typescript/lib/typescript.d.ts' exist - use it as a module resolution result.
======== Module name 'typescript' was successfully resolved to 'node_modules/typescript/lib/typescript.d.ts'. ========
```

需要留意的地方

1. 导入的名字及位置

    ======== Resolving module 'typescript' from 'src/app.ts'. ========

2. 编译器使用的策略
    Module resolution kind is not specified, using 'NodeJs'.

3. 从npm加载types
    'package.json' has 'types' field './lib/typescript.d.ts' that references 'node_modules/typescript/lib/typescript.d.ts'.

4. 最终结果
    ======== Module name 'typescript' was successfully resolved to 'node_modules/typescript/lib/typescript.d.ts'. ========

## 使用`--noResolve`

正常来讲编译器会在开始编译之前解析模块导入。 每当它成功地解析了对一个文件 import，这个文件被会加到一个文件列表里，以供编译器稍后处理。

`--noResolve`编译选项告诉编译器，不要添加【不在命令行上写的文件】到编译列表。 编译器仍然会尝试解析模块，但是只要没有指定这个文件，那么它就不会被包含在内。

例如：  

app.ts

```txt
import * as A from "moduleA" // OK, moduleA passed on the command-line
import * as B from "moduleB" // Error TS2307: Cannot find module 'moduleB'.
```

```txt
tsc app.ts moduleA.ts --noResolve
```

使用--noResolve编译app.ts：

* 可能正确找到moduleA，因为它在命令行上指定了。
* 找不到moduleB，因为没有在命令行上传递。
