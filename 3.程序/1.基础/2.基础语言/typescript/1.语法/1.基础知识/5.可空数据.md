
# 可空数据

在JavaScript（包括TypeScript，它是JavaScript的一个超集）中，可空数据（Nullable Data）指的是可以是某个类型，也可以是`null`的数据。在TypeScript中，你可以使用联合类型来表示一个可空的数据类型。

## TypeScript中的可空数据

在TypeScript中，要表示一个变量可以是某个类型或者`null`，你可以使用以下语法：

```typescript
let value: string | null;
```

这里，`value`可以被赋值为一个`string`类型的值，或者`null`。

### 示例

```typescript
// 声明一个可空的字符串
let name: string | null = null;

// 给可空字符串赋值
name = "Kimi";

// 使用可空字符串
if (name !== null) {
    console.log("The name is:", name);
} else {
    console.log("Name is null");
}
```

## 使用`null`类型

从TypeScript 3.1开始，你可以使用`null`类型来更明确地表示一个位置预期是`null`：

```typescript
let value: null;
```

这里的`value`只能被赋值为`null`。

## 非空断言

在TypeScript中，如果你确定一个可空的变量实际上不是`null`，你可以使用非空断言操作符`!`来告诉编译器你确定这个值不是`null`：

```typescript
let name: string | null = "Kimi";

// 使用非空断言
console.log(name!.toUpperCase()); // 不会报错，因为我们知道name不是null
```

请注意，如果`name`实际上是`null`，运行时会抛出一个错误，因为`null`值上没有`toUpperCase`方法。

## 可选属性或参数

后面函数章节会有可选参数，这里提前说一下。可以将类的属性或函数参数通过`?:`声明为可选，即可赋值，通过可选链使用。

```ts
class T{
    let val?:number//可选属性

    function method(val?:number)//可选参数
}
```

## 使用`?.`可选链

在访问嵌套的对象属性时，如果不确定某个属性是否存在，可以使用可选链操作符`?.`来避免在属性不存在时抛出错误：

```typescript
let user = {
    name: "Kimi"
};

let userName = user?.name; // 如果user是null或undefined，userName将是undefined而不是抛出错误
```

示例2：

```typescript
function getName(user: Person | null): string | undefined {
    return user?.name;
}

const name = getName(person); // 如果 person 是 null，name 将是 undefined
```

## 使用`??`设定默认值

当可选链最后为空时，可通过`??`设定默认值。

```ts
user?.name??"默认名字"
```

## 使用`!`非空断言和`?.`可选链

- 使用`!`非空断言时，你需要确保变量实际上不是`null`或`undefined`，否则在运行时可能会遇到错误。
- 使用`?.`可选链是一种更安全的方式，它允许你访问深层嵌套的属性而不会因为中间的`null`或`undefined`而抛出错误。

在TypeScript中处理可空数据时，这些特性可以帮助你写出更安全、更清晰的代码。
