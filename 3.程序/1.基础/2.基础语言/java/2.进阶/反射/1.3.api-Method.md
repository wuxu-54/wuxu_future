# Method常见属性和api

在 Java 反射中，`java.lang.reflect.Method` 类用于表示类或接口的方法。下面详细列举 `Method` 类的属性和常用 API：

## 属性

`Method` 类本身没有公共的实例属性，但它继承了 `AccessibleObject` 类的 `override` 属性（不过该属性是受保护的，通常不会直接访问），`override` 用于指示该对象的可访问性是否被重写。

## 常用 API

### 1. 基本信息获取

- **`String getName()`**
  - **作用**：返回此 `Method` 对象所表示的方法的名称。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    public void myMethod() {}
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod");
        System.out.println(method.getName()); // 输出: myMethod
    }
}
```

- **`Class<?> getDeclaringClass()`**
  - **作用**：返回声明此 `Method` 对象所表示的方法的类或接口的 `Class` 对象。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    public void myMethod() {}
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod");
        System.out.println(method.getDeclaringClass().getName()); // 输出: MyClass
    }
}
```

- **`Class<?>[] getParameterTypes()`**
  - **作用**：按照声明顺序返回 `Method` 对象所表示的方法的形参类型的 `Class` 对象数组。如果方法没有参数，则返回一个长度为 0 的数组。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    public void myMethod(int param1, String param2) {}
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod", int.class, String.class);
        Class<?>[] paramTypes = method.getParameterTypes();
        for (Class<?> paramType : paramTypes) {
            System.out.println(paramType.getName());
        }
    }
}
```

- **`Class<?> getReturnType()`**
  - **作用**：返回 `Method` 对象所表示的方法的返回类型的 `Class` 对象。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    public String myMethod() {
        return "";
    }
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod");
        System.out.println(method.getReturnType().getName()); // 输出: java.lang.String
    }
}
```

- **`Class<?>[] getExceptionTypes()`**
  - **作用**：返回此 `Method` 对象所表示的方法可能抛出的异常类型的 `Class` 对象数组。如果方法没有声明抛出异常，则返回一个长度为 0 的数组。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    public void myMethod() throws Exception {}
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod");
        Class<?>[] exceptionTypes = method.getExceptionTypes();
        for (Class<?> exceptionType : exceptionTypes) {
            System.out.println(exceptionType.getName()); // 输出: java.lang.Exception
        }
    }
}
```

### 2. 修饰符相关

- **`int getModifiers()`**
  - **作用**：返回此 `Method` 对象所表示的方法的 Java 语言修饰符，修饰符由 `java.lang.reflect.Modifier` 类中的静态常量表示。
  - **示例**：

```java
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;

class MyClass {
    public static void myMethod() {}
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod");
        int modifiers = method.getModifiers();
        System.out.println(Modifier.isPublic(modifiers)); // 输出: true
        System.out.println(Modifier.isStatic(modifiers)); // 输出: true
    }
}
```

### 3. 方法调用

- **`Object invoke(Object obj, Object... args)`**
  - **作用**：对带有指定参数的指定对象调用此 `Method` 对象所表示的底层方法。如果底层方法是静态的，则可以将 `obj` 参数设为 `null`。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    public int add(int a, int b) {
        return a + b;
    }
}

public class Main {
    public static void main(String[] args) throws Exception {
        MyClass obj = new MyClass();
        Method method = MyClass.class.getMethod("add", int.class, int.class);
        int result = (int) method.invoke(obj, 1, 2);
        System.out.println(result); // 输出: 3
    }
}
```

### 4. 泛型相关

- **`Type getGenericReturnType()`**
  - **作用**：返回表示由此 `Method` 对象所表示方法的正式返回类型的 `Type` 对象，支持泛型类型。
- **`Type[] getGenericParameterTypes()`**
  - **作用**：按照声明顺序返回表示此 `Method` 对象所表示方法的形参类型的 `Type` 对象数组，支持泛型类型。

### 5. 注解相关

- **`<T extends Annotation> T getAnnotation(Class<T> annotationClass)`**
  - **作用**：如果该元素上存在指定类型的注解，则返回这些注解，否则返回 `null`。
  - **示例**：

```java
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import java.lang.reflect.Method;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@interface MyAnnotation {
    String value();
}

class MyClass {
    @MyAnnotation("Hello")
    public void myMethod() {}
}

public class Main {
    public static void main(String[] args) throws NoSuchMethodException {
        Method method = MyClass.class.getMethod("myMethod");
        MyAnnotation annotation = method.getAnnotation(MyAnnotation.class);
        if (annotation != null) {
            System.out.println(annotation.value()); // 输出: Hello
        }
    }
}
```

- **`Annotation[] getAnnotations()`**
  - **作用**：返回此元素上存在的所有注解。

### 6. 可访问性控制

- **`void setAccessible(boolean flag)`**
  - **作用**：设置此 `Method` 对象的可访问标志。如果 `flag` 为 `true`，则表示可以访问私有方法；如果 `flag` 为 `false`，则恢复默认的访问规则。
  - **示例**：

```java
import java.lang.reflect.Method;

class MyClass {
    private void privateMethod() {
        System.out.println("Private method called");
    }
}

public class Main {
    public static void main(String[] args) throws Exception {
        MyClass obj = new MyClass();
        Method method = MyClass.class.getDeclaredMethod("privateMethod");
        method.setAccessible(true);
        method.invoke(obj);
    }
}
```

以上是 `Method` 类的一些主要属性和 API，通过这些方法可以在运行时动态地获取方法的信息并调用方法。
