# Node

`Node` 类是 Groovy 提供的一个用于表示和操作 XML 数据的类。它简化了 XML 的创建、解析和修改过程。以下是对 `Node` 类的详细解释，包括其常用方法和用法示例。

## Node 类概述

`Node` 类用于表示 XML 文档中的一个节点（元素）。每个 `Node` 对象可以有子节点、属性和文本内容。`Node` 类通常与 `groovy.xml.DOMBuilder` 或 `groovy.xml.XmlParser` 一起使用来解析 XML，或者与 `groovy.xml.MarkupBuilder` 一起使用来生成 XML。

## 创建 Node 对象

### 使用 `new Node()`

```groovy
import groovy.util.Node

// 创建一个名为 'dependency' 的根节点
Node node = new Node(null, 'dependency')
```

- **参数**：
  - 第一个参数：父节点（可以为 `null` 表示没有父节点）。
  - 第二个参数：节点名称（例如 `'dependency'`）。

### 使用 `MarkupBuilder`

```groovy
import groovy.xml.MarkupBuilder

def writer = new StringWriter()
def xml = new MarkupBuilder(writer)
def dependencyNode = xml.dependency {
    groupId('com.example')
    artifactId('my-library')
    version('1.0.0')
    scope('compile')
}

println writer.toString()
```

## 添加子节点

### 使用 `appendNode()`

```groovy
node.appendNode('groupId', 'com.example')
node.appendNode('artifactId', 'my-library')
node.appendNode('version', '1.0.0')
node.appendNode('scope', 'compile')
```

- **`appendNode(String name, Object value)`**：添加一个子节点，指定子节点的名称和值。

### 1使用 `children()`

```groovy
node.children().add(new Node(node, 'groupId', [value: 'com.example']))
```

## 获取子节点

### 2使用 `children()`

```groovy
def children = node.children()
children.each { child ->
    println "Child node: ${child.name()}, Value: ${child.value()}"
}
```

### 使用 `name()` 和 `value()`

```groovy
def groupIdNode = node.'groupId'
println "Group ID: ${groupIdNode.value()}"
```

## 设置和获取属性

### 设置属性

```groovy
node.attributes()['type'] = 'runtime'
```

### 获取属性

```groovy
def type = node.attributes()['type']
println "Type attribute: ${type}"
```

## 遍历节点

### 使用 `each()`

```groovy
node.each { child ->
    println "Node: ${child.name()}, Value: ${child.value()}"
}
```

### 使用递归遍历

```groovy
def traverse(Node node) {
    println "Node: ${node.name()}, Value: ${node.value()}"
    node.children().each { child ->
        traverse(child)
    }
}

traverse(node)
```

## 示例：完整 XML 构建

```groovy
import groovy.util.Node

// 创建根节点
Node root = new Node(null, 'project')

// 添加依赖项节点
Node dependencies = new Node(root, 'dependencies')
root.appendNode(dependencies)

// 添加单个依赖项
Node dependency = getDependencyNode('compile', 'com.example', 'my-library', '1.0.0')
dependencies.appendNode(dependency)

// 打印生成的 XML
def writer = new StringWriter()
def printer = new XmlNodePrinter(new PrintWriter(writer))
printer.preserveWhitespace = true
printer.print(root)

println writer.toString()

// 辅助方法
static def getDependencyNode(scope, groupId, artifactId, version) {
    Node node = new Node(null, 'dependency')
    node.appendNode('groupId', groupId)
    node.appendNode('artifactId', artifactId)
    node.appendNode('version', version)
    node.appendNode('scope', scope)
    return node
}
```

## 总结

`Node` 类提供了丰富的功能来创建、操作和遍历 XML 数据。通过结合 `appendNode()`、`children()`、`attributes()` 等方法，你可以轻松地构建和修改复杂的 XML 结构。在 Gradle 构建脚本中，`Node` 类常用于动态生成或解析 Maven 或其他基于 XML 的配置文件。
