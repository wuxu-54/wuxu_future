# groovy使用JMX

Groovy 提供了对 Java Management Extensions (JMX) 的支持，允许开发者通过 Groovy 脚本来管理和监控 Java 应用程序。
>android 开发用不上JMX

以下是使用 Groovy 进行 JMX 操作的一些基本概念和步骤：

1. **MBean 管理**：
   - MBean（Managed Bean）是 JMX 的核心概念，代表可以被监控和管理的资源或服务。

2. **JMX 连接**：
   - 要使用 JMX，首先需要与 JMX 服务器建立连接。在 Groovy 中，可以使用 `MBeanServerConnection` 来实现。

3. **查询 MBean**：
   - 通过 JMX 连接，可以查询服务器上注册的 MBean。使用 `queryMBeans` 方法可以根据名称或其他属性查找 MBean。

4. **获取和设置 MBean 属性**：
   - 通过 `getAttribute` 和 `setAttribute` 方法，可以获取和设置 MBean 的属性值。

5. **调用 MBean 操作**：
   - 使用 `invoke` 方法可以调用 MBean 的操作，这类似于调用 Java 对象的方法。

6. **MBean 通知**：
   - MBean 可以发送通知（Notification），Groovy 脚本可以注册监听器来接收这些通知。

7. **JMX 脚本示例**：

   ```groovy
   import javax.management.*
   import java.lang.management.ManagementFactory

   def mBeanServer = ManagementFactory.getPlatformMBeanServer()

   // 查询 MBean
   def mbeans = mBeanServer.queryMBeans(null, null)

   // 获取 MBean 属性
   def attrValue = mBeanServer.getAttribute(mbeans[0], "AttributeName")

   // 设置 MBean 属性
   mBeanServer.setAttribute(mbeans[0], new Attribute("AttributeName", newValue))

   // 调用 MBean 操作
   def result = mBeanServer.invoke(mbeans[0], "OperationName", [param1, param2] as Object[], [String, String] as String[])
   ```

8. **JMX 通知监听**：

   ```groovy
   def listener = [
       'handleNotification': { notification, handback ->
           println "Received notification: $notification"
       }
   ] as NotificationListener

   def filter = null // 可以定义一个通知过滤器
   def handback = null // 可以定义一个回调参数

   mBeanServer.addNotificationListener(mbeans[0], listener, filter, handback)
   ```

9. **使用 JMX 库**：
   - 确保项目中包含了 JMX 相关的库。如果使用 Gradle，可以在 `build.gradle` 中添加依赖：

     ```groovy
     dependencies {
         implementation 'javax.management:jmxri:1.2.1'
     }
     ```

通过上述步骤，你可以使用 Groovy 脚本来管理和监控 Java 应用程序的 JMX MBean。这种方式简化了 JMX 操作，并且可以轻松集成到 Groovy 应用程序中。
