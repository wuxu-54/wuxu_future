# 注解

Groovy 注解（Annotations）是一种特殊的接口，用于在代码中标记特定的元素（如类、方法、属性等），以便在编译时、运行时或部署时进行处理。
>Groovy注解其实同Java含义、使用方式相同。

以下是 Groovy 注解的详解和示例：

## 1. 注解定义

使用 `@interface` 关键字定义注解，注解成员以方法的形式定义，但没有方法体和可选的默认值。

```groovy
@interface MyAnnotation {
    String value() default "defaultValue";
}
```

## 2. 应用注解

使用 `@` 符号将注解应用于类、方法、属性等。

```groovy
@MyAnnotation(value = "Groovy")
class MyClass {
    // ...
}
```

## 3. 注解成员值

在使用注解时，需要为所有没有默认值的成员提供值。

```groovy
@interface Status {
    int code();
}

@Status(code = 200)
class MyStatusClass {
    // ...
}
```

## 4. 闭包注解参数

Groovy 允许使用闭包作为注解的参数值，这为注解提供了极高的灵活性。

```groovy
@interface Conditional {
    Closure condition();
}

@Conditional({ args.size() > 0 })
void myMethod(String[] args) {
    // ...
}
```

## 5. 元注解

元注解（Meta-annotations）是一种注解，用于注解其他注解。Groovy 提供了几种内置的元注解，如 `@Target` 和 `@Retention`。

```groovy
@Target([ElementType.METHOD])
@Retention(RetentionPolicy.RUNTIME)
@interface MyMetaAnnotation {
    // ...
}
```

## 6. 注解集合

使用 `@AnnotationCollector` 可以创建一个注解集合，将多个注解合并为一个。

```groovy
import groovy.transform.AnnotationCollector

@interface MyAnnotation1 {
    // ...
}

@interface MyAnnotation2 {
    // ...
}

@AnnotationCollector([MyAnnotation1, MyAnnotation2])
@interface MyCombinedAnnotation {
    // ...
}
```

## 示例

以下是一些 Groovy 注解的示例：

```groovy
// 定义一个简单的注解
@interface SimpleAnnotation {
    String value() default "Hello, World!";
}

// 使用注解
@SimpleAnnotation
class MyClass {
    // ...
}

// 定义一个带有枚举类型的注解
enum DayOfWeek {
    MON, TUE, WED, THU, FRI, SAT, SUN
}

@interface Scheduled {
    DayOfWeek day();
}

// 使用注解
@Scheduled(day = DayOfWeek.MON)
void myMethod() {
    // ...
}

// 定义一个带有闭包参数的注解
@interface Conditional {
    Closure condition();
}

// 使用注解
@Conditional({ true })
void myConditionalMethod() {
    // ...
}

// 定义一个元注解
@AnnotationCollector
@interface MyCombinedAnnotation {
    // ...
}

// 使用元注解
@MyCombinedAnnotation
class MyAnnotatedClass {
    // ...
}
```

注解在 Groovy 中非常有用，特别是在需要元数据信息来支持 AOP、依赖注入或其他框架功能时。

---

## 元注解

在 Groovy 中，元注解（Meta-annotations）是一种特殊的注解，用于注解其他注解。元注解提供了关于注解本身的信息，例如它们可以应用于哪些元素，以及它们在运行时的保留策略。以下是一些常用的元注解：

### 1. `@Target`

`@Target` 元注解用于指定注解可以应用于哪些元素，例如类、方法、属性、参数等。

```groovy
import java.lang.annotation.ElementType
import java.lang.annotation.Retention
import java.lang.annotation.RetentionPolicy
import java.lang.annotation.Target

@Retention(RetentionPolicy.RUNTIME)
@Target([ElementType.METHOD, ElementType.TYPE]) // 应用于方法和类
@interface MyCustomAnnotation {
    // 注解定义
}
```

### 2. `@Retention`

`@Retention` 元注解用于定义注解的保留策略，即注解信息在什么阶段可用。保留策略有以下几种：

- `RetentionPolicy.SOURCE`：注解仅在源码中保留，编译时丢弃。
- `RetentionPolicy.CLASS`：注解在类加载时保留，运行时丢弃。
- `RetentionPolicy.RUNTIME`：注解在运行时保留，可以通过反射读取。

```groovy
@Retention(RetentionPolicy.RUNTIME)
@interface MyRuntimeAnnotation {
    // 注解定义
}
```

### 3. `@Documented`

`@Documented` 元注解用于指示注解应该被包含在 JavaDoc 中。

```groovy
@Documented
@interface MyDocumentedAnnotation {
    // 注解定义
}
```

### 4. `@Inherited`

`@Inherited` 元注解用于指示注解是继承的，这意味着子类会继承父类的注解。

```groovy
@Inherited
@interface MyInheritedAnnotation {
    // 注解定义
}
```

### 5. `@AnnotationCollector`

`@AnnotationCollector` 是 Groovy 特有的元注解，用于将多个注解合并为一个注解。

```groovy
import groovy.transform.AnnotationCollector

@AnnotationCollector
@interface MyCombinedAnnotation {
    // 注解定义
}
```

### 元注解示例

以下是使用元注解的示例：

```groovy
// 定义一个注解，使用 @Target 和 @Retention 元注解
@Target([ElementType.METHOD, ElementType.TYPE])
@Retention(RetentionPolicy.RUNTIME)
@interface MyCustomAnnotation {
    String value() default "Default Value";
}

// 定义一个注解，使用 @Documented 元注解
@Documented
@interface MyDocumentedAnnotation {
    // 注解定义
}

// 使用自定义注解
@MyCustomAnnotation(value = "Groovy")
class MyClass {
    @MyCustomAnnotation("Method Value")
    void myMethod() {
        // 方法实现
    }
}

// 使用文档化注解
@MyDocumentedAnnotation
class MyDocumentedClass {
    // 类实现
}
```

元注解是 Groovy 注解系统的重要组成部分，它们提供了注解的元数据，使得注解更加灵活和强大。
