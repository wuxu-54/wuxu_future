# XmlSlurper

在 Groovy 中处理 XML 数据相对简单，因为 Groovy 提供了对 XML 的良好支持。

以下是一些在 Groovy 中操作 XML 的基本方法：

## 1. 解析 XML

Groovy 提供了 `groovy.xml.XmlSlurper` 类来解析 XML 文档。它允许你以流式方式读取 XML，并且可以使用 XPath 表达式进行节点查询。

```groovy
import groovy.xml.XmlSlurper

def xml = '''
<books>
    <book>
        <title>Groovy in Action</title>
        <author>Dierk König</author>
    </book>
</books>
'''

def slurper = new XmlSlurper()
def books = slurper.parseText(xml)

books.book.each { book ->
    println "Title: ${book.title.text()}"
    println "Author: ${book.author.text()}"
}
```

## 2. 生成 XML

使用 `groovy.xml.XmlUtil` 和 `groovy.xml.StreamingMarkupBuilder` 可以生成 XML 内容。

```groovy
import groovy.xml.XmlUtil
import groovy.xml.StreamingMarkupBuilder

def builder = new StreamingMarkupBuilder()
def xml = builder.bind {
    books {
        for (book in books) {
            book {
                title(book.title)
                author(book.author)
            }
        }
    }
}

def resultXml = XmlUtil.serialize(xml)
println resultXml
```

## 3. 处理 XML 属性

`XmlSlurper` 允许你访问 XML 元素的属性。

```groovy
def attrXml = '<root id="1">Content</root>'

def root = new XmlSlurper().parseText(attrXml)
println "ID: ${root.'@id'.text()}"
```

## 4. 修改 XML

你可以使用 `groovy.xml.XmlUtil` 来修改 XML 节点或属性。

```groovy
import groovy.xml.XmlUtil

def xmlString = '<root><child>Old Value</child></root>'
def root = new XmlSlurper().parseText(xmlString)

root.child.replaceBody('New Value')

def newXmlString = XmlUtil.serialize(root)
println newXmlString
```

## 5. 使用 XPath 表达式

`XmlSlurper` 支持使用 XPath 表达式来查询 XML 文档。

```groovy
def nodes = slurper.select('book')
nodes.each { node ->
    println "Title: ${node.title.text()}"
}
```

## 6. 解析 XML 文件

你可以直接从文件中解析 XML。

```groovy
def file = new File('books.xml')
def books = new XmlSlurper().parse(file)
```

## 7. 处理命名空间

XMLSlurper 允许你注册命名空间以简化节点查询。

```groovy
def slurper = new XmlSlurper()
slurper.setNamespace('h', 'http://www.w3.org/TR/html4/')
def nodes = slurper.parseText(xml).'h:body'.'h:table'
```
