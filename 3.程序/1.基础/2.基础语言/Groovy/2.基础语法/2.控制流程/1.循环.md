# 循环

Groovy 提供了几种循环结构，允许你重复执行代码块直到满足特定条件。以下是 Groovy 中循环的详解和示例：

## 1. For 循环

`for` 循环用于遍历集合、数组、范围或任何实现了 `Iterable` 接口的对象。

```groovy
for (int i = 0; i < 10; i++) {
    println i
}

for (item in ['apple', 'banana', 'cherry']) {
    println item
}

for (key in ['key1': 'value1', 'key2': 'value2']) {
    println "${key.key} = ${key.value}"
}
```

## 2. While 循环

`while` 循环会在给定的条件为真时不断执行代码块。

```groovy
int i = 0
while (i < 5) {
    println i
    i++
}
```

## 3. Do-While 循环

`do-while` 循环至少执行一次代码块，然后检查条件。如果条件为真，则继续循环。

```groovy
int i = 0
do {
    println i
    i++
} while (i < 5)
```

## 4. 增强的 For-Each 循环

Groovy 允许使用更简洁的 `for-in` 语法来遍历集合、数组等。

```groovy
def fruits = ['apple', 'banana', 'cherry']
for (fruit in fruits) {
    println fruit
}
```

## 5. 迭代器循环

使用迭代器进行循环，这在处理大型集合时非常有用。

```groovy
def iterator = fruits.iterator()
while (iterator.hasNext()) {
    println iterator.next()
}
```

## 6. 闭包的 each 循环

Groovy 的集合和数组支持 `each` 方法，它接受一个闭包作为参数，对集合中的每个元素执行闭包。

```groovy
fruits.each { println it }
```

## 7. 闭包的 findAll 循环

使用 `findAll` 方法和闭包来找到满足条件的所有元素。

```groovy
def longVowels = ['aeiouAEIOU'].findAll { it in 'aeiou' }
println longVowels
```

## 8. 闭包的 any/every/none 循环

这些方法接受一个闭包作为参数，并根据闭包返回的布尔值来确定结果。

```groovy
boolean hasApple = fruits.any { it == 'apple' }
boolean allFruitsLong = fruits.every { it.size() > 4 }
boolean noFruitShort = fruits.none { it.size() < 4 }
```

## 9. 闭包的 collect 循环

`collect` 方法接受一个闭包，并返回一个新的集合，其中包含原始集合中每个元素应用闭包后的结果。

```groovy
def lengths = fruits.collect { it.size() }
println lengths
```

## 10. 闭包的 inject 循环

`inject` 方法接受一个初始值和一个闭包，闭包将应用于集合中的所有元素，并返回一个累积结果。

```groovy
def sum = fruits.inject(0) { sum, fruit -> sum + fruit.size() }
println sum
```

## 11. 闭包的 withIndex 循环

`withIndex` 方法返回一个包含原始元素和它们索引的新集合。

```groovy
fruits.withIndex().each { fruit, index -> println "$index: $fruit" }
```

---

## 循环控制

Groovy 语言中的循环控制语句允许你在循环执行过程中进行更细致的控制。以下是一些常用的循环控制语句及其用法：

### 1. `break`

`break` 语句用于立即终止当前循环的执行，无论是 `for`、`while` 还是 `do-while` 循环。

```groovy
for (int i = 0; i < 10; i++) {
    if (i == 5) {
        break // 当 i 等于 5 时，退出循环
    }
    println i
}
```

### 2. `continue`

`continue` 语句用于跳过当前循环迭代的剩余部分，并立即开始下一次迭代。

```groovy
for (int i = 0; i < 10; i++) {
    if (i % 2 == 0) {
        continue // 跳过偶数，只打印奇数
    }
    println i
}
```

### 3. 标签

在 Groovy 中，可以使用标签来标识循环，使得 `break` 或 `continue` 可以应用于特定的循环。

```groovy
outer: for (int i = 0; i < 3; i++) {
    for (int j = 0; j < 3; j++) {
        if (i == 1 && j == 1) {
            break outer // 退出外层循环
        }
        println "i: $i, j: $j"
    }
}
```

### 4. 循环内的 `return`

在循环内使用 `return` 语句可以立即退出当前方法，并返回一个值。

```groovy
def findFirstNegative(numbers) {
    for (num in numbers) {
        if (num < 0) {
            return num // 找到第一个负数并返回
        }
    }
    return null
}
```

### 5. 循环控制的闭包

Groovy 允许在集合操作中使用闭包作为循环控制的一种方式。例如，使用 `takeWhile` 和 `dropWhile` 方法：

```groovy
def numbers = [1, 2, 3, -1, -2, -3]
def positiveNumbers = numbers.takeWhile { it > 0 } // 取到第一个非正数之前的所有元素
println positiveNumbers

def remainingNumbers = numbers.dropWhile { it > 0 } // 丢弃到第一个非正数之前的所有元素
println remainingNumbers
```

### 6. 使用 `find` 或 `findAll`

`find` 方法用于查找第一个满足条件的元素，而 `findAll` 用于查找所有满足条件的元素。

```groovy
def firstNegative = numbers.find { it < 0 } // 查找第一个负数
println firstNegative

def allNegatives = numbers.findAll { it < 0 } // 查找所有负数
println allNegatives
```

### 7. 使用 `collect` 和 `inject`

`collect` 方法可以对集合中的每个元素应用一个闭包，并收集结果。`inject` 方法则用于累加计算。

```groovy
def squares = numbers.collect { it * it } // 收集每个数字的平方
println squares

def sum = numbers.inject(0) { sum, num -> sum + num } // 计算数字总和
println sum
```

### 8. 使用 `any` 和 `every`

`any` 方法检查集合中是否至少有一个元素满足条件，而 `every` 方法检查集合中的所有元素是否都满足条件。

```groovy
boolean hasNegative = numbers.any { it < 0 } // 检查是否有负数
println hasNegative

boolean allPositive = numbers.every { it > 0 } // 检查是否所有数字都是正数
println allPositive
```
