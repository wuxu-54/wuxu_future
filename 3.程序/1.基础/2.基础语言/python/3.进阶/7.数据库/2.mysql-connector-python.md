# mysql-connector-python

`mysql-connector-python` 是 MySQL 官方提供的用于 Python 3 的驱动程序，用于连接和操作 MySQL 数据库。以下是使用 `mysql-connector-python` 的详解和示例。

## 安装 `mysql-connector-python`

首先，确保安装了 `mysql-connector-python`：

```sh
pip install mysql-connector-python
```

## 连接 MySQL 数据库

使用 `mysql-connector-python` 连接数据库的基本代码：

```python
import mysql.connector

# 连接数据库
connection = mysql.connector.connect(
    host='localhost',
    user='your_username',
    password='your_password',
    database='your_database'
)
```

- `host`: 数据库服务器地址，通常是 `'localhost'`。
- `user`: 数据库用户名。
- `password`: 用户密码。
- `database`: 要连接的数据库名。

## 创建游标对象并执行 SQL 语句

```python
# 创建游标对象
cursor = connection.cursor()

# 执行 SQL 语句
sql = "SELECT * FROM your_table"
try:
    cursor.execute(sql)
    # 获取所有查询结果
    results = cursor.fetchall()
    for row in results:
        print(row)
except Exception as e:
    print(e)
```

## 插入数据

使用 `execute()` 方法插入数据：

```python
insert_sql = "INSERT INTO your_table (column1, column2) VALUES (%s, %s)"
values = ('value1', 'value2')

try:
    cursor.execute(insert_sql, values)
    connection.commit()  # 提交事务
except Exception as e:
    connection.rollback()  # 回滚事务
    print(e)
```

## 更新和删除数据

更新和删除操作与插入类似，需要提交事务：

```python
update_sql = "UPDATE your_table SET column1 = %s WHERE column2 = %s"
delete_sql = "DELETE FROM your_table WHERE column1 = %s"

try:
    cursor.execute(update_sql, ('new_value', 'condition'))
    cursor.execute(delete_sql, ('condition',))
    connection.commit()
except Exception as e:
    connection.rollback()
    print(e)
```

## 完整的数据库操作示例

```python
import mysql.connector

# 连接数据库
connection = mysql.connector.connect(
    host='localhost',
    user='username',
    password='password',
    database='database_name'
)

try:
    cursor = connection.cursor()
    # 创建表
    create_table_sql = "CREATE TABLE IF NOT EXISTS employees (id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(100), age INT)"
    cursor.execute(create_table_sql)

    # 插入数据
    insert_sql = "INSERT INTO employees (name, age) VALUES (%s, %s)"
    employees_data = [
        ('John Doe', 30),
        ('Jane Smith', 25),
        ('Emily Jones', 35)
    ]
    cursor.executemany(insert_sql, employees_data)
    connection.commit()

    # 查询数据
    select_sql = "SELECT * FROM employees"
    cursor.execute(select_sql)
    rows = cursor.fetchall()
    for row in rows:
        print(row)

finally:
    if connection.is_connected():
        cursor.close()
        connection.close()
```

## 注意事项

- 确保使用参数化查询来防止 SQL 注入。
- 使用 `try...finally` 语句来确保游标和连接被正确关闭。
- 事务需要显式提交或回滚。
- 使用 `connection.is_connected()` 检查连接是否打开，以避免重复关闭。

通过上述示例，你可以使用 `mysql-connector-python` 库在 Python 3 中进行 MySQL 数据库的各种操作。
