# urllib

`urllib` 是 Python 的一个标准库，用于处理 URL。在 Python 3 中，它被分为几个子模块，每个子模块都有不同的用途：

1. **`urllib.request`**：用于打开和读取 URL。
2. **`urllib.parse`**：用于解析 URL。
3. **`urllib.error`**：包含在处理 URL 时可能引发的错误。
4. **`urllib.robotparser`**：用于解析 robots.txt 文件。

## `urllib.request`

`urllib.request` 是最常用的子模块，提供了打开网络连接的功能，类似于 `urllib.urlopen()` 的功能。以下是一些常用的函数和类：

- `urlopen(url, data=None, [options])`：打开 URL，返回一个类似于文件的对象。
- `Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False)`：构造一个请求对象。
- `pathname2url(path)` 和 `url2pathname(path)`：在 URL 路径和本地路径之间进行转换。

## 示例：使用 `urllib.request` 发送 GET 请求

```python
import urllib.request

# 打开 URL
response = urllib.request.urlopen('http://www.example.com')

# 读取数据
html = response.read().decode('utf-8')

print(html)
```

## 示例：使用 `urllib.request` 发送 POST 请求

```python
import urllib.parse
import urllib.request

# 准备数据
data = {'key1': 'value1', 'key2': 'value2'}
data = urllib.parse.urlencode(data).encode('utf-8')

# 创建请求对象
req = urllib.request.Request('http://www.example.com', data=data)

# 发送请求
response = urllib.request.urlopen(req)

# 读取响应
html = response.read().decode('utf-8')

print(html)
```

## `urllib.parse`

`urllib.parse` 用于解析 URL，可以分割 URL 为组成部分，也可以构建 URL。以下是一些常用的函数：

- `urlparse(url)`：将 URL 分解为 6 个组件：`(scheme, netloc, path, params, query, fragment)`。
- `urlunparse(components)`：将由 `urlparse()` 返回的组件重新组合成 URL。
- `urlencode(query, doseq=False)`：将字典或列表编码成 URL 编码的查询字符串。
- `urljoin(base, url)`：将相对 URL `url` 连接到基准 URL `base`。

## 示例：使用 `urllib.parse` 解析和编码 URL

```python
import urllib.parse

# 解析 URL
url = 'http://www.example.com/index.html?name=peter'
result = urllib.parse.urlparse(url)

print(result.scheme)  # http
print(result.netloc)  # www.example.com
print(result.path)    # /index.html
print(urllib.parse.unquote(result.query))  # {'name': 'peter'}

# 编码数据
data = {'name': 'peter', 'occupation': 'python developer'}
encoded_data = urllib.parse.urlencode(data)
print(encoded_data)  # name=peter&occupation=python+developer
```

## 注意事项

- `urllib` 库提供的功能强大，可以处理复杂的 URL 和查询字符串。
- 确保正确处理 URL 编码和解码，避免安全问题，如注入攻击。
- 使用 `urllib.request` 发送请求时，注意检查响应状态码，并适当处理异常。

`urllib` 是 Python 进行网络请求和 URL 处理的基石，适用于从简单的文本请求到复杂的 HTTP 请求。
