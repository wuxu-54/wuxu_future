# 命名空间和作用域

在 Python 3 中，命名空间（Namespace）和作用域（Scope）是两个密切相关的概念，它们共同定义了如何查找变量以及其他对象。

## 命名空间

命名空间是存储对象（如变量、函数、类等）的字典。Python 中的每个作用域都有自己独立的命名空间，命名空间用来解决名称（变量名、函数名等）的冲突问题。

## 作用域

作用域是指 Python 在代码中查找变量的过程。Python 有以下几种作用域：

1. **局部作用域（Local scope）**：
   - 最小的作用域，通常是在函数内部定义的变量。

2. **嵌套作用域（Enclosing scope）**：
   - 如果在局部作用域中找不到需要的变量，Python 会查找包含该局部作用域的外部作用域。

3. **全局作用域（Global scope）**：
   - 包含了模块内的所有变量。

4. **内置作用域（Built-in scope）**：
   - Python 内置的名称，如 `print`、`len`、 函数名 `abs`、`char` 和异常名称 `BaseException`、`Exception` 等等。

5. **类作用域（Class scope）**：
   - 类定义内部的命名空间，用于存储类属性和方法。

## LEGB 顺序

Python 按照 LEGB 的顺序来搜索变量：

- **L**ocal — 本地（最内层）
- **E**nclosing — 嵌套（外部嵌套的函数作用域）
- **G**lobal — 全局
- **B**uilt-in — 内置

## 示例

```python
x = 'global'

def func():
    y = 'enclosing'
    def inner_func():
        z = 'local'
        print(z)  # local
        print(y)  # enclosing
        print(x)  # global
    inner_func()

func()
```

在这个示例中，`inner_func` 首先在局部作用域查找变量，然后是嵌套作用域 `func`，接着是全局作用域，最后是内置作用域。

## 非局部声明（Nonlocal）

在嵌套函数中，如果需要修改外部函数中的变量，可以使用 `nonlocal` 关键字：

```python
def outer():
    x = 'global'

    def inner():
        nonlocal x
        x = 'local'

    inner()
    print(x)  # local

outer()
```

## 全局声明（Global）

如果需要在函数内部修改全局变量，可以使用 `global` 关键字：

```python
x = 'initial'

def func():
    global x
    x = 'modified'

func()
print(x)  # modified
```

## 类作用域

在类中定义的变量是类属性，可以在类的所有实例中共享：

```python
class MyClass:
    attribute = 'class attribute'

    def __init__(self, value):
        self.value = value

    def print_attribute(self):
        print(MyClass.attribute)

obj1 = MyClass('instance 1')
obj2 = MyClass('instance 2')
obj1.print_attribute()  # class attribute
```

在 Python 中，理解和掌握命名空间和作用域的概念对于编写清晰、可维护的代码非常重要。它有助于避免变量名冲突，并明确变量的生命周期和可见性。
