# 字符串

Swift中的字符串（`String` 类型）是一种非常强大的数据结构，用于表示文本数据。以下是Swift中字符串的一些主要特性和操作：

1. **字符串字面量**：
   - 字符串用双引号（`"`）括起来定义。

   ```swift
   let simpleString = "Hello, World!"
   let anotherString = 'Single quotes also work for strings'
   ```

2. **字符串可变性**：
   - 字符串默认是不可变的。如果你需要修改字符串，可以使用 `var` 关键字声明一个可变字符串。

   ```swift
   var mutableString = "Hello"
   mutableString += ", World!"
   ```

3. **字符串索引**：
   - 字符串可以通过索引访问和修改。Swift中的字符串索引基于 `String.Index` 类型，而不是整数。

   ```swift
   let index = simpleString.index(simpleString.startIndex, offsetBy: 7)
   let character = simpleString[index]
   ```

4. **字符串连接**：
   - 使用加号（`+`）可以连接字符串，但这种方式在循环中效率不高，因为它会创建多个临时字符串。

   ```swift
   let greeting = "Hello" + ", " + "World!"
   ```

5. **字符串插值**：
   - 使用字符串插值（`\()`）可以方便地将变量或表达式的值插入到字符串中。

   ```swift
   let name = "World"
   let greeting = "Hello, \(name)!"
   ```

6. **Unicode 支持**：
   - Swift的字符串完全支持Unicode，可以存储和操作多种语言的字符。

   ```swift
   let emoji = "👋🏼 Hello, World!"
   ```

7. **字符串比较**：
   - 字符串可以使用 `==` 运算符进行比较，比较的是它们的字典序。

   ```swift
   if "hello" == "Hello" {
       print("The strings are equal")
   }
   ```

8. **子字符串**：
   - 可以使用下标语法或 `substring` 方法获取字符串的一部分。

   ```swift
   let part1 = simpleString[simpleString.startIndex..<index]
   let part2 = simpleString.substring(from: index)
   ```

9. **字符串搜索**：
   - 可以使用 `contains`、`hasPrefix`、`hasSuffix` 等方法检查字符串内容。

   ```swift
   let hasHello = simpleString.contains("Hello")
   ```

10. **字符迭代**：
    - 可以通过遍历字符串来迭代每个字符。

    ```swift
    for character in simpleString {
        print(character)
    }
    ```

11. **字符串方法**：
    - Swift提供了许多字符串方法来处理字符串，如 `capitalized`、`lowercased`、`uppercased` 等。

    ```swift
    let capitalizedString = simpleString.capitalized
    ```

12. **本地化和格式化**：
    - 可以使用字符串格式化和本地化来适应不同的语言环境。

    ```swift
    let formattedString = String.localizedStringWithFormat("%d bottles of beer", 99)
    ```

13. **扩展性**：
    - 可以扩展 `String` 类型来添加自定义方法或计算属性。

Swift的字符串类型非常灵活，提供了丰富的功能来处理文本数据，无论是简单的拼接、比较，还是复杂的文本分析和本地化处理。

## 字符串常用API

Swift的`String`类型提供了大量的API来处理文本数据。以下是一些常用的字符串API：

1. **基础操作**：
   - `isEmpty`：检查字符串是否为空。
   - `count`：返回字符串中字符的数量。

2. **字符访问**：
   - `first`：访问字符串的第一个字符。
   - `last`：访问字符串的最后一个字符。

3. **字符串截取**：
   - `prefix(_:)`：返回字符串中前`n`个字符组成的子串。
   - `suffix(_:)`：返回字符串中后`n`个字符组成的子串。
   - `substring(from:)`：从指定位置开始截取子串。
   - `substring(to:)`：截取到指定位置的子串。

4. **字符串拼接**：
   - 使用加号（`+`）或`append(_:)`方法来拼接字符串。

5. **字符串插值**：
   - 使用反斜杠加圆括号（`\()`）进行字符串插值。

6. **字符串比较**：
   - `localizedCaseInsensitiveCompare(_:)`：本地化不区分大小写的比较。
   - `localizedStandardCompare(_:)`：本地化标准比较。

7. **大小写转换**：
   - `uppercased()`：转换为大写。
   - `lowercased()`：转换为小写。

8. **字符迭代**：
   - 使用`for-in`循环迭代字符串中的每个字符。

9. **Unicode 支持**：
   - `unicodeScalars`：访问字符串的Unicode标量表示。

10. **搜索和检查**：
    - `contains(_:)`：检查字符串是否包含某个子串。
    - `hasPrefix(_:)`：检查字符串是否有指定前缀。
    - `hasSuffix(_:)`：检查字符串是否有指定后缀。

11. **字符串分割**：
    - `components(separatedBy:)`：根据指定的分隔符分割字符串。

12. **字符串替换**：
    - `replacingOccurrences(of:with:)`：替换字符串中的特定部分。

13. **字符串格式化**：
    - `format(_:)`：使用格式字符串格式化字符串。

14. **修剪空白**：
    - `trimmingCharacters(in:)`：修剪字符串前后的指定字符集中的字符。

15. **本地化**：
    - `localizedStringWithFormat(_:)`：根据本地化格式化字符串。

16. **正则表达式**：
    - `matches(for:in:options:range:)`：检查字符串是否匹配正则表达式。

17. **自定义子串**：
    - `index(_:)`：获取指定位置的索引。
    - `indices`：获取字符串的所有索引。

18. **扩展性**：
    - 可以通过扩展（`extension`）来为`String`类型添加自定义方法或计算属性。

以下是一些示例代码，演示如何使用这些API：

```swift
let greeting = "Hello, World!"
print(greeting.isEmpty) // false
print(greeting.count) // 13

let firstCharacter = greeting.first // "H"
let lastCharacter = greeting.last // "!"

let prefix = greeting.prefix(5) // "Hello,"
let suffix = greeting.suffix(2) // "!"

for character in greeting {
    print(character)
}

let containsWorld = greeting.contains("World") // true
let hasPrefixHello = greeting.hasPrefix("Hello") // true

let trimmed = greeting.trimmingCharacters(in: .whitespaces) // "Hello, World!"

let uppercasedGreeting = greeting.uppercased() // "HELLO, WORLD!"
let lowercasedGreeting = greeting.lowercased() // "hello, world!"

let components = greeting.components(separatedBy: " ") // ["Hello,", "World!"]

let replaced = greeting.replacingOccurrences(of: "World", with: "Swift") // "Hello, Swift!"
```

Swift的字符串API非常丰富，可以满足各种文本处理的需求。

## 字符串拼接

在Swift中，字符串拼接可以通过多种方式实现。以下是一些常用的字符串拼接方法：

1. **使用加号（+）**：
   Swift中的字符串是值类型，使用加号拼接字符串时，每次都会创建一个新的字符串。

   ```swift
   let string1 = "Hello"
   let string2 = "World"
   let combinedString = string1 + " " + string2  // 结果为 "Hello World"
   ```

2. **使用字符串插值（String Interpolation）**：
   字符串插值允许你将变量或表达式的值插入到字符串字面量中。

   ```swift
   let string1 = "Hello"
   let string2 = "World"
   let combinedString = "\(string1) \(string2)"  // 结果为 "Hello World"
   ```

3. **使用`+=`操作符**：
   如果你需要多次拼接字符串，可以使用`+=`操作符来避免创建多个临时字符串。

   ```swift
   var stringBuilder = ""
   stringBuilder += "Hello"
   stringBuilder += " "
   stringBuilder += "World"
   // stringBuilder 的结果为 "Hello World"
   ```

4. **使用`String`的`append`方法**：
   类似于`+=`操作符，`append`方法可以将一个字符串追加到另一个字符串的末尾。

   ```swift
   var stringBuilder = "Hello"
   stringBuilder.append(" ")
   stringBuilder.append("World")
   // stringBuilder 的结果为 "Hello World"
   ```

5. **使用`String`的`appendContentsOf`方法**：
   如果你有一个字符串数组，可以使用`appendContentsOf`方法将数组中的所有字符串拼接起来。

   ```swift
   let strings = ["Hello", "World"]
   var stringBuilder = ""
   stringBuilder.appendContentsOf(strings)
   // stringBuilder 的结果为 "HelloWorld"
   ```

6. **使用`reduce`函数**：
   如果你有一个字符串数组，可以使用`reduce`函数来拼接所有字符串。

   ```swift
   let strings = ["Hello", "World"]
   let combinedString = strings.reduce("", +)
   // combinedString 的结果为 "HelloWorld"
   ```

7. **使用`join`方法**：
   如果你有一个字符串数组，并且想要用特定的分隔符来拼接字符串，可以使用`join`方法。

   ```swift
   let strings = ["Hello", "World"]
   let combinedString = strings.join(separator: " ")
   // combinedString 的结果为 "Hello World"
   ```

选择哪种方法取决于你的具体需求和场景。在处理大量字符串拼接时，推荐使用`+=`、`append`或者`appendContentsOf`，因为它们在性能上更优。

## 转换示例

需求：字符串转换为字符，减去数值，转换回字符

解：

1. 字符串转换为字符：字符串可以直接取单个字符比如使用：`for-in`，`string.first`
2. 字符减去数值：使用`char.unicodeScalars.first!.value`获取对应整数，再运算减去数值。 `unicodeScalars` 取unicode编码
3. 转换回字符：先用`UnicodeScalar`转换为unicode编码，再通过`Character`变为字符。完整：`Character(UnicodeScalar(c.unicodeScalars.first!.value - 1)!)`

## 字符串更多操作

1. 获取索引前后的字符串：字符串的索引处理有些繁琐，核心是其`index`扩展属性

   ```swift
   let str = "Hello, World!"
   let index = str.index(str.startIndex, offsetBy: 7) // 假设我们要获取索引7之前的子字符串

   let beforeIndex = str[str.startIndex..<index]
   let afterIndex = str[index...]
   print(String(beforeIndex) + String(afterIndex)) // 输出 "Hello, World!"
   ```

---

## 字符串遍历操作

在 Swift 中，遍历字符串是一个常见的操作，可以通过多种方式实现。以下是一些遍历字符串的常用方法：

### 使用 `for-in` 循环遍历字符串

```swift
let str = "Hello, World!"
for character in str {
    print(character)
}
```

这将打印出字符串中的每个字符。

### 使用 `enumerated()` 方法遍历字符串

如果你需要知道每个字符的索引，可以使用 `enumerated()` 方法：

```swift
for (index, character) in str.enumerated() {
    print("Index \(index): \(character)")
}
```

这将打印出每个字符及其对应的索引。

### 使用 `index(before:)` 和 `index(after:)` 方法遍历字符串

对于更复杂的遍历，比如需要在遍历时修改字符串，你可以使用 `index(before:)` 和 `index(after:)` 方法：

```swift
var str = "Hello, World!"
var idx = str.startIndex

while idx != str.endIndex {
    print(str[idx])
    idx = str.index(after: idx)
}
```

这将打印出字符串中的每个字符。

### 使用 `for-in` 循环遍历字符串的字符范围

如果你想从字符串的某个特定位置开始遍历，可以这样做：

```swift
let startIndex = str.index(str.startIndex, offsetBy: 7)
let endIndex = str.index(str.startIndex, offsetBy: 12)
for character in str[startIndex...endIndex] {
    print(character)
}
```

这将打印出从索引 7 到索引 12（包括索引 12）的字符。

### 使用 `stride` 遍历字符串

对于更复杂的遍历，比如需要在每次迭代中跳过多个字符，可以使用 `stride`：

```swift
for index in stride(from: str.startIndex, to: str.endIndex, by: 2) {
    print(str[index])
}
```

### 直接遍历索引

```swift
let str = "Hello, World!"
let startIdx = str.index(str.startIndex, offsetBy: 7) // 从索引7的位置开始遍历

// 从特定索引开始遍历
var idx = startIdx
while idx < str.endIndex {
    print(str[idx])
    idx = str.index(after: idx)
}
```

在这个例子中，我们使用 `index(after:)` 方法来获取当前索引的下一个索引，并继续遍历直到到达字符串的末尾。

### 注意事项

- Swift 的字符串是基于 Unicode 标量值的，这意味着一些字符可能由多个 Unicode 标量值组成。在遍历字符串时，`for-in` 循环会正确处理这些组合字符。
- 当使用索引和范围来遍历字符串时，确保索引在字符串的有效范围内，否则会引发运行时错误。
- 在处理 Unicode 字符串时，直接使用整数索引可能会导致跳过某些字符或在错误的位置上停止。使用 `for-in` 循环或 `enumerated()` 方法可以避免这些问题。

通过这些方法，你可以灵活地遍历 Swift 中的字符串，并根据需要对每个字符进行操作。
