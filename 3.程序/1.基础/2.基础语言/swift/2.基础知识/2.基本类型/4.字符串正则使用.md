# 字符串正则

在Swift中，使用正则表达式进行匹配可以通过`NSRegularExpression`类来实现。`matches(in:options:range:)`方法是`NSRegularExpression`类的一个实例方法，它返回一个匹配结果数组，数组中的每个元素都是一个`NSTextCheckingResult`对象。

以下是使用`matches(in:options:range:)`方法进行正则匹配的基本步骤：

1. **创建正则表达式**：
   使用`NSRegularExpression`初始化方法创建一个正则表达式对象。

2. **调用`matches(in:options:range:)`方法**：
   使用这个实例方法来查找字符串中所有匹配正则表达式的子串。

3. **处理匹配结果**：
   遍历返回的匹配结果数组，使用`NSTextCheckingResult`对象来获取匹配的范围和相关信息。

下面是一个使用正则表达式匹配字符串中所有数字的示例：

```swift
import Foundation

// 1. 创建正则表达式对象
if let regex = try? NSRegularExpression(pattern: "\\d+", options: []) {
    // 2. 在整个字符串范围内查找匹配项
    let results = regex.matches(in: "There are 123 apples, 45 bananas, and 67 oranges.",
                                 options: [], range: NSRange(location: 0, length: (string as NSString).length))
    
    // 3. 遍历匹配结果
    for result in results {
        if let range = result.range.location {
            // 打印匹配的数字
            print((string as NSString).substring(with: result.range))
        }
    }
}
```

在上面的代码中，我们使用了正则表达式`"\\d+"`来匹配一个或多个数字。`NSRegularExpression`的`matches(in:options:range:)`方法返回了一个包含所有匹配项的数组。然后我们遍历这个数组，打印出每个匹配的数字。

注意，`NSRange`需要从`String`的`location`和`length`属性转换得到，因为`NSRegularExpression`的API是基于`NSString`的。

此外，Swift 4之后引入了`String`的原生正则表达式支持，可以使用`rangeOfCharacter(from:options:range:)`等方法来检查正则表达式的匹配，但`NSRegularExpression`提供了更全面的正则表达式功能。
