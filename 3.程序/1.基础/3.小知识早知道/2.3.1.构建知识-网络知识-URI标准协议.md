# URI 标准协议详解  

## 一、URI 基本概念与定义  

**URI（Uniform Resource Identifier，统一资源标识符）** 是用于标识互联网资源的标准字符串，其核心作用是唯一定位资源。URI 包含两种主要类型：  

- **URL（Uniform Resource Locator，统一资源定位符）**：通过地址定位资源（如 `https://example.com/path`）。  
- **URN（Uniform Resource Name，统一资源名称）**：通过名称唯一标识资源（如 `urn:isbn:1234567890`）。  

## 二、URI 标准结构与语法（RFC 3986 规范）  

URI 的完整结构由以下部分组成，语法格式如下：  

```txt
scheme:[//[user:pass@]host[:port]][path][?query][#fragment]
```  

各部分详解：  

### 1. **Scheme（方案）**  

- 定义资源的访问协议，用于指定处理资源的程序或服务。  
- 格式：由字母、数字、`+`、`-`、`.` 组成，不区分大小写，后跟 `:`。  
- 示例：`http`、`https`、`ftp`、`mailto`、`file`。  

### 2. **Authority（权限部分）**  

- 包含资源所在的服务器信息，由 `//` 分隔后接以下内容：  
  - **Userinfo**（可选）：用户认证信息，格式为 `user:pass`（如 `user:password@`），实际应用中需避免明文传输密码。  
  - **Host**（必填）：服务器域名或 IP 地址（如 `example.com` 或 `192.168.1.1`）。  
  - **Port**（可选）：端口号，如 `:8080`（http 默认端口为 80，https 为 443）。  
- 示例：`//user:pass@example.com:8080`  

### 3. **Path（路径）**  

- 标识资源在服务器中的具体位置，由 `/` 分隔多个层级。  
- 格式：区分大小写，支持中文等字符（需编码，见下文）。  
- 示例：`/docs/getting-started`、`/api/v1/users`。  

### 4. **Query（查询参数）**  

- 用于传递资源的附加参数，以 `?` 开头，多个参数用 `&` 分隔。  
- 格式：`key=value` 对（如 `?id=123&name=test`）。  
- 示例：`https://example.com/search?keyword=uri&page=2`  

### 5. **Fragment（片段标识符）**  

- 用于定位资源内部的子资源（如网页中的锚点），以 `#` 开头。  
- 示例：`https://example.com/article#section2`（定位到文章的第二节）。  

## 三、URI 编码规范（关键字符处理）  

URI 中仅允许部分 ASCII 字符直接使用，其他字符需通过 **百分号编码（Percent-Encoding）** 处理：  

### 1. **需编码的字符**  

- **保留字符**：在 URI 结构中有特殊含义的字符，如 `?`、`/`、`#`、`&`、`=`、`+` 等。  
  - 示例：空格需编码为 `%20`，`&` 编码为 `%26`，`=` 编码为 `%3D`。  
- **非 ASCII 字符**：如中文、日文等，需先转为 UTF-8 字节，再逐个字节编码。  
  - 示例：“中文”编码为 `%E4%B8%AD%E6%96%87`。  

### 2. **编码工具与示例**  

- 浏览器可通过 `encodeURI()` 和 `encodeURIComponent()` 方法编码（注意两者区别：`encodeURI()` 不编码路径中的 `/`，而 `encodeURIComponent()` 会编码所有非保留字符）。  
- 示例：  
  - 原始字符串：`https://example.com/搜索?keyword=URI协议`  
  - 编码后：`https://example.com/%E6%90%9C%E7%B4%A2?keyword=URI%E5%8D%8F%E8%AE%AE`  

## 四、URI 与 URL、URN 的区别  

| **类型** | **核心功能**                 | **示例**                          | **应用场景**                     |  
|----------|------------------------------|-----------------------------------|----------------------------------|  
| **URI**  | 资源唯一标识的通用规范       | `http://example.com`              | 统一描述所有资源标识方法         |  
| **URL**  | 基于地址定位资源             | `https://example.com/file.pdf`    | 网页访问、文件下载等实时资源获取 |  
| **URN**  | 基于名称持久化标识资源       | `urn:uuid:123e4567-e89b-12d3-a456-426614174000` | 需要长期稳定标识的资源（如学术文献、UUID） |  

## 五、URI 设计最佳实践（结合应用场景）  

1. **路由协议设计**：  
   - 路径结构清晰化：如 `https://api.example.com/v1/users/{user_id}/orders`，通过路径参数定位资源。  
   - 版本控制：在路径中明确协议版本（如 `v1`、`v2`），便于迭代兼容。  

2. **安全与规范**：  
   - 外部调用时，对 URI 中的参数进行严格编码和校验，避免 SQL 注入、XSS 等攻击。  
   - 避免在 URI 中传递敏感信息（如密码），优先通过请求头或 body 传输。  

3. **前端路由优化**：  
   - 利用 URI 的 `fragment`（哈希部分）实现单页应用（SPA）路由，如 `#/page1`，配合 `hashchange` 事件监听页面切换。  

## 六、URI 相关 RFC 标准文档  

- **RFC 3986**：定义 URI 的通用语法和语义。  
- **RFC 3987**：定义 URI 中字符的国际化（IDNA 和 UTF-8 编码）。  
- **RFC 6797**：HTTPS 协议的安全考虑。  

通过以上规范，URI 实现了资源的标准化标识，为网络通信、应用路由和数据交互提供了统一的基础。实际开发中需结合业务场景，遵循编码规则和安全原则，确保 URI 的可靠性和可解析性。
