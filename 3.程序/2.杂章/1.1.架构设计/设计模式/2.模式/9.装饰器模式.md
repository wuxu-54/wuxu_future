# 装饰器模式

类型：结构型

目的：向一个现有的对象添加新的功能，同时又不改变其结构。

## 结构

装饰器模式通常包含以下角色：

- **抽象组件（Component）**：定义了一个接口，描述了可以动态添加的职责。
- **具体组件（Concrete Component）**：实现了抽象组件的具体类，是被装饰的原始对象，它定义了需要添加新功能的对象。
- **抽象装饰器（Decorator）**：继承自抽象组件，它包含了一个抽象组件对象，并定义了与抽象组件相同的接口，同时可以通过组合方式持有其他装饰器对象。
- **具体装饰器（Concrete Decorator）**：实现了抽象装饰器的接口，负责向抽象组件添加新的功能。

## 优缺点

- 优点：
  - 动态扩展性：可以在运行时动态地给一个对象添加职责。
  - 透明性：装饰者模式不需要修改现有的代码，符合开闭原则。
  - 灵活性：可以灵活地给对象添加多个职责。
- 缺点：
  - 增加系统的复杂性：每增加一个职责，都需要增加一个装饰者类。
  - 性能问题：装饰者模式通过多次调用方法来实现职责的累加，可能会影响性能。

## 适用场景

- 当需要在不增加大量子类的情况下扩展类的功能。
- 当需要动态地添加或撤销对象的功能。
- 当不能通过继承的方式实现扩展时，比如继承层次已经很深。
- 当需要通过一种无须修改对象本身结构的方式来扩展对象功能时。

## 注意事项

- 在需要动态扩展功能时，考虑使用装饰器模式。
- 保持装饰者和具体组件的接口一致，以确保灵活性。

## 示例

```java
// 抽象组件
interface Component {
    void operate();
}

// 具体组件
class ConcreteComponent implements Component {
    @Override
    public void operate() {
        System.out.println("ConcreteComponent operate");
    }
}

// 抽象装饰者
abstract class Decorator implements Component {
    protected Component component;

    public Decorator(Component component) {
        this.component = component;
    }

    @Override
    public void operate() {
        component.operate();
    }
}

// 具体装饰者A
class ConcreteDecoratorA extends Decorator {
    public ConcreteDecoratorA(Component component) {
        super(component);
    }

    @Override
    public void operate() {
        super.operate();
        // 添加额外的功能
        System.out.println("ConcreteDecoratorA added behavior");
    }
}

// 具体装饰者B
class ConcreteDecoratorB extends Decorator {
    public ConcreteDecoratorB(Component component) {
        super(component);
    }

    @Override
    public void operate() {
        super.operate();
        // 添加额外的功能
        System.out.println("ConcreteDecoratorB added behavior");
    }
}

// 客户端代码
public class DecoratorPatternDemo {
    public static void main(String[] args) {
        Component component = new ConcreteComponent();
        component = new ConcreteDecoratorA(component);
        component = new ConcreteDecoratorB(component);

        component.operate();
    }
}
```
