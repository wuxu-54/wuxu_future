# 使用npm安装模块包

命令：`npm install 模块包名`

npm 的包安装分为本地安装（local）、全局安装（global）两种，从敲的命令行来看，差别只是有没有-g而已，比如

* 本地安装：`npm install express`
* 全局安装：`npm install express -g`  

如果出现以下错误：

```txt
npm err! Error: connect ECONNREFUSED 127.0.0.1:8087 
```

解决办法为：

```shell
npm config set proxy null
```

## 本地安装

1. 将安装包放在 `./node_modules` 下（运行 npm 命令时所在的目录），如果没有 node_modules 目录，会在当前执行 npm 命令的目录下生成 node_modules 目录。
2. 可以通过 `require()` 来引入本地安装的包。

## 全局安装

1. 将安装包放在 /usr/local 下或者你 node 的安装目录。
2. 可以直接在命令行里使用。

如果你希望具备两者功能，则需要在两个地方安装它或使用 npm link。

示例：

接下来我们使用全局方式安装 express

```shell
npm install express -g
#注意，安装时可以指定版本，比如 npm install express@版本号
```

安装过程输出如下内容，第一行输出了模块的版本号及安装位置。

```shell
express@4.13.3 node_modules/express
├── escape-html@1.0.2
├── range-parser@1.0.2
├── merge-descriptors@1.0.0
├── array-flatten@1.1.1
├── cookie@0.1.3
├── utils-merge@1.0.0
├── parseurl@1.3.0
├── cookie-signature@1.0.6
├── methods@1.1.1
├── fresh@0.3.0
├── vary@1.0.1
├── path-to-regexp@0.1.7
├── content-type@1.0.1
├── etag@1.7.0
├── serve-static@1.10.0
├── content-disposition@0.5.0
├── depd@1.0.1
├── qs@4.0.0
├── finalhandler@0.4.0 (unpipe@1.0.0)
├── on-finished@2.3.0 (ee-first@1.1.1)
├── proxy-addr@1.0.8 (forwarded@0.1.0, ipaddr.js@1.0.1)
├── debug@2.2.0 (ms@0.7.1)
├── type-is@1.6.8 (media-typer@0.3.0, mime-types@2.1.6)
├── accepts@1.2.12 (negotiator@0.5.3, mime-types@2.1.6)
└── send@0.13.0 (destroy@1.0.3, statuses@1.2.1, ms@0.7.1, mime@1.3.4, http-errors@1.3.1)
```

### 查看安装信息

查看所有全局安装的模块：`npm list -g`

如果要查看某个模块的版本号，可以使用命令：`npm list grunt`

---

## 卸载模块

命令：`npm uninstall 模块名`

卸载后，你可以到 /node_modules/ 目录下查看包是否还存在，或者使用命令查看：`npm ls`

## 更新模块

命令：`npm update 模块名`

## 搜索模块

命令：`npm search 模块名`

## 创建模块

步骤如下：

1. 生成package.json命令: `npm init`
    >创建模块，package.json 文件是必不可少的。我们可以使用 NPM 生成 package.json 文件，生成的文件包含了基本的结果。
2. 在 npm 资源库中注册用户 ：`npm adduser`。 完整示例：

    ```shell
    Username: mcmohd
    Password:
    Email: (this IS public) mcmohd@gmail.com
    ```

3. 发布模块：`npm publish`

## 版本号

使用 NPM 下载和发布代码时都会接触到版本号。NPM 使用语义版本号来管理代码，这里简单介绍一下。

语义版本号分为X.Y.Z三位，分别代表主版本号、次版本号和补丁版本号。当代码变更时，版本号按以下原则更新。

* 如果只是修复bug，需要更新Z位。
* 如果是新增了功能，但是向下兼容，需要更新Y位。
* 如果有大变动，向下不兼容，需要更新X位。

版本号有了这个保证后，在申明第三方包依赖时，除了可依赖于一个固定版本号外，还可依赖于某个范围的版本号。例如"argv": "0.0.x"表示依赖于0.0.x系列的最新版argv。

NPM支持的所有版本号范围指定方式可以查看[官方文档](https://npmjs.org/doc/files/package.json.html#dependencies)。
