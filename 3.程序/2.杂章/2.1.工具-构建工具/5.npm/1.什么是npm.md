# npm

npm是随同NodeJs安装的包管理工具（类似java中的maven仓库，不过npm既是仓库又提供相关工具），可以解决NodeJs代码部署的很多问题。

* [中文文档](https://www.npmjs.cn/)

使用场景：

* 允许用户从NPM服务器下载别人编写的第三方包到本地使用。
* 允许用户从NPM服务器下载并安装别人编写的命令行程序到本地使用。
* 允许用户将自己编写的包或命令行程序上传到NPM服务器供别人使用。

## npm安装

新版本NodeJs会自带npm，无需安装，直接使用。

单独安装npm：

```shell
# mac、Linux安装
sudo npm install npm -g
# window,使用下面：
npm install npm -g
```

## 使用淘宝镜像

由于国内直接使用 npm 的官方镜像是非常慢的，这里推荐使用淘宝 NPM 镜像。

```shell
# 可以使用淘宝定制的 cnpm (gzip 压缩支持) 命令行工具代替默认的 npm
npm install -g cnpm --registry=https://registry.npmmirror.com

# 上面命令执行后，就可以使用 cnpm 命令来安装模块了
cnpm install 模块名
```

---

## AI

`npm`（Node Package Manager）是 JavaScript 世界里使用广泛的包管理工具，同时也是 Node.js 默认的包管理工具。以下为你详细介绍：

### 1. 安装与初始化

* **安装**：当你安装 Node.js 时，`npm` 会随之自动安装。你可以通过以下命令来确认 `npm` 是否成功安装以及查看其版本：

```bash
npm -v
```

* **初始化项目**：若要在项目里使用 `npm` 管理依赖，需要先初始化项目。在项目根目录下运行下面的命令：

```bash
npm init
```

此命令会引导你设置项目的基本信息，像项目名称、版本、描述等，最终生成 `package.json` 文件。若想使用默认配置快速初始化，可执行：

```bash
npm init -y
```

### 2. `package.json` 文件

`package.json` 是项目的核心配置文件，记录了项目的元数据以及依赖信息。下面是一个示例：

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "A sample project",
  "main": "index.js",
  "scripts": {
    "start": "node index.js"
  },
  "dependencies": {
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "jest": "^27.0.6"
  }
}
```

* **`name` 和 `version`**：项目的名称与版本。

* **`description`**：项目的简要描述。
* **`main`**：项目的入口文件。
* **`scripts`**：定义了可通过 `npm run` 执行的脚本命令。
* **`dependencies`**：项目运行时所需的依赖包。
* **`devDependencies`**：项目开发时所需的依赖包，如测试框架、打包工具等。

### 3. 常用命令

#### 3.1 安装依赖

* **安装生产依赖**：把依赖添加到 `dependencies` 中，项目运行时需要这些依赖。

```bash
npm install <package-name>
# 或者简写
npm i <package-name>
```

* **安装开发依赖**：将依赖添加到 `devDependencies` 中，仅在开发阶段使用。

```bash
npm install <package-name> --save-dev
# 或者简写
npm i <package-name> -D
```

* **安装特定版本**：指定要安装的包的版本。

```bash
npm install <package-name>@<version>
```

* **安装所有依赖**：在项目根目录下运行此命令，会依据 `package.json` 文件安装所有依赖。

```bash
npm install
```

#### 3.2 卸载依赖

```bash
npm uninstall <package-name>
```

#### 3.3 更新依赖

* **更新单个依赖**：

```bash
npm update <package-name>
```

* **更新所有依赖**：

```bash
npm update
```

#### 3.4 运行脚本

借助 `package.json` 里的 `scripts` 字段定义脚本命令，然后使用 `npm run` 来执行。

```bash
npm run start
```

### 4. `package-lock.json` 文件

`package-lock.json` 会锁定每个依赖的确切版本，确保在不同环境下安装的依赖版本一致。当你安装、更新或卸载依赖时，`npm` 会自动更新这个文件。

### 5. 发布包

如果你开发了一个 Node.js 模块并想分享给其他人使用，可以通过 `npm` 发布包。步骤如下：

1. **注册 `npm` 账号**：在 [https://www.npmjs.com/](https://www.npmjs.com/) 注册账号。
2. **登录 `npm`**：在命令行中运行：

    ```bash
    npm login
    ```

3. **发布包**：在项目根目录下运行：

    ```bash
    npm publish
    ```

### 6. 其他特性

* **`npm` 脚本钩子**：`npm` 提供了一些脚本钩子，在特定的 `npm` 命令前后执行自定义脚本。例如，`preinstall` 和 `postinstall` 会在 `npm install` 前后执行。

* **`npm` 范围包**：允许你将包组织到特定的命名空间中，避免命名冲突。例如，`@myorg/mypackage`。

综上所述，`npm` 功能强大，能有效管理项目的依赖和脚本，极大提升开发效率。
