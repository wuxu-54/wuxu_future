# Extension（扩展）

在 Gradle 中，Extension（扩展）是用于向项目添加自定义配置属性的一种机制。通过 Extensions，你可以让你的插件或构建脚本更加灵活和可配置化，从而使得用户可以根据自己的需求来调整构建过程。

## 基础概念

- **Extension**：一个 Extension 是一组可以被配置的属性集合，它允许用户以声明式的方式配置插件的行为。每个 Extension 都有一个名称，并且可以通过项目的 `extensions` 属性进行访问。
  
- **Convention vs Extension**：在早期版本的 Gradle 中，使用的是 Convention 对象来实现类似的功能。然而，随着 Gradle 的发展，Extensions 被引入作为更强大、更灵活的替代方案。与 Conventions 不同，Extensions 可以包含任意类型的对象，并且它们可以在任何地方被创建和应用。

## 创建 Extension

要在你的插件中定义一个 Extension，你需要做以下几步：

1. **定义 Extension 类**：首先，需要创建一个普通的 Java 或 Groovy 类，这个类将包含你想要暴露给用户的配置属性。

    ```java
    public class MyPluginExtension {
        private String customProperty;

        public String getCustomProperty() {
            return customProperty;
        }

        public void setCustomProperty(String customProperty) {
            this.customProperty = customProperty;
        }
    }
    ```

2. **注册 Extension**：然后，在你的插件类中注册这个 Extension。通常是在 `apply` 方法中完成这项工作。

    ```groovy
    class MyPlugin implements Plugin<Project> {
        @Override
        void apply(Project project) {
            // 注册 Extension
            project.extensions.create("myPlugin", MyPluginExtension)
        }
    }
    ```

3. **使用 Extension**：一旦 Extension 被注册，用户就可以在他们的 `build.gradle` 文件中对其进行配置。

    ```groovy
    myPlugin {
        customProperty = 'someValue'
    }
    ```

## 访问 Extension 属性

在你的插件逻辑中，可以通过以下方式访问 Extension 的属性：

```groovy
project.myPlugin.customProperty
```

或者，如果你正在编写一个 Java 插件，可以通过类型安全的方式来获取 Extension 实例：

```java
MyPluginExtension extension = project.getExtensions().getByType(MyPluginExtension.class);
String propertyValue = extension.getCustomProperty();
```

## 总结

Gradle 的 Extension 机制为开发者提供了一种强大的方式来增强构建脚本的灵活性和可配置性。通过定义和使用 Extensions，可以使插件或构建脚本适应各种不同的项目需求，同时保持代码清晰和易于维护。无论是简单的属性配置还是复杂的对象模型，都可以通过 Extensions 在 Gradle 构建过程中得到很好的支持。
