# taskGraph

Gradle 的 `taskGraph` 是一个非常重要的领域模型对象，它在构建过程中用于表示所有任务之间的依赖关系。以下是关于 `taskGraph` 的一些关键信息和使用示例：

## 1. 理解 Task Graph

`taskGraph` 是在 Gradle 构建过程中构建的一个有向无环图（DAG），它包含了所有被请求执行的任务以及它们之间的依赖关系。这个图在任务执行之前被构建，并且用于确定任务的执行顺序。

## 2. 访问 Task Graph

你可以通过 `project.gradle.taskGraph` 来访问当前构建的 `taskGraph` 实例。这允许你在构建过程中的不同阶段访问和操作任务图。

## 3. 使用 Task Graph

`taskGraph` 提供了多种方法来查询和操作任务：

- `hasTask(String path)`：检查图中是否包含指定路径的任务。
- `getTasks()`：获取图中所有任务的集合。
- `getDependencies(Task task)`：获取指定任务的依赖任务集合。
- `getDependents(Task task)`：获取依赖于指定任务的任务集合。

## 4. 监听任务图变化

你可以为 `taskGraph` 添加监听器，以便在任务图发生变化时执行特定的操作。例如，你可以在任务图准备好后执行一些自定义逻辑：

```groovy
gradle.taskGraph.whenReady { TaskExecutionGraph graph ->
    println "All tasks in the graph: ${graph.allTasks}"
}
```

这个监听器会在任务图准备好后被调用，允许你访问和操作图中的所有任务。

## 5. 任务图的生命周期

在 Gradle 构建的生命周期中，`taskGraph` 在配置阶段之后被构建，并在执行阶段之前完成。这意味着你不能在配置阶段之前访问任务图，但在执行阶段之前可以访问和操作它。

## 6. 任务图与构建缓存

`taskGraph` 还与 Gradle 的构建缓存密切相关。Gradle 使用任务图来确定哪些任务可以被缓存，哪些任务需要重新执行。

通过以上信息，你可以更好地理解和使用 Gradle 的 `taskGraph`，从而更精细地控制构建过程中的任务执行顺序和依赖关系。这为构建优化和自动化提供了强大的工具和灵活性。
