# 查找任务

在Gradle中，查找任务（Task）是构建脚本中常见的操作之一。Gradle提供了多种方法来查找任务，以便对其进行配置或依赖。以下是一些常用的任务查找方法：

## 1. 使用`tasks.named()`方法

`tasks.named()`方法用于查找具有指定名称的任务。如果任务存在，它将返回一个`NamedDomainObjectProvider`，该对象可以进一步用于配置任务或获取任务的引用。

```groovy
tasks.named('taskName') {
    // 在这里配置任务
}
```

或者，如果只需要获取任务的引用而不进行配置，可以使用`get()`方法：

```groovy
def task = tasks.named('taskName').get()
```

## 2. 使用`tasks.withType()`方法

`tasks.withType()`方法用于查找特定类型的所有任务。它返回一个任务集合，可以对集合中的每个任务进行配置或操作。

```groovy
tasks.withType(Copy) {
    // 在这里配置所有Copy类型的任务
}
```

## 3. 使用`tasks.getByPath()`方法

`tasks.getByPath()`方法用于根据任务的路径查找任务。路径可以是相对路径或绝对路径。然而，这种方法可能会破坏Gradle的配置避免（configuration avoidance）和项目隔离（project isolation）原则，因此不推荐使用。

## 4. 使用`tasks.findByName()`和`tasks.getByName()`方法（不推荐）

在早期的Gradle版本中，`tasks.findByName()`和`tasks.getByName()`方法被用于查找任务。然而，这些方法现在被视为过时的方法，因为它们在配置阶段就解析任务，可能会导致在任务尚未创建时就尝试访问它们的问题。因此，推荐使用`tasks.named()`和`tasks.withType()`方法。

## 5. 在Kotlin DSL中使用`tasks.existing()`和`tasks.registering()`

在Kotlin DSL中，可以使用`tasks.existing()`来查找已经存在的任务，并使用`tasks.registering()`来延迟任务的创建和配置。

```kotlin
val task = tasks.existing(Copy::class) {
    // 在这里配置任务（如果任务存在）
}

val registeringTask by tasks.registering {
    // 在这里定义和配置任务（延迟创建）
}
```

需要注意的是，`tasks.existing()`方法只有在任务确实存在时才会返回任务的引用，否则它将抛出一个异常。而`tasks.registering()`方法则提供了一种延迟创建任务的方式，直到任务真正被需要时才进行创建和配置。

## 示例

假设我们有一个名为`myCopy`的Copy任务，我们可以使用以下方法来查找和配置它：

```groovy
tasks.named('myCopy') {
    from 'src/main/resources'
    into 'build/resources/main'
}
```

或者使用Kotlin DSL：

```kotlin
tasks.named<Copy>("myCopy") {
    from("src/main/resources")
    into("build/resources/main")
}
```

总之，Gradle提供了多种方法来查找任务，以便开发者可以根据需要对任务进行配置或依赖。在选择查找方法时，应优先考虑使用`tasks.named()`和`tasks.withType()`等现代方法，以避免潜在的问题。

---

## 通过project查找

每个任务可以作为项目的一个属性，可以通过project对象直接调用任务的名字。

```groovy
task hello

println hello.name
println project.hello.name //直接通过project访问
```
