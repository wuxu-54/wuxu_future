# 终止任务

这里的终止任务并不是指终止一个任务, 而是指一个无论运行结果如何最后都会被执行的任务.通过`finalizedBy`属性实现

## 定义和作用

finalizedBy 方法用于为任务添加一个或多个终结器任务。这意味着指定的任务（终结器任务）将在主任务执行完毕后执行，无论主任务成功还是失败。这类似于 Java 中的 finally 块，用于确保某些操作（如资源清理）一定会执行。

## 使用方法

你可以在任务定义中使用 finalizedBy 方法来指定终结器任务。例如：

```groovy
task myTask {
    doLast {
        // 任务代码
    }
}
myTask.finalizedBy cleanupTask
```

在这个例子中，cleanupTask 将在 myTask 执行完毕后执行，用于进行清理工作

## 例子：加入一个任务终止器

build.gradle

```groovy
task taskX << {
    println 'taskX'
}
task taskY << {
    println 'taskY'
}
taskX.finalizedBy taskY
```

gradle -q taskX 的输出

```sh
> gradle -q taskX
taskX
taskY
```

即使要终止的任务失败了, 终止任务仍会继续执行.

## 例子：当任务失败时

build.gradle

```groovy
task taskX << {
    println 'taskX'
    throw new RuntimeException()
}
task taskY << {
    println 'taskY'
}
taskX.finalizedBy taskY
```

gradle -q taskX 的输出

```sh
> gradle -q taskX
taskX
taskY
```

另外, 如果要终止的任务并没有被执行 (比如【声明任务的输入输出】章节讲的 up-to-date) 那么终止任务并不会执行.

当构建创建了一个资源, 无论构建失败或成功时这个资源必须被清除的时候, 终止任务就非常有用.

要使用终止任务, 你必须使用 `Task.finalizedBy()` 方法. 一个任务的实例, 任务的名称, 或者任何 `Task.dependsOn()` 可以接收的输入都可以作为这个任务的输入.
