# 任务配置

任务配置，就是对任务进行控制处理，每个task任务是单独的对象，可以在其内部进行配置，也可以通过任务对象进行单独的属性配置（类实例对象.属性）。
>本文是基础中任务操控章节的补充。

## 配置

在 Gradle 中，任务（Task）配置是构建脚本中的一个重要部分，它允许你定义任务的行为、依赖关系、输入和输出等。以下是一些常用的任务配置选项和示例：

### 1. 基本配置

```groovy
// 注册一个新任务
task myTask {
    // 设置任务描述
    description = 'This task does something important'

    // 设置任务分组
    group = 'Verification'

    // 依赖其他任务
    dependsOn 'clean', 'compileJava'

    // 只有在某些条件下才执行任务
    onlyIf { gradle.gradleVersion >= '5.0' }
}
```

### 2. 输入和输出配置

```groovy
task copyFiles {
    // 定义任务输入
    inputs.file 'source.txt'
    inputs.dir 'sourceDir'

    // 定义任务输出
    outputs.file 'destination.txt'
    outputs.dir 'destinationDir'

    // 执行任务动作
    doLast {
        copy {
            from 'source.txt'
            into 'destinationDir'
        }
    }
}
```

### 3. 动态注册任务

```groovy
// 动态创建任务
def numberOfTasks = 5
(1..numberOfTasks).each { count ->
    tasks.register("task$count") {
        doLast {
            println "Executing task $count"
        }
    }
}
```

### 4. 配置已有任务

```groovy
// 配置已有任务
tasks.named('compileJava') {
    // 添加任务依赖
    dependsOn 'clean'

    // 添加任务动作
    doFirst {
        println 'Starting Java compilation'
    }
    doLast {
        println 'Finished Java compilation'
    }
}
```

### 5. 使用 `doFirst` 和 `doLast`

```groovy
task myTask {
    doFirst {
        println 'Before the task execution'
    }

    doLast {
        println 'After the task execution'
    }
}
```

### 6. 条件执行

```groovy
task myTask {
    onlyIf { project.hasProperty('someProperty') }
}
```

### 7. 禁用任务

```groovy
task myTask {
    enabled = false
}
```

### 8. 任务类型

```groovy
// 使用内置任务类型
task zipTask(type: Zip) {
    from 'sourceDir'
    archiveFileName = 'archive.zip'
}
```

### 9. 自定义任务类

```groovy
class CustomTask extends DefaultTask {
    @TaskAction
    void execute() {
        println 'Executing custom task'
    }
}

// 注册自定义任务
tasks.register('customTask', CustomTask) {
    group = 'Custom'
    description = 'A custom task'
}
```

### 10. 访问和修改任务属性

```groovy
// 访问任务属性
def myTask = tasks.getByName('myTask')
println "Task description: ${myTask.description}"

// 修改任务属性
myTask.description = 'New description for my task'
```

这些示例展示了如何在 Gradle 中配置任务的各种属性和行为。通过这些配置，你可以精确控制任务的执行方式，以及如何与其他任务和构建逻辑集成。更多详细信息和高级用法可以参考 Gradle 官方文档 [More about tasks](https://docs.gradle.org/current/userguide/more_about_tasks.html)。
