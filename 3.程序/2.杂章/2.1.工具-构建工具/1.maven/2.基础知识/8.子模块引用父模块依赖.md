# 子模块引用父模块依赖

在 Maven 项目中，子模块可以通过继承父 POM（Project Object Model）文件来使用父模块的依赖和插件配置。这里有一些关键点需要注意，以确保子模块能够正确地使用父模块的依赖和插件：

1. **父 POM 的设置**：
   - 父 POM 文件的 `<packaging>` 类型应该设置为 `pom`，这表示它是一个聚合 POM，用于管理子模块。
   - 在父 POM 中，你可以使用 `<dependencyManagement>` 元素来定义子模块可以使用的依赖版本，但不需要在父 POM 中实际包含这些依赖的 `<scope>` 或 `<exclusions>`。
   - 类似地，你可以使用 `<pluginManagement>` 元素来定义子模块可以使用的插件版本和配置。

2. **子 POM 的设置**：
   - 子 POM 文件需要指定 `<parent>` 元素，其 `<groupId>`、`<artifactId>` 和 `<version>` 应该与父 POM 文件中的相应元素匹配。
   - 在子 POM 中，你可以直接添加那些在父 POM 的 `<dependencyManagement>` 中定义的依赖，而**不需要指定版本号（除非你想覆盖父 POM 中定义的版本）**。
   - 同样地，对于在父 POM 的 `<pluginManagement>` 中定义的插件，子 POM 可以直接配置这些插件，而不需要指定版本号或重复配置。

3. **构建过程**：
   - 当你在父 POM 所在的目录运行 `mvn clean install` 或其他 Maven 命令时，Maven 会首先解析父 POM，然后解析所有子 POM，并根据这些 POM 文件中的配置来构建项目。
   - 子模块会继承父模块的依赖和插件配置，除非在子 POM 中进行了覆盖。

4. **注意事项**：
   - 确保父 POM 和子 POM 之间的 `<groupId>` 和 `<artifactId>` 是正确且一致的。
   - 如果子模块需要额外的依赖或插件配置，应该在子 POM 中明确指定。
   - 如果父 POM 和子 POM 位于不同的目录中，你可能需要设置 `<relativePath>` 元素在子 POM 的 `<parent>` 部分，以指向父 POM 的位置（尽管在大多数情况下，如果父 POM 和子 POM 位于相同的父目录下，Maven 会自动找到它）。

## 示例

### 1. 创建父模块的 `pom.xml`

父模块的 `pom.xml` 通常会包含一些通用的配置和依赖，这些配置和依赖会被子模块继承。

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>parent-module</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>pom</packaging>

    <modules>
        <module>child-module1</module>
        <module>child-module2</module>
    </modules>

    <dependencyManagement>
        <dependencies>
            <!-- 父模块管理的依赖 -->
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-core</artifactId>
                <version>5.3.10</version>
            </dependency>
            <dependency>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-api</artifactId>
                <version>1.7.30</version>
            </dependency>
            <!-- 其他依赖 -->
        </dependencies>
    </dependencyManagement>

    <dependencies>
        <!-- 父模块自身的依赖 -->
    </dependencies>

    <build>
        <pluginManagement>
            <plugins>
                <!-- 配置插件 -->
            </plugins>
        </pluginManagement>
    </build>
</project>
```

### 2. 创建子模块的 `pom.xml`

子模块的 `pom.xml` 会引用父模块，并可以选择性地添加或覆盖父模块中定义的依赖。

#### 子模块1 (`child-module1`) 的 `pom.xml`

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.example</groupId>
        <artifactId>parent-module</artifactId>
        <version>1.0-SNAPSHOT</version>
        <relativePath>如果子模块与父模块不在同一目录，这里要指定父模块的pom.xml</relativePath>
    </parent>

    <artifactId>child-module1</artifactId>

    <dependencies>
        <!-- 引入父模块管理的依赖 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
        </dependency>
        <!-- 子模块特定的依赖 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
        </dependency>
    </dependencies>
</project>
```

#### 子模块2 (`child-module2`) 的 `pom.xml`

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.example</groupId>
        <artifactId>parent-module</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <artifactId>child-module2</artifactId>

    <dependencies>
        <!-- 引入父模块管理的依赖 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
        </dependency>
        <!-- 子模块特定的依赖 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
        </dependency>
    </dependencies>
</project>
```

### 3. 目录结构

确保你的项目目录结构类似于以下结构：

```txt
parent-module
|-- pom.xml
|-- child-module1
|   |-- pom.xml
|   |-- src
|       |-- main
|       |   |-- java
|       |   |-- resources
|       |-- test
|           |-- java
|           |-- resources
|-- child-module2
    |-- pom.xml
    |-- src
        |-- main
        |   |-- java
        |   |-- resources
        |-- test
            |-- java
            |-- resources
```

### 4. 构建项目

在父模块的根目录下运行 `mvn clean install`，Maven 会按照配置依次构建父模块和子模块，并处理依赖关系。

通过这种方式，子模块能够继承父模块中的依赖管理配置，并添加自己特定的依赖。这有助于保持项目依赖的一致性，并简化依赖管理。
