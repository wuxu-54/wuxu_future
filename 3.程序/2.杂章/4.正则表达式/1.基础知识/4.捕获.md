# 捕获与反引用

个人理解：`()`表示组，但这个元字符也表示一个捕获。通俗讲就是圈定了一个位置，后面学的反向引用时就可以通过`\数字`复用捕获的表达式。下面是搜到解释，有点复杂。

## 捕获和反引用是什么

正则表达式中的捕获（Capture）和反引用（Backreference）是两个相关但不同的概念，它们在处理字符串时非常有用，尤其是在需要匹配和操作特定模式时。

### 捕获（Capture）

捕获是指在正则表达式中通过圆括号 `()` 定义的分组，这些分组可以捕获并提取匹配的子字符串。捕获组是正则表达式中的一部分，它允许你捕获并稍后使用匹配到的文本。

**特点**：

1. 使用圆括号 `()` 来创建捕获组。
2. 捕获组可以包含任意数量的字符或模式。
3. 捕获的文本可以在同一个正则表达式中被多次引用。
4. 捕获组是按照它们出现的顺序编号的，从左到右，从1开始。

**示例**：

```regex
(\d{4})-(\d{2})-(\d{2})
```

这个正则表达式可以捕获日期格式中的年、月、日。例如，匹配字符串 "2023-05-17" 时，三个捕获组分别对应 "2023"、"05" 和 "17"。

### 反引用（Backreference）

反引用是指在正则表达式或替换操作中引用之前捕获组匹配到的内容。在正则表达式中，反引用通过反斜线 `\` 加上捕获组的编号来实现。在替换操作中，反引用可以通过特殊的语法（如 `$1`、`$2` 等）来实现。

**特点**：

1. 反引用允许你在正则表达式或替换字符串中使用之前捕获的文本。
2. 在正则表达式中，使用 `\1`、`\2` 等来引用第一个、第二个捕获组的内容。
3. 在替换字符串中，使用 `$1`、`$2` 等或命名捕获组的语法（如 `\k<name>` 或 `${name}`）来引用捕获的文本。
4. 反引用可以用于模式匹配，也可以用于替换操作。

**示例**：

1. **正则表达式中的反引用**：

    ```regex
    (\w)\1
    ```

    这个表达式匹配一个单词内相同的两个连续字母，如 "oo" 或 "bb"。

2. **替换操作中的反引用**：

    假设你想要将字符串 "Hello World" 中的 "World" 替换为 "Earth"，同时保留 "World" 的首字母大写，可以使用以下替换操作：

    ```regex
    replaceWith("Earth")
    ```

    如果原始文本是 "Hello World"，替换后将是 "Hello Earth"。

### 总结

- **捕获**是创建捕获组来提取匹配的子字符串的过程。
- **反引用**是在正则表达式或替换操作中引用之前捕获组匹配到的内容的方法。

这两个概念经常一起使用，因为捕获组提供了反引用所需的内容。通过结合使用捕获和反引用，你可以创建出能够匹配复杂模式并执行精确操作的正则表达式。

---

## 补充：命名捕获

正则表达式的命名捕获（Named Capture）是一种允许你给捕获组分配一个易于记忆的名称的技术，而不是使用数字来引用捕获组。这在正则表达式变得复杂时特别有用，因为使用名称比记住捕获组的编号更加直观和方便。

### 基本语法

在大多数支持命名捕获的正则表达式引擎中，你可以使用以下语法来创建命名捕获组：

```regex
(?<name>pattern)
```

其中：

- `?<` 和 `>` 包围捕获组的名称。
- `name` 是你为捕获组定义的名称，它可以包含字母、数字和下划线，但不能以数字开头。
- `pattern` 是你想要捕获的模式。

### 示例

1. **基本命名捕获**：

   ```regex
   (?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})
   ```

   这个正则表达式可以捕获日期格式中的年、月、日，并将它们分别命名为 `year`、`month` 和 `day`。

2. **在替换操作中使用命名捕获**：
   假设你想要将日期格式从 "2023-05-17" 转换为 "17/05/2023"，可以使用以下替换操作：

   ```regex
   replaceWith("${day}/${month}/${year}")
   ```

   结果将是 "17/05/2023"。

### 替换字符串中的命名捕获引用

在不同的编程语言中，命名捕获的引用方式可能有所不同。以下是一些常见语言中的命名捕获引用方法：

- **Python**：

  ```python
  import re

  text = "2023-05-17"
  pattern = r"(?P<year>\d{4})-(?P<month>\d{2})-(?P<day>\d{2})"
  result = re.sub(pattern, r"\g<day>/\g<month>/\g<year>", text)
  print(result)  # 输出: 17/05/2023
  ```

- **JavaScript**：

  ```javascript
  let text = "2023-05-17";
  let pattern = /(\d{4})-(\d{2})-(\d{2})/;
  let replacement = "$3/$2/$1";
  let result = text.replace(pattern, replacement);
  console.log(result);  // 输出: 17/05/2023
  ```

  在JavaScript中，命名捕获也可以通过 `$<name>` 的方式引用，但仅在ES2018及以后版本中支持。

- **Java**：

  ```java
  import java.util.regex.Matcher;
  import java.util.regex.Pattern;

  public class Main {
      public static void main(String[] args) {
          String text = "2023-05-17";
          String pattern = "(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})";
          Pattern r = Pattern.compile(pattern);
          Matcher m = r.matcher(text);
          String result = m.replaceAll("${day}/${month}/${year}");
          System.out.println(result);  // 输出: 17/05/2023
      }
  }
  ```

- **C#**：

  ```csharp
  using System;
  using System.Text.RegularExpressions;

  class Program
  {
      static void Main()
      {
          string text = "2023-05-17";
          string pattern = @"(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})";
          string result = Regex.Replace(text, pattern, m => $"{m.Groups["day"].Value}/{m.Groups["month"].Value}/{m.Groups["year"].Value}");
          Console.WriteLine(result);  // 输出: 17/05/2023
      }
  }
  ```

### 注意事项

- 命名捕获提供了一种更清晰的方式来引用捕获组，特别是在正则表达式中包含多个捕获组时。
- 命名捕获的语法可能会因不同的正则表达式引擎而异，所以在使用时需要参考具体语言或工具的文档。
- 在替换操作中，确保正确地引用了命名捕获组，以便正确地替换文本。
