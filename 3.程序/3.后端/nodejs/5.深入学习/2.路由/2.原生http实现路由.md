# 原生http实现路由

通过本节，学习路由最简单的实现，明白路由的作用。nodejs中的路由核心是响应URL的http请求过程，那么URL的解析GET、POST两种请求就很重要，解析主要使用两种库：url与querystring，具体使用方法可看后面章节了解。

```js
                              url.parse(string).query
                                           |
           url.parse(string).pathname      |
                       |                   |
                       |                   |
                     ------ -------------------
http://localhost:8888/start?foo=bar&hello=world
                                ---       -----
                                 |          |
                                 |          |
    querystring.parse(queryString)["foo"]   |
                                            |
                         querystring.parse(queryString)["hello"]
```

## 路由实现

### 1.创建router.js

建立一个名为 router.js 的文件

```js
//接收服务器传过来的路径数据，按路径匹配相关处理
function route(pathname) {
  console.log("About to route a request for " + pathname);
}
 
exports.route = route;
```

### 2.创建服务器路径解析文件

建立 server.js 文件

```js
var http = require("http");
var url = require("url");
 
 //这里取 router.js中的方法，作为参数
function start(route) {
  function onRequest(request, response) {
    var pathname = url.parse(request.url).pathname;
    console.log("Request for " + pathname + " received.");
 
    route(pathname);
 
    response.writeHead(200, {"Content-Type": "text/plain"});
    response.write("Hello World");
    response.end();
  }
 
  http.createServer(onRequest).listen(8888);
  console.log("Server has started.");
}
 
exports.start = start;
```

### 3.入口js设置

index.js 入口进行配置，将路由函数注入服务器中

```js
var server = require("./server");
var router = require("./router");
 
server.start(router.route);
```

至此，一个路由导航匹配请求路径的绑定逻辑就完成了。
