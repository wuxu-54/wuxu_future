# 使用

、以下是Apache POI的详细使用步骤及实例：

## 一、Apache POI的详细使用步骤

1. **引入Apache POI库**

    * 如果你使用Maven构建项目，可以在`pom.xml`文件中添加Apache POI的依赖。例如，对于Excel 2007及以上版本（.xlsx格式），你需要添加`poi`和`poi-ooxml`两个依赖。

        ```xml
        <dependencies>
            <dependency>
                <groupId>org.apache.poi</groupId>
                <artifactId>poi</artifactId>
                <version>最新版本号</version>
            </dependency>
            <dependency>
                <groupId>org.apache.poi</groupId>
                <artifactId>poi-ooxml</artifactId>
                <version>最新版本号</version>
            </dependency>
        </dependencies>
        ```

    * 如果你不使用Maven，也可以从Apache POI的官方网站下载JAR文件，并将其添加到项目的类路径中。

2. **创建或读取Excel文件**

    * **创建Excel文件**：使用`XSSFWorkbook`（对于.xlsx格式）或`HSSFWorkbook`（对于.xls格式）类创建一个新的Excel工作簿，然后使用`createSheet`方法创建一个新的工作表。接着，使用`createRow`和`createCell`方法创建行和单元格，并使用`setCellValue`方法设置单元格的内容。最后，使用`FileOutputStream`将工作簿写入到文件中。
    * **读取Excel文件**：使用`FileInputStream`类读取要操作的Excel文件，然后使用`WorkbookFactory.create`方法根据文件输入流创建工作簿对象。接着，使用`getSheetAt`或`getSheet`方法获取工作表对象，并使用循环遍历工作表中的所有行和单元格。最后，根据单元格的数据类型使用不同的方法获取具体的数据。

3. **处理Excel文件内容**

    * 你可以遍历工作表中的所有行和单元格，读取或修改其中的数据。如果需要，还可以对单元格的样式和格式进行自定义设置。

4. **关闭资源**

    * 在完成文件操作后，务必关闭文件输入流和工作簿对象，以释放资源。

## 二、Apache POI使用实例

### 实例1：创建Excel文件

以下是一个创建Excel文件的示例代码：

```java
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFCell;

import java.io.FileOutputStream;
import java.io.IOException;

public class CreateExcelExample {
    public static void main(String[] args) {
        // 创建一个工作簿
        XSSFWorkbook workbook = new XSSFWorkbook();
        
        // 创建一个工作表
        XSSFSheet sheet = workbook.createSheet("Example Sheet");
        
        // 创建第一行
        XSSFRow row1 = sheet.createRow(0);
        
        // 在第一行中创建单元格并设置值
        XSSFCell cell1 = row1.createCell(0);
        cell1.setCellValue("Hello, Apache POI!");
        
        // 创建第二行
        XSSFRow row2 = sheet.createRow(1);
        
        // 在第二行中创建单元格并设置值
        XSSFCell cell2 = row2.createCell(0);
        cell2.setCellValue(12345);
        
        // 将工作簿写入到文件中
        try (FileOutputStream outputStream = new FileOutputStream("example.xlsx")) {
            workbook.write(outputStream);
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            // 关闭工作簿
            try {
                workbook.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
```

### 实例2：读取Excel文件

以下是一个读取Excel文件的示例代码：

```java
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileInputStream;
import java.io.IOException;

public class ReadExcelExample {
    public static void main(String[] args) {
        // 创建文件输入流
        try (FileInputStream fis = new FileInputStream("example.xlsx")) {
            
            // 创建工作簿对象
            Workbook workbook = new XSSFWorkbook(fis);
            
            // 获取第一个工作表
            Sheet sheet = workbook.getSheetAt(0);
            
            // 遍历工作表中的行
            for (Row row : sheet) {
                
                // 遍历行中的单元格
                for (Cell cell : row) {
                    
                    // 获取单元格的值
                    CellType cellType = cell.getCellType();
                    if (cellType == CellType.STRING) {
                        System.out.print(cell.getStringCellValue() + "\t");
                    } else if (cellType == CellType.NUMERIC) {
                        System.out.print(cell.getNumericCellValue() + "\t");
                    } else if (cellType == CellType.BOOLEAN) {
                        System.out.print(cell.getBooleanCellValue() + "\t");
                    }
                }
                System.out.println();
            }
            
            // 关闭工作簿
            workbook.close();
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

通过以上步骤和实例，你可以轻松地使用Apache POI库来创建和读取Excel文件。同时，你也可以根据需要对单元格的样式和格式进行自定义设置，以及遍历工作表中的所有行和单元格来读取或修改其中的数据。
