# 使用实例

以下是一个SpringTask的使用实例，展示了如何配置和使用SpringTask来执行定时任务。

## 一、项目依赖

首先，你需要在项目的`pom.xml`文件中添加Spring Boot的依赖，以便使用SpringTask功能。如果你使用的是Spring Boot项目，通常只需要添加`spring-boot-starter`依赖即可，因为`spring-boot-starter`中已经包含了SpringTask的相关功能。

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter</artifactId>
</dependency>
```

## 二、启动类配置

在Spring Boot的启动类上添加`@EnableScheduling`注解，以启用定时任务功能。

```java
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableScheduling;

@SpringBootApplication
@EnableScheduling
public class SpringTaskApplication {
    public static void main(String[] args) {
        SpringApplication.run(SpringTaskApplication.class, args);
    }
}
```

## 三、定时任务类

创建一个新的Java类，用于定义定时任务。在这个类中，你可以使用`@Scheduled`注解来标注需要定时执行的方法。

```java
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;
import java.text.SimpleDateFormat;
import java.util.Date;

@Component
public class ScheduledTasks {

    private static final SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

    // 使用Cron表达式定义任务执行规则，例如每5秒执行一次
    @Scheduled(cron = "*/5 * * * * ?")
    public void taskWithCron() {
        System.out.println("[ScheduledTasks-taskWithCron] Current Time: " + dateFormat.format(new Date()));
    }

    // 使用fixedRate属性定义任务执行规则，例如每10秒执行一次
    @Scheduled(fixedRate = 10000)
    public void taskWithFixedRate() {
        System.out.println("[ScheduledTasks-taskWithFixedRate] Current Time: " + dateFormat.format(new Date()));
    }

    // 使用fixedDelay属性定义任务执行规则，例如在上一次任务执行完成后延迟5秒再次执行
    @Scheduled(fixedDelay = 5000)
    public void taskWithFixedDelay() throws InterruptedException {
        // 模拟任务执行时间
        Thread.sleep(3000);
        System.out.println("[ScheduledTasks-taskWithFixedDelay] Current Time: " + dateFormat.format(new Date()));
    }
}
```

## 四、运行项目

配置完成后，运行Spring Boot项目。在控制台中，你应该能够看到定时任务按照预设的规则执行，并打印出当前时间。

## 五、注意事项

1. **线程池配置**：默认情况下，SpringTask使用Spring创建的默认线程池来执行定时任务。如果需要自定义线程池大小或其他属性，可以通过实现`SchedulingConfigurer`接口来配置。
2. **异常处理**：在定时任务方法中，应该添加适当的异常处理逻辑，以避免任务执行失败导致系统不稳定。
3. **任务执行顺序**：默认情况下，SpringTask中的定时任务是串行执行的。如果需要并行执行任务，可以使用`@Async`注解或配置多个线程池来实现。
4. **Cron表达式**：Cron表达式是一个强大的工具，可以定义复杂的任务执行规则。在使用时，应该确保Cron表达式的正确性，以避免任务未按预期执行。

通过以上步骤，你就可以在Spring Boot项目中使用SpringTask来执行定时任务了。
