# xml定义sql映射

在 MyBatis 中，使用 XML 映射文件来定义 SQL 语句是一种常见的做法。这些映射文件通常与 Mapper 接口一起使用，提供了一种灵活的方式来配置 SQL 语句和结果集的映射。以下是如何在 XML 映射文件中定义 SQL 映射的基本步骤：
>更多细节内容，请看官网说明文档，讲的很全面。

## 1. 定义 Mapper 接口

首先，你需要定义一个 Mapper 接口，该接口中的方法将与 XML 映射文件中的 SQL 语句相对应。

```java
public interface UserMapper {
    User selectUserById(int id);
    void insertUser(User user);
    // 其他 CRUD 操作
}
```

## 2. 创建 XML 映射文件

创建一个 XML 文件，通常与 Mapper 接口同名，并放在与接口相同的包路径下。在这个 XML 文件中，你将定义 SQL 语句和结果集的映射。

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.UserMapper">

    <!-- 定义一个 select 语句 -->
    <select id="selectUserById" parameterType="int" resultType="com.example.domain.User">
        SELECT * FROM users WHERE id = #{id}
    </select>

    <!-- 定义一个 insert 语句 -->
    <insert id="insertUser" parameterType="com.example.domain.User">
        INSERT INTO users (username, email) VALUES (#{username}, #{email})
    </insert>

    <!-- 其他 CRUD 操作 -->

</mapper>
```

## 3. 配置 MyBatis

在 MyBatis 的全局配置文件 `mybatis-config.xml` 中，注册你的 Mapper XML 映射文件。

```xml
<configuration>
    <mappers>
        <mapper resource="com/example/mapper/UserMapper.xml"/>
    </mappers>
</configuration>
```

或者，你可以使用类扫描的方式自动注册 Mapper 接口。

```xml
<configuration>
    <mappers>
        <mapper class="com.example.mapper.UserMapper"/>
    </mappers>
</configuration>
```

## 4. 使用 Mapper 接口

在你的应用程序中，通过 MyBatis 的 `SqlSession` 获取 Mapper 接口的实例，并调用其方法执行 SQL 操作。

```java
try (SqlSession session = sqlSessionFactory.openSession()) {
    UserMapper mapper = session.getMapper(UserMapper.class);
    User user = mapper.selectUserById(1);
    System.out.println(user.getUsername());
}
```

## 5. 定义复杂的 SQL 映射

对于复杂的 SQL 查询，你可以在 XML 映射文件中使用 MyBatis 提供的动态 SQL 元素，如 `<if>`、`<choose>`、`<when>`、`<otherwise>` 和 `<foreach>`。

```xml
<select id="selectUsersIf" resultType="com.example.domain.User">
    SELECT * FROM users
    <where>
        <if test="id != null">
            id = #{id}
        </if>
        <if test="username != null">
            AND username = #{username}
        </if>
    </where>
</select>
```

XML 映射文件提供了强大的灵活性，允许你定义复杂的 SQL 查询和结果集映射，同时也使得 SQL 语句与 Java 代码分离，提高了代码的可维护性。
