# 配置

MyBatis 是一个流行的 Java 持久层框架，它提供了数据库交互的抽象层，使得开发者可以使用对象导向的方式来操作数据库。以下是 MyBatis 的一些基础使用语法：

## 1. 配置 MyBatis

首先，你需要在 `mybatis-config.xml` 文件中配置 MyBatis 的环境设置，包括数据库连接信息、事务管理、映射器等。

```xml
<configuration>
    <environments default="development">
        <environment id="development">
            <transactionManager type="JDBC"/>
            <dataSource type="POOLED">
                <property name="driver" value="com.mysql.cj.jdbc.Driver"/>
                <property name="url" value="jdbc:mysql://localhost:3306/yourdatabase"/>
                <property name="username" value="root"/>
                <property name="password" value="password"/>
            </dataSource>
        </environment>
    </environments>
    <mappers>
        <mapper resource="mappers/UserMapper.xml"/>
    </mappers>
</configuration>
```

## 2. 定义 SQL 映射文件

在映射文件中，你可以定义 SQL 语句和它们对应的 Java 方法。

```xml
<!-- UserMapper.xml -->
<mapper namespace="com.example.mapper.UserMapper">
    <select id="findUserById" parameterType="int" resultType="com.example.domain.User">
        SELECT * FROM users WHERE id = #{id}
    </select>

    <insert id="insertUser" parameterType="com.example.domain.User">
        INSERT INTO users (username, email) VALUES (#{username}, #{email})
    </insert>

    <update id="updateUser" parameterType="com.example.domain.User">
        UPDATE users SET username = #{username}, email = #{email} WHERE id = #{id}
    </update>

    <delete id="deleteUser" parameterType="int">
        DELETE FROM users WHERE id = #{id}
    </delete>
</mapper>
```

## 3. 使用 MyBatis 操作数据库

在你的 Java 代码中，你可以使用 `SqlSession` 来执行定义在映射文件中的 SQL 语句。

```java
try (SqlSession session = sqlSessionFactory.openSession()) {
    UserMapper mapper = session.getMapper(UserMapper.class);
    
    // 查询
    User user = mapper.findUserById(1);
    System.out.println(user.getUsername());
    
    // 插入
    User newUser = new User(null, "john_doe", "john@example.com");
    mapper.insertUser(newUser);
    
    // 更新
    user.setEmail("new_email@example.com");
    mapper.updateUser(user);
    
    // 删除
    mapper.deleteUser(1);
    
    // 提交事务
    session.commit();
}
```

## 4. 使用注解的方式定义映射

除了使用 XML 映射文件，MyBatis 也支持使用注解来定义 SQL 映射。

```java
@Mapper
public interface UserMapper {
    @Select("SELECT * FROM users WHERE id = #{id}")
    User findUserById(int id);
    
    @Insert("INSERT INTO users (username, email) VALUES (#{username}, #{email})")
    void insertUser(User user);
    
    @Update("UPDATE users SET username = #{username}, email = #{email} WHERE id = #{id}")
    void updateUser(User user);
    
    @Delete("DELETE FROM users WHERE id = #{id}")
    void deleteUser(int id);
}
```

## 5. 配置和使用 MyBatis-Spring 集成

如果你使用的是 Spring 框架，可以通过配置 `SqlSessionFactoryBean` 和 `MapperScannerConfigurer` 来集成 MyBatis。

```xml
<!-- mybatis-spring-config.xml -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mybatis-spring="http://mybatis.org/schema/mybatis-spring"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://mybatis.org/schema/mybatis-spring
                           http://mybatis.org/schema/mybatis-spring.xsd">

    <mybatis-spring:sqlSessionFactoryBean dataSource="dataSource" configLocation="classpath:mybatis-config.xml"/>
    <mybatis-spring:mapper-scanner basePackage="com.example.mapper"/>
</beans>
```

在 Spring 应用程序中，你可以直接通过自动装配（@Autowired）来使用 Mapper 接口。

```java
@Service
public class UserService {
    @Autowired
    private UserMapper userMapper;

    public User getUserById(int id) {
        return userMapper.findUserById(id);
    }
}
```

这些是 MyBatis 的基础使用语法，通过这些语法，你可以实现对数据库的基本操作。在实际开发中，你可能还需要了解更多高级特性，如动态 SQL、缓存机制、事务管理等。
