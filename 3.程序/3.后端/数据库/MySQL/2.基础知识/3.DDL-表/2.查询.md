# 查询表

在 MySQL 中，查询表是使用 SQL (Structured Query Language) 语句从数据库表中检索数据的过程。最常用的查询语句是 `SELECT`。以下是一些基本的查询示例：

## 1. 查询所有列

要查询表中的所有列，可以使用星号（*）作为通配符：

```sql
SELECT * FROM table_name;
```

## 2. 查询特定列

如果你只对某些列感兴趣，可以指定列名：

```sql
SELECT column1, column2 FROM table_name;
```

## 3. 查询有条件的数据

使用 `WHERE` 子句来过滤记录：

```sql
SELECT * FROM table_name WHERE condition;
```

例如，查询年龄大于30的所有员工：

```sql
SELECT * FROM employees WHERE age > 30;
```

## 4. 查询去重的数据

使用 `DISTINCT` 关键字来返回唯一不同的值：

```sql
SELECT DISTINCT column1 FROM table_name;
```

## 5. 排序查询结果

使用 `ORDER BY` 子句对结果进行排序：

```sql
SELECT * FROM table_name ORDER BY column1 ASC, column2 DESC;
```

## 6. 限制查询结果的数量

使用 `LIMIT` 子句来限制返回的记录数：

```sql
SELECT * FROM table_name LIMIT number;
```

## 7. 使用聚合函数

聚合函数如 `COUNT()`, `SUM()`, `AVG()`, `MAX()`, `MIN()` 等可以用来进行统计计算：

```sql
SELECT COUNT(*) FROM table_name;
SELECT AVG(column1) FROM table_name;
```

## 8. 分组查询

使用 `GROUP BY` 子句对结果集进行分组：

```sql
SELECT column1, COUNT(*) FROM table_name GROUP BY column1;
```

## 9. 连接查询

使用 `JOIN` 子句来连接多个表：

```sql
SELECT * FROM table1 INNER JOIN table2 ON table1.column_name = table2.column_name;
```

## 10. 子查询

子查询是嵌套在另一个查询中的查询：

```sql
SELECT * FROM table_name WHERE column1 IN (SELECT column1 FROM other_table WHERE condition);
```

## 11. 联合查询

使用 `UNION` 或 `UNION ALL` 来合并两个或多个 `SELECT` 语句的结果集：

```sql
SELECT column1 FROM table1
UNION
SELECT column1 FROM table2;
```

## 12. 使用别名

为表或列指定别名，使查询更清晰：

```sql
SELECT column1 AS alias_name FROM table_name;
```

这些是 MySQL 查询的一些基本示例。实际查询可能会更复杂，包括多个表的连接、复杂的条件和子查询等。根据你的具体需求，可以组合使用这些不同的查询选项。

---

## 子查询细讲

在MySQL中，子查询（也称为内联视图或嵌套查询）是嵌套在另一个查询中的SQL查询。子查询可以是简单的，只返回一个值，也可以是复杂的，返回多行多列。子查询通常用在`SELECT`、`INSERT`、`UPDATE`、`DELETE`等语句中。

子查询的使用场景包括但不限于：

1. **作为条件**：在`WHERE`或`HAVING`子句中使用，用于比较或计算。
2. **作为列**：在`SELECT`列表中返回子查询的结果。
3. **作为表**：在`FROM`子句中返回一个结果集，可以像普通表一样进行查询。
4. **作为表达式**：在`SELECT`列表或`WHERE`子句中返回一个计算值。

### 子查询的类型

#### 1. 标量子查询

返回单个值的子查询，通常用在`SELECT`列表、`WHERE`子句等地方。

```sql
SELECT column_name
FROM table_name
WHERE column_name = (SELECT another_column_name FROM another_table_name WHERE condition);
```

#### 2. 表子查询

返回多行多列的子查询，通常用在`FROM`子句中。

```sql
SELECT *
FROM (SELECT column_name FROM table_name WHERE condition) AS subquery_alias
WHERE another_condition;
```

#### 3. 列子查询

返回多个值的子查询，通常用在`IN`子句中。

```sql
SELECT *
FROM table_name
WHERE column_name IN (SELECT another_column_name FROM another_table_name WHERE condition);
```

#### 4. 行子查询

返回单行多列的子查询，通常用在`IN`子句中。

```sql
SELECT *
FROM table_name
WHERE (column1, column2) IN (SELECT another_column1, another_column2 FROM another_table_name WHERE condition);
```

### 子查询的使用示例

#### 示例1：标量子查询

```sql
SELECT *
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```

这个查询返回薪资高于员工平均工资的所有员工。

#### 示例2：表子查询

```sql
SELECT *
FROM (
    SELECT department_id, AVG(salary) AS avg_salary
    FROM employees
    GROUP BY department_id
) AS dept_salaries
WHERE avg_salary > 50000;
```

这个查询返回平均工资超过50000的部门及其平均工资。

#### 示例3：列子查询

```sql
SELECT *
FROM employees
WHERE department_id IN (SELECT department_id FROM departments WHERE location = 'New York');
```

这个查询返回在纽约部门工作的员工。

#### 示例4：行子查询

```sql
SELECT *
FROM employees
WHERE (salary, department_id) IN (SELECT MAX(salary), department_id FROM employees GROUP BY department_id);
```

这个查询返回每个部门薪资最高的员工。

### 注意事项

- 子查询必须用括号括起来。
- 子查询中不能包含`ORDER BY`子句（除非子查询是一个`SELECT`语句，并且该语句被用在`FROM`子句中）。
- 子查询通常在`WHERE`或`SELECT`子句中使用，但也可以用于`HAVING`或`IN`等子句。
- 子查询可以是相关子查询，即子查询中引用了外部查询的表。

子查询是MySQL中非常强大的功能，可以用于各种复杂的数据检索和操作。
