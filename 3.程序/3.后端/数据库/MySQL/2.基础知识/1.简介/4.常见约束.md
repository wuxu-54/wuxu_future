# 常见约束

在 MySQL 中，约束用于确保数据库中数据的准确性和可靠性。以下是一些常见的 MySQL 约束：

1. **PRIMARY KEY（主键）**：
   - 唯一标识表中的每一行记录。
   - 一个表中只能有一个主键。
   - 主键列不能包含 NULL 值。

2. **FOREIGN KEY（外键）**：
   - 用于建立两个表之间的关系，确保数据的一致性。
   - 外键列的值必须在其所引用的表的主键列中存在，或者是 NULL。

3. **UNIQUE（唯一约束）**：
   - 保证列中的所有值都是不同的。
   - 可以有多个列组合成唯一约束，称为复合唯一索引。

4. **NOT NULL（非空约束）**：
   - 确保列中的值不能为 NULL。

5. **CHECK（检查约束）**：
   - 用于确保列中的值满足特定的条件。
   - 在 MySQL 中，检查约束的支持有限，通常在实际应用中使用较少。

6. **DEFAULT（默认值约束）**：
   - 当没有为列提供值时，将使用默认值。

7. **INDEX（索引）**：
   - 虽然不是约束，但索引可以加快数据检索速度，并且可以与 UNIQUE 约束结合使用，强制列或列组合的唯一性。

8. **AUTO_INCREMENT（自增约束）**：
   - 用于数字类型的列，可以自动为新记录生成一个比表中现有最大值更大的数字。

9. **COLLATE（校对规则）**：
   - 用于定义列的排序规则和比较规则，主要用于字符类型的列。

10. **FULLTEXT（全文索引）**：
    - 用于在大型文本字段中进行全文搜索。

在创建表或修改表时，可以定义这些约束来保证数据的完整性和准确性。例如：

```sql
CREATE TABLE customers (
    customer_id INT AUTO_INCREMENT PRIMARY KEY,
    customer_name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE,
    registration_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

在这个例子中，`customer_id` 被定义为主键和自增，`customer_name` 必须非空，`email` 必须是唯一的，而 `registration_date` 则有一个默认值，即当前的时间戳。

---

## 常见约束的操作

在 MySQL 中，约束用于确保数据库中数据的完整性和准确性。以下是一些常见的约束类型以及如何添加、删除和修改它们的示例：

### 1. 主键约束（PRIMARY KEY）

- **添加主键**：

  ```sql
  ALTER TABLE table_name ADD PRIMARY KEY (column_name);
  ```

- **删除主键**：

  ```sql
  ALTER TABLE table_name DROP PRIMARY KEY;
  ```

- **修改主键**（例如，将多个列的组合作为主键）：

  ```sql
  ALTER TABLE table_name DROP PRIMARY KEY, ADD PRIMARY KEY (column_name1, column_name2);
  ```

### 2. 外键约束（FOREIGN KEY）

- **添加外键**：

  ```sql
  ALTER TABLE child_table ADD FOREIGN KEY (column_name) REFERENCES parent_table(parent_column);
  ```

- **删除外键**：

  ```sql
  ALTER TABLE child_table DROP FOREIGN KEY fk_name;
  ```

  （`fk_name` 是外键的名称，可以通过 `SHOW CREATE TABLE` 查看）

### 3. 唯一约束（UNIQUE）

- **添加唯一约束**：

  ```sql
  ALTER TABLE table_name ADD UNIQUE (column_name);
  ```

- **删除唯一约束**：

  ```sql
  ALTER TABLE table_name DROP INDEX unique_index_name;
  ```

  （`unique_index_name` 是唯一索引的名称，可以通过 `SHOW INDEXES` 查看）

### 4. 非空约束（NOT NULL）

- **添加非空约束**：

  ```sql
  ALTER TABLE table_name MODIFY column_name column_type NOT NULL;
  ```

- **删除非空约束**：

  ```sql
  ALTER TABLE table_name MODIFY column_name column_type;
  ```

### 5. 默认值约束（DEFAULT）

- **添加默认值约束**：

  ```sql
  ALTER TABLE table_name ALTER column_name SET DEFAULT default_value;
  ```

- **删除默认值约束**：

  ```sql
  ALTER TABLE table_name ALTER column_name DROP DEFAULT;
  ```

### 6. 检查约束（CHECK）

- **添加检查约束**（MySQL 8.0.16+ 支持）：

  ```sql
  ALTER TABLE table_name ADD CHECK (column_name condition);
  ```

- **删除检查约束**：

  ```sql
  ALTER TABLE table_name DROP CHECK check_constraint_name;
  ```

  （`check_constraint_name` 是检查约束的名称，可以通过 `SHOW CREATE TABLE` 查看）

### 7. 自增约束（AUTO_INCREMENT）

- **添加自增约束**：

  ```sql
  ALTER TABLE table_name MODIFY column_name INT AUTO_INCREMENT;
  ```

- **删除自增约束**：

  ```sql
  ALTER TABLE table_name MODIFY column_name INT;
  ```

请注意，修改表结构可能会影响数据库的性能，特别是在生产环境中。在执行这些操作之前，请确保你已经备份了数据，并且了解这些更改的影响。此外，确保在执行这些操作时数据库连接数较少，以减少对业务的影响。
