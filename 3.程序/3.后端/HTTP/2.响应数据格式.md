# 响应数据格式

HTTP 响应是服务器对客户端请求的答复，它也遵循一定的格式和规则。一个典型的 HTTP 响应由以下几个部分组成：

1. **状态行（Status Line）**：
   - 包含 HTTP 版本、状态码和状态消息。
   - 状态码是一个三位数字，表示请求的结果，如 200 表示成功，404 表示未找到资源。

   格式示例：`HTTP/1.1 200 OK`

2. **响应头（Response Headers）**：
   - 包含了响应的附加信息，如服务器信息、内容类型、内容长度等。
   - 常见的响应头包括 `Content-Type`、`Content-Length`、`Server`、`Set-Cookie` 等。

   例如：

   ```txt
   Content-Type: text/html; charset=UTF-8
   Content-Length: 12345
   Server: Apache/2.4.1 (Unix)
   Set-Cookie: sessionId=abc123; Expires=Wed, 09 Jun 2021 10:18:14 GMT
   ```

3. **空行（Empty Line）**：
   - 响应头和响应体之间的空行，表示响应头的结束。

   例如：

   ```txt
   Content-Type: text/html; charset=UTF-8
   Content-Length: 12345
   Server: Apache/2.4.1 (Unix)
   Set-Cookie: sessionId=abc123; Expires=Wed, 09 Jun 2021 10:18:14 GMT

   ```

4. **响应体（Response Body）**：
   - 也称为消息体或实体，包含了服务器返回给客户端的实际数据。
   - 对于 HTML 页面，响应体就是 HTML 代码；对于图片，响应体就是图片的二进制数据；对于 JSON API，响应体就是 JSON 格式的数据。

   例如：

   ```txt
   <html>
     <head><title>Example Page</title></head>
     <body>
       <p>Hello, world!</p>
     </body>
   </html>
   ```

## 文本示例

一个完整的 HTTP 响应示例：

```txt
HTTP/1.1 200 OK
Content-Type: text/html; charset=UTF-8
Content-Length: 12345
Server: Apache/2.4.1 (Unix)
Set-Cookie: sessionId=abc123; Expires=Wed, 09 Jun 2021 10:18:14 GMT

<html>
  <head><title>Example Page</title></head>
  <body>
    <p>Hello, world!</p>
  </body>
</html>
```

在这个示例中，服务器使用 HTTP/1.1 协议返回了一个状态码为 200 的响应，表示请求成功。响应头中包含了内容类型、内容长度、服务器信息和设置的 Cookie。响应体部分包含了一个简单的 HTML 页面。

需要注意的是，并非所有的 HTTP 响应都包含响应体，例如某些 HEAD 请求可能只返回响应头而不包含响应体。此外，响应头的类型和数量会根据实际的响应内容而有所不同。

---

## HTTP 状态码

HTTP 状态码是服务器响应请求时返回的三位数代码，用来表示请求的结果。这些状态码分为五个类别，每个类别代表了不同的信息：

### 1xx（信息性状态码）

- **100 Continue**：继续。客户端应继续其请求。
- **101 Switching Protocols**：切换协议。服务器根据客户端的请求切换协议。

### 2xx（成功状态码）

- **200 OK**：成功。请求已正常处理完毕。
- **201 Created**：已创建。请求成功并且服务器创建了新的资源。
- **202 Accepted**：已接受。服务器已接受请求，但尚未处理。
- **204 No Content**：无内容。服务器成功处理了请求，但没有返回任何内容。

### 3xx（重定向状态码）

- **300 Multiple Choices**：多种选择。请求的资源可从多个位置选择。
- **301 Moved Permanently**：永久移动。请求的资源已被永久移动到新位置。
- **302 Found**：找到。请求的资源临时从不同的 URI 响应。
- **303 See Other**：查看其他位置。建议客户端访问一个不同的 URI。
- **304 Not Modified**：未修改。自从上次请求后，资源未被修改。
- **307 Temporary Redirect**：临时重定向。与302类似，但不允许请求方法从POST变成GET。
- **308 Permanent Redirect**：永久重定向。与301类似，但用于客户端和服务器之间的重定向。

### 4xx（客户端错误状态码）

- **400 Bad Request**：错误请求。服务器无法理解请求格式。
- **401 Unauthorized**：未授权。请求需要用户的身份认证。
- **403 Forbidden**：禁止访问。服务器理解请求但拒绝执行。
- **404 Not Found**：未找到。服务器找不到请求的资源。
- **405 Method Not Allowed**：方法不被允许。请求方法（GET、POST等）对请求的资源不适用。
- **408 Request Timeout**：请求超时。服务器等待客户端发送请求时超时。
- **409 Conflict**：冲突。请求与服务器当前状态冲突。
- **410 Gone**：已删除。请求的资源已被永久删除。
- **413 Payload Too Large**：负载太大。请求体过大，超出服务器处理能力。
- **414 URI Too Long**：URI 过长。请求的 URI 长度超出服务器能够处理的范围。
- **415 Unsupported Media Type**：不支持的媒体类型。请求的格式不受请求方法的支持。
- **429 Too Many Requests**：请求过多。用户在给定时间内发送了太多请求。

### 5xx（服务器错误状态码）

- **500 Internal Server Error**：内部服务器错误。服务器遇到错误，无法完成请求。
- **501 Not Implemented**：未实现。服务器不支持请求的功能，无法完成请求。
- **502 Bad Gateway**：错误网关。服务器作为网关或代理，从上游服务器收到无效响应。
- **503 Service Unavailable**：服务不可用。服务器暂时过载或维护，无法处理请求。
- **504 Gateway Timeout**：网关超时。网关或代理在等待上游服务器响应时超时。
- **505 HTTP Version Not Supported**：HTTP 版本不受支持。服务器不支持请求的 HTTP 协议版本。

这些状态码是 HTTP 协议的一部分，它们帮助客户端理解请求的处理结果，并根据状态码采取相应的措施。

---

## 响应头参数

HTTP 响应头（Response Headers）是服务器在响应客户端的 HTTP 请求时发送的一组头信息，它们提供了关于响应的附加信息。以下是一些常见的 HTTP 响应头参数及其含义和常见值：

1. **Cache-Control**：
   - **含义**：指定请求和响应遵循的缓存指令。
   - **常见值**：`no-cache`, `no-store`, `must-revalidate`, `max-age=3600`

2. **Connection**：
   - **含义**：控制持久连接选项。
   - **常见值**：`keep-alive`, `close`

3. **Content-Encoding**：
   - **含义**：指定响应体的压缩格式。
   - **常见值**：`gzip`, `deflate`, `br` (Brotli)

4. **Content-Length**：
   - **含义**：指定响应体的长度，单位为字节。
   - **常见值**：`1234`

5. **Content-Type**：
   - **含义**：指定响应体的媒体类型和字符编码。
   - **常见值**：`text/html; charset=UTF-8`, `application/json`

6. **Date**：
   - **含义**：指定响应发送的日期和时间。
   - **常见值**：`Mon, 01 Jun 2023 12:00:00 GMT`

7. **ETag**：
   - **含义**：响应体的版本标识符，用于缓存和条件请求。
   - **常见值**：`"xyzabc"`

8. **Expires**：
   - **含义**：指定响应体的过期日期和时间。
   - **常见值**：`Thu, 01 Dec 2023 12:00:00 GMT`

9. **Last-Modified**：
   - **含义**：指定资源的最后修改日期和时间。
   - **常见值**：`Mon, 01 Jun 2023 12:00:00 GMT`

10. **Location**：
    - **含义**：用于重定向接收端到一个新的 URI。
    - **常见值**：`http://www.example.com/newpage.html`

11. **Pragma**：
    - **含义**：包含实现特定的指令，通常用于控制缓存。
    - **常见值**：`no-cache`

12. **Server**：
    - **含义**：包含服务器软件的名称和版本。
    - **常见值**：`Apache/2.4.1 (Unix)`, `nginx/1.18.0`

13. **Set-Cookie**：
    - **含义**：用于在客户端设置一个 cookie。
    - **常见值**：`sessionId=abc123; Expires=Wed, 09 Jun 2023 10:18:14 GMT; Path=/`

14. **Strict-Transport-Security**：
    - **含义**：指示客户端（如浏览器）仅通过 HTTPS 与服务器通信。
    - **常见值**：`max-age=31536000; includeSubDomains`

15. **Transfer-Encoding**：
    - **含义**：指定传输编码头信息，用于控制数据的传输方式。
    - **常见值**：`chunked`

16. **Vary**：
    - **含义**：告诉缓存服务器响应如何变化，基于请求头中的某些值。
    - **常见值**：`Accept-Encoding`, `User-Agent`

17. **WWW-Authenticate**：
    - **含义**：用于 HTTP 认证，提示客户端需要提供身份验证信息。
    - **常见值**：`Basic realm="Access to the staging site"`, `Bearer realm="Service"`

18. **X-Frame-Options**：
    - **含义**：指示是否允许浏览器在 `<frame>`、`<iframe>`、`<embed>` 或 `<applet>` 中显示页面。
    - **常见值**：`DENY`, `SAMEORIGIN`

19. **X-XSS-Protection**：
    - **含义**：开启浏览器的 XSS 过滤和阻止所有 XSS 攻击。
    - **常见值**：`1; mode=block`

20. **Content-Security-Policy**：
    - **含义**：指定哪些动态资源是可信任的，以减少 XSS 攻击的风险。
    - **常见值**：`script-src 'self'`

这些响应头参数提供了关于响应的元数据，可以帮助客户端正确处理响应内容，同时也增强了安全性和用户体验。
