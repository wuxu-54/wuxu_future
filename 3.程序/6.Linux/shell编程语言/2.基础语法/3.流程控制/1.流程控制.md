# 流程控制

Shell脚本中的流程控制语句允许你根据条件执行不同的命令序列。以下是一些基本的流程控制结构：

## if语句

```bash
#!/bin/bash

if [ "$1" = "-h" ]; then
    echo "Usage: $0 [option]"
elif [ "$1" = "--help" ]; then
    echo "This is a help message."
else
    echo "No option was provided."
fi
```

## for循环

```bash
#!/bin/bash

for file in *.txt; do
    echo "Processing $file"
    # Do something with each .txt file
done
```

## while循环

```bash
#!/bin/bash

while [ true ]; do
    echo "This is an infinite loop."
    sleep 1
done
```

## until循环

```bash
#!/bin/bash

until [ some_condition ]; do
    # Commands to execute
done
```

## case语句

```bash
#!/bin/bash

case "$1" in
    -a)
        echo "Option -a selected"
        ;;
    -b)
        echo "Option -b selected"
        ;;
    *)
        echo "No option selected"
        ;;
esac
```

## 函数

```bash
#!/bin/bash

my_function() {
    echo "This is a function"
}

my_function
```

## coproc（协程）

从Bash 4.0开始，可以使用`coproc`来创建类似协程的执行环境。

```bash
#!/bin/bash

coproc my_coproc {
    sleep 1
    echo "This is from a coproc"
}
```

## break和continue

- `break`：跳出最近的for、while、until或C风格的for循环。
- `continue`：跳过当前循环的剩余部分，直接开始下一次循环。

```bash
#!/bin/bash

for ((i=0; i<5; i++)); do
    if [ $i -eq 2 ]; then
        continue
    fi
    echo "i: $i"
done
```

## return

在函数中使用`return`可以结束函数并返回一个状态码。

```bash
#!/bin/bash

my_function() {
    local result=123
    return $result
}

return_value=$(my_function)
echo "Function returned: $return_value"
```

## trap

`trap`用于捕捉信号并执行特定的命令。

```bash
#!/bin/bash

trap "echo 'Script was interrupted.'" SIGINT
```

## getopts

`getopts`是一个用于解析位置参数的内置命令。

```bash
#!/bin/bash

while getopts "a:b:" opt; do
    case $opt in
        a) arg_a=$OPTARG ;;
        b) arg_b=$OPTARG ;;
    esac
done
```

流程控制是编写复杂Shell脚本的关键。通过组合使用不同的流程控制语句，你可以创建出功能强大、逻辑清晰的脚本。
