# chmod 权限配置

在 Linux/Unix 系统中，`chmod` 命令用于修改文件或目录的访问权限，权限分为 **用户（Owner）、组（Group）、其他用户（Others）** 三类三个维度，每个维度可设置 **读（Read）、写（Write）、执行（Execute）** 三种权限。以下是详细说明：

## 一、权限的两种表示方式

### 1. 符号表示法（直观易懂）

用字符表示权限类型和操作对象：

- **操作对象**：
  - `u`：文件所有者（User）
  - `g`：所属组用户（Group）
  - `o`：其他用户（Others）
  - `a`：所有用户（All，等价于 `ugo`）

- **权限类型**：
  - `r`：读权限（Read）：对文件可查看内容，对目录可列出内容（`ls`）
  - `w`：写权限（Write）：对文件可修改内容，对目录可创建/删除文件
  - `x`：执行权限（Execute）：对文件可运行（如脚本/程序），对目录可进入（`cd`）

- **操作符**：
  - `+`：添加权限
  - `-`：移除权限
  - `=`：设置权限（覆盖原有权限）

### 2. 数字表示法（简洁高效）

用 **3位八进制数字** 表示权限（每一位对应一个维度，范围0-7）：

- 第一位：所有者权限
- 第二位：所属组权限
- 第三位：其他用户权限

每个数字由权限对应的数值相加得到：

- `r` 对应 **4**
- `w` 对应 **2**
- `x` 对应 **1**
- 无权限对应 **0**

常见数字组合：

| 数字 | 对应权限 | 含义 |
|------|----------|------|
| 7 | `rwx` | 读+写+执行 |
| 6 | `rw-` | 读+写 |
| 5 | `r-x` | 读+执行 |
| 4 | `r--` | 只读 |
| 3 | `-wx` | 写+执行 |
| 2 | `-w-` | 只写 |
| 1 | `--x` | 只执行 |
| 0 | `---` | 无权限 |

## 二、常用 `chmod` 命令示例

### 1. 符号表示法示例

```bash
# 给文件所有者添加执行权限
chmod u+x file.sh

# 移除所属组的写权限
chmod g-w data.txt

# 给所有用户添加读权限
chmod a+r docs/

# 设置所有者为读+写，组和其他用户为只读（覆盖原有权限）
chmod u=rw,go=r report.pdf

# 给所有者和组添加读+写+执行，其他用户无权限
chmod ug=rwx,o= file.sh
```

### 2. 数字表示法示例

```bash
# 所有者读+写+执行，组和其他用户只读（644是文件常见权限）
chmod 744 script.sh

# 所有者读+写+执行，组读+执行，其他用户无权限（750是目录常见权限）
chmod 750 logs/

# 所有用户都有读+写+执行（危险！谨慎使用）
chmod 777 temp/

# 所有者读+写，组和其他用户无权限
chmod 600 private.key
```

## 三、特殊权限（进阶）

除基础权限外，还有三个特殊权限（需用4位数字表示，第一位为特殊权限）：

| 特殊权限 | 数字 | 符号 | 作用 |
|----------|------|------|------|
| Set UID（SUID） | 4 | `s` | 执行文件时，临时获得文件所有者权限（如 `passwd` 命令） |
| Set GID（SGID） | 2 | `s` | 执行文件时，临时获得所属组权限；对目录，新文件继承目录的组 |
| Sticky Bit | 1 | `t` | 对目录，只有文件所有者和root可删除该目录下的文件（如 `/tmp`） |

示例：

```bash
# 设置SUID（4755：4是SUID，755是基础权限）
chmod 4755 /usr/bin/passwd

# 设置Sticky Bit（1777：1是Sticky，777是基础权限）
chmod 1777 /tmp
```

## 四、常见文件/目录权限建议

- **普通文件**：默认 `644`（所有者读写，其他只读）
- **可执行脚本**：`755`（所有者读写执行，其他读执行）
- **私人文件**：`600`（仅所有者读写）
- **目录**：`755`（所有者完全控制，其他可进入和查看）
- **共享目录**：`775`（所有者和组完全控制，其他只读）

## 五、注意事项

- 只有文件所有者或 `root` 可修改权限。
- 目录必须有 **执行权限（x）** 才能进入（`cd`），有 **读权限（r）** 才能列出内容（`ls`）。
- 修改权限时需谨慎，尤其是 `777` 权限（所有用户可读写执行，存在安全风险）。

通过 `ls -l` 命令可查看文件当前权限（如 `-rwxr-xr--` 表示所有者 `rwx`、组 `r-x`、其他 `r--`）。
