# dumpsys命令

`dumpsys` 是 Android 系统提供的一个调试工具，用于输出系统服务（System Services）的状态信息。通过它可以获取设备运行时的各种详细数据（如内存、电池、Activity 堆栈等）。以下是 `dumpsys` 的常用命令和功能说明：

---

## **基本语法**

```bash
adb shell dumpsys [服务名] [选项]
```

- 不指定服务名时，会列出所有系统服务的信息（内容非常庞大）。
- 指定服务名时，仅输出该服务的相关信息。
- 支持通过 `--help` 查看特定服务的选项（部分服务支持）。

---

## **常用服务列表**

以下是常见的服务名称及其用途：

| **服务名**                  | **功能说明**                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| `activity`                 | Activity 管理器信息，包括当前 Activity 堆栈、任务、进程等。                 |
| `window`                   | 窗口管理器信息，包括窗口层级、焦点状态等。                                   |
| `meminfo`                  | 内存使用情况（按进程或全局统计）。                                           |
| `battery`                  | 电池状态（电量、充电状态、健康状态等）。                                     |
| `power`                    | 电源管理状态（唤醒锁、省电模式等）。                                         |
| `cpuinfo`                  | CPU 使用率统计。                                                            |
| `diskstats`                | 磁盘 I/O 统计信息。                                                         |
| `package`                  | 应用包信息（安装包、权限、版本等）。                                         |
| `notification`             | 通知栏信息（当前显示的通知）。                                               |
| `alarm`                    | 定时任务（Alarm）信息。                                                     |
| `wifi`                     | Wi-Fi 连接状态、配置信息等。                                                |
| `telephony.registry`       | 电话状态（信号强度、网络类型等）。                                           |
| `input`                    | 输入事件（触摸、按键等）的状态。                                             |
| `sensor`                   | 传感器状态（传感器列表、数据流等）。                                         |
| `gfxinfo`                  | 图形渲染性能数据（帧率、渲染时间等）。                                       |
| `surfaceflinger`           | SurfaceFlinger（图形合成器）状态。                                           |
| `content`                  | Content Provider 的详细信息。                                               |
| `procstats`                | 进程运行时间统计（后台/前台运行时间）。                                      |
| `usagestats`               | 应用使用情况统计（最近使用时间等）。                                         |
| `netstats`                 | 网络流量统计（按 UID 或全局）。                                             |
| `bluetooth_manager`        | 蓝牙服务状态。                                                              |

---

## **常用命令示例**

1. **查看当前 Activity 堆栈**  

   ```bash
   adb shell dumpsys activity activities | grep "ResumedActivity"
   # 或
   adb shell dumpsys activity top
   ```

2. **查看内存使用情况**  

   ```bash
   adb shell dumpsys meminfo [包名]  # 指定应用
   adb shell dumpsys meminfo         # 所有进程
   ```

3. **查看电池状态**  

   ```bash
   adb shell dumpsys battery
   ```

4. **查看当前通知**  

   ```bash
   adb shell dumpsys notification | grep "NotificationRecord"
   ```

5. **查看应用安装信息**  

   ```bash
   adb shell dumpsys package [包名]
   ```

6. **查看 Wi-Fi 状态**  

   ```bash
   adb shell dumpsys wifi
   ```

7. **查看 GPU 渲染性能**  

   ```bash
   adb shell dumpsys gfxinfo [包名]
   ```

8. **查看电源管理状态（唤醒锁）**  

   ```bash
   adb shell dumpsys power | grep "Wake Locks"
   ```

9. **查看传感器列表**  

   ```bash
   adb shell dumpsys sensorservice
   ```

10. **查看输入事件状态**  

    ```bash
    adb shell dumpsys input
    ```

---

## **高级用法**

1. **过滤输出内容**  
   使用 `grep` 或其他工具过滤结果（需支持 BusyBox 或类似环境）：  

   ```bash
   adb shell dumpsys activity | grep "mFocusedActivity"
   ```

2. **输出到文件**  
   将结果保存到本地文件：  

   ```bash
   adb shell dumpsys meminfo > meminfo.txt
   ```

3. **查看所有可用服务**  

   ```bash
   adb shell dumpsys -l
   ```

4. **获取服务帮助信息**  
   部分服务支持 `--help` 选项：  

   ```bash
   adb shell dumpsys activity --help
   ```

---

## **注意事项**

- **权限限制**：部分服务需要 `root` 权限或系统级权限才能访问完整信息。
- **版本差异**：不同 Android 版本支持的 `dumpsys` 服务可能有所不同。
- **数据量**：直接运行 `dumpsys` 会输出大量信息，建议结合具体服务名和过滤命令使用。

如果需要更详细的信息，可以参考 [Android 官方文档](https://developer.android.com/studio/command-line/dumpsys) 或通过 `adb shell dumpsys --help` 查看帮助。
