# requestFocus 在触摸模式失效

当 `focusableInTouchMode` 设为 `false` 时，**在触摸模式下**，View 确实可能无法通过 `requestFocus()` 获得焦点，但在**非触摸模式**（如鼠标、遥控器操作）下仍可能正常获取焦点。这与 Android 的「焦点模式」设计有关：

## 原因解析

Android 存在两种「焦点模式」：

1. **触摸模式（Touch Mode）**  
   当用户通过触摸屏幕交互时，系统会进入触摸模式。此时，默认情况下：
   - 只有 `focusableInTouchMode = true` 的 View 才能通过 `requestFocus()` 获取焦点。
   - 若 `focusableInTouchMode = false`，即使 `focusable = true`，`requestFocus()` 也会返回 `false`（获取焦点失败）。

2. **非触摸模式（Non-Touch Mode）**  
   当用户通过非触摸设备（如鼠标、遥控器）交互时，系统处于非触摸模式：
   - 只要 `focusable = true`，无论 `focusableInTouchMode` 是否为 `true`，`requestFocus()` 都能正常工作。

## 验证示例

假设有一个 Button 在 XML 中配置为：

```xml
<Button
    android:id="@+id/myButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:focusable="true"
    android:focusableInTouchMode="false" />  <!-- 关键设置 -->
```

在代码中调用：

```java
Button button = findViewById(R.id.myButton);
boolean result = button.requestFocus();
Log.d("FocusTest", "焦点获取结果：" + result); // 触摸模式下返回 false
```

- **触摸模式**：`result` 为 `false`（无法获取焦点）。
- **非触摸模式**（如连接鼠标并移动到按钮上）：`result` 为 `true`（可获取焦点）。

## 解决方案

若需要在**触摸模式**下让 View 能通过 `requestFocus()` 获取焦点，必须同时满足：

```xml
<View
    android:focusable="true"
    android:focusableInTouchMode="true" />  <!-- 必须设为 true -->
```

或在代码中动态设置：

```java
view.setFocusable(true);
view.setFocusableInTouchMode(true);
view.requestFocus(); // 此时可成功获取焦点
```

## 总结

`focusableInTouchMode = false` 会导致 View 在**触摸模式**下无法通过 `requestFocus()` 获取焦点，但不影响非触摸模式。这是 Android 为了优化触摸交互体验的设计（避免触摸后焦点残留影响后续操作）。若需在触摸场景下强制获取焦点，必须将 `focusableInTouchMode` 设为 `true`。
