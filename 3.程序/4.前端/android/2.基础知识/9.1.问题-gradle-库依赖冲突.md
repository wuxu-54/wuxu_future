# 库依赖冲突

在Android开发中，本地组件与依赖库冲突是一个常见的问题。以下是一些解决冲突的方法：
>android也是使用maven仓库（后端-javaweb章节有讲），规则同maven仓库依赖规则一样，但具体api使用上有区别。

1. **引入时剔除冲突库**：在引入依赖时，可以使用`exclude`关键字来排除特定的库。例如，如果你的项目已经包含了一个版本的`okhttp`，而引入的新库也包含了不同版本的`okhttp`，你可以在引入新库时排除`okhttp`：

   ```groovy
   implementation('com.ezviz.sdk:ezuikit:2.2.1') {
       exclude group: 'com.squareup.okhttp3', module: 'okhttp'
   }
   ```

   这样可以确保只有你指定版本的`okhttp`被包含在项目中。

2. **全局删除冲突库**：在`build.gradle`文件中，可以全局排除特定的库，这样无论哪个模块尝试引入该库都会被排除：

   ```groovy
   configurations {
       all*.exclude group: 'org.hamcrest', module: 'hamcrest-core'
   }
   ```

3. **开启Multidex功能**：如果冲突是由于方法数超过65536限制导致的，可以通过开启Multidex来解决。在`build.gradle`中启用Multidex，并在`Application`类中初始化：

   ```groovy
   defaultConfig {
       multiDexEnabled true
   }
   dependencies {
       implementation 'com.android.support:multidex:1.0.1'
   }
   ```

   并在`Application`类中：

   ```java
   public class MyApplication extends Application {
       @Override
       public void onCreate() {
           super.onCreate();
           MultiDex.install(this);
       }
   }
   ```

4. **强制修改版本**：在项目的根目录`build.gradle`文件中，可以使用`resolutionStrategy`来强制使用特定版本的库：

   ```groovy
   configurations.all {
       resolutionStrategy.force 'com.squareup.okhttp3:okhttp:3.10.0'
   }
   ```

5. **使用Gradle脚本排除**：通过Grovvy脚本修改版本号解决冲突。在存在冲突的module中的`build.gradle`文件中加入以下代码：

   ```groovy
   configurations.all {
       resolutionStrategy.eachDependency { details ->
           def requested = details.requested
           if (requested.group == 'com.android.support') {
               if (!requested.name.startsWith("multidex")) {
                   details.useVersion '28.0.0'
               }
           }
       }
   }
   ```

6. **关闭依赖传递**：在引入依赖时，可以关闭传递依赖，这样就不会引入该库所依赖的其他库：

   ```groovy
   implementation('androidx.appcompat:appcompat:1.1.0-rc01') {
       transitive = false
   }
   ```

7. **替换Support库为AndroidX**：如果冲突的库是Support库，可以将所有Support库替换为AndroidX，并在`gradle.properties`中启用Jetifier：

   ```properties
   android.useAndroidX=true
   android.enableJetifier=true
   ```

8. **使用Version Catalogs**：通过`.toml`文件定义所有依赖项和版本信息，集中管理依赖版本，减少版本冲突的可能性。

这些方法可以帮助你解决Android本地组件与依赖库冲突的问题。根据具体情况选择合适的方法进行解决。
