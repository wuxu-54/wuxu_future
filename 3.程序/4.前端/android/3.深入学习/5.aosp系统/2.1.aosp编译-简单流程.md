# 编译AOSP

> 参考[AOSP编译博客](https://blog.csdn.net/y874961524/article/details/80725389)

1. 进入AOSP目录
2. 初始化编译环境（每次打开终端都需要）
     `source ./build/envsetup.sh`
3. 选择编译目标类型（每次打开终端都需要）
     `lunch 编译目标类型`  或 只写 `lunch` 选择编译目标编号

    编译目标类型对照表：

    |构建类型|用途|
    | -- | -- |
    |user|有限访问权限，主要用于发布正式产品，没有root跟调试权限|
    |userdebug|跟user类型类似，但多了root和debug调试权限|
    |eng|调试版本，拥有各种调试工具的开发版设置，拥有root和debug调试权限|

4. 使用make编译 `make -j8`  8是编译所用线程数，可以改
5. `emulator` 模拟器运行

编译后会在`./out/target/product/generic/` 生成一些img文件，可以烧录到手机中。其中 system.img,ramdisk.img,userdata.img 比较重要

## 局部编译

上述步骤2，修改成进入具体模块目录下，如进入setting目录就是编译设置模块。其余步骤不变

## 编译注意事项（待补充）

我是用Ubuntu系统，遇到一些问题：

1. 编译时直接被kill掉，Ubuntu系统日志打印：out of mememory
解：运行内存，需要扩展，否则不够用
2. out of space
编译物理内存，需要扩展，否则不够用

## 运行

1. 终端直接输入 `emulator` 命令
2. 如果没安装过，会提示你安装
3. 安装时，会有两个下载地址，选google那个（这里我遇到了坑，清华镜像会有404导致安装过程出现问题）
4. 如果安装过程中出现问题，按报错信息来解决，无法解决可以使用 `sudo apt-get --purge remove 软件名` 来卸载安装软件及配置信息，然后从步骤2重新开始安装。
