# 列表设置焦点

在 Android Compose 里，要为列表设置焦点，可借助 `Modifier.focusable()` 或者 `Modifier.requestFocus()`。下面为你介绍几种常见的设置焦点的情形：

## 1. 让列表整体获取焦点

要是你想让整个列表获得焦点，可在 `LazyColumn` 或者 `LazyRow` 上运用 `Modifier.focusable()`。

```kotlin
LazyColumn(
    modifier = Modifier
        .focusable() // 使列表能够获取焦点
        .fillMaxSize()
) {
    items(100) { index ->
        Text("Item $index", modifier = Modifier.padding(16.dp))
    }
}
```

## 2. 让列表中的特定项获取焦点

若要让列表里的某个特定项获取焦点，可在对应项的 `Modifier` 中使用 `Modifier.requestFocus()`。

```kotlin
@Composable
fun FocusableList() {
    val focusRequester = remember { FocusRequester() }
    val scope = rememberCoroutineScope()

    LazyColumn(
        modifier = Modifier.fillMaxSize()
    ) {
        items(100) { index ->
            val isItemToFocus = index == 5 // 假设我们想让第6项获取焦点

            Text(
                "Item $index",
                modifier = Modifier
                    .padding(16.dp)
                    .focusRequester(focusRequester)
                    .focusable()
                    .onGloballyPositioned {
                        // 当组件布局完成后请求焦点
                        if (isItemToFocus) {
                            scope.launch {
                                focusRequester.requestFocus()
                            }
                        }
                    }
            )
        }
    }
}
```

## 3. 使列表在加载完成后自动获取焦点

若希望列表在加载完成后自动获取焦点，可结合使用 `LaunchedEffect` 和 `FocusRequester`。

```kotlin
@Composable
fun AutoFocusList() {
    val focusRequester = remember { FocusRequester() }

    LazyColumn(
        modifier = Modifier
            .focusRequester(focusRequester)
            .focusable()
            .fillMaxSize()
    ) {
        items(100) { index ->
            Text("Item $index", modifier = Modifier.padding(16.dp))
        }
    }

    // 列表加载完成后请求焦点
    LaunchedEffect(Unit) {
        focusRequester.requestFocus()
    }
}
```

## 4. 处理焦点变化事件

你还能通过 `onFocusChanged` 来处理焦点变化事件。

```kotlin
Text(
    "Focusable Item",
    modifier = Modifier
        .focusable()
        .onFocusChanged { focusState ->
            if (focusState.isFocused) {
                // 获得焦点时的操作
            } else {
                // 失去焦点时的操作
            }
        }
)
```

## 关键要点

- 要让组件能够获取焦点，得使用 `Modifier.focusable()`。
- 若想主动请求焦点，可借助 `FocusRequester` 和 `Modifier.requestFocus()`。
- 推荐在 `LaunchedEffect` 或者 `onGloballyPositioned` 中请求焦点，以此保证组件已经完成布局。
- 对于复杂的焦点管理，建议搭配使用 `FocusManager` 和 `FocusRequester`。

你可以根据自己的实际需求，挑选合适的焦点设置方式。
