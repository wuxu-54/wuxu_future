# 实践问题总结

在README中的项目里有demo练习，学习期间遇到些问题

## 1.kotlin怎么配置

在app或module的build.gradle中设置：

```groovy
// app 和 lib 属性不同
def variants = null
if (project.android.hasProperty("applicationVariants")) {
    variants = project.android.applicationVariants
} else if (project.android.hasProperty("libraryVariants")) {
    variants = project.android.libraryVariants
}


variants.all { variant ->
    variant.outputs.all { output ->
        def fullName = ""
        output.name.tokenize('-').eachWithIndex { token, index ->
            fullName = fullName + (index == 0 ? token : token.capitalize())
        }

        JavaCompile javaCompile = variant.javaCompileProvider.get()
        javaCompile.doLast {
            println "--------------------------------"

            String[] javaArgs = ["-showWeaveInfo",
                                 "-1.8",
                                 "-inpath", javaCompile.destinationDir.toString(),
                                 "-aspectpath", javaCompile.classpath.asPath+":"+javaCompile.destinationDir.toString(),
                                 "-d", javaCompile.destinationDir.toString(),
                                 "-classpath", javaCompile.classpath.asPath+":"+javaCompile.destinationDir.toString(),
                                 "-bootclasspath", project.android.bootClasspath.join(File.pathSeparator)]
           println "ajc javaArgs: " + Arrays.toString(javaArgs)
            println "--------------------------------"

            String[] kotlinArgs = ["-showWeaveInfo",
                                   "-1.8",
                                   "-inpath", project.buildDir.path + "/tmp/kotlin-classes/" + fullName,
                                   "-aspectpath", javaCompile.classpath.asPath,
                                   "-d", project.buildDir.path + "/tmp/kotlin-classes/" + fullName,
                                   "-classpath", javaCompile.classpath.asPath,
                                   "-bootclasspath", project.android.bootClasspath.join(File.pathSeparator)]
           println "ajc kotlinArgs: " + Arrays.toString(kotlinArgs)

            println "--------------------------------"

            def wv = configurations.create("weaving")
            dependencies {
                weaving 'org.aspectj:aspectjtools:1.9.8'
            }

           try {
               javaexec {
                   classpath = wv
                   main = "org.aspectj.tools.ajc.Main"
                   args javaArgs //配置 java
               }
           } catch (Exception ignored) {
               println "java exec error :"+ignored.message
           }
           try {
               javaexec {
                   classpath = wv
                   main = "org.aspectj.tools.ajc.Main"
                   args kotlinArgs // 配置kotlin
               }
           } catch (Exception ignored) {
               println "kotlin java exec error :"+ignored.message
           }

        }
    }
}

```

## 2.kotlin与java无法互调（此问题暂时没有想到解决办法）

描述：经过测试，AspectJ仅在Java代码切入Java代码，koltin切入kotlin时生效。AspectJ不支持 java与kotlin混合调用，即：**java中切入到kotlin代码中** 或 **kotlin切入到java代码中**。
