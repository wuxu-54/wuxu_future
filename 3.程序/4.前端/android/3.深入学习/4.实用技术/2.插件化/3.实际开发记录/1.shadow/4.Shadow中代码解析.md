# Shadow中代码解析

## 通过限定名创建实例对象

这是一种常见的用法，这里主要是通过类的完全限定名，获取某个接口的实现类的实例对象，并通过传入的`Class<T>`将这个类强制为接口类型

```java
public <T> T getInterface(Class<T> clazz, String className) throws Exception {
    try {
        Class<?> interfaceImplementClass = loadClass(className);
        Object interfaceImplement = interfaceImplementClass.newInstance();
        return clazz.cast(interfaceImplement);
    } catch (ClassNotFoundException | InstantiationException
            | ClassCastException | IllegalAccessException e) {
        throw new Exception(e);
    }
}
```

例如：

```java
package com.wuxu;
interface A{}

package com.wuxu;
class A_Child implements A{}

A instance = getInterface(A.class,"com.wuxu.A_Child");//这就是上面代码的作用，通过完全限定名获取A_Child的实例，并强制为接口A类型
```

---

## gradle中的`signingConfig.initWith(buildTypes.debug.signingConfig)`

在Android的Gradle构建脚本（通常是`build.gradle`文件）中，`signingConfig`是用来配置APK签名信息的。签名是Android应用发布到Google Play或其他应用分发平台时的必需步骤，它确保了应用的完整性和来源的可信度。

当你看到`signingConfig.initWith(buildTypes.debug.signingConfig)`这样的代码时，它是在做以下几件事情：

1. **`signingConfig`**：这是定义在`android`块中的一个或多个配置对象，用于指定如何签名APK。每个`signingConfig`对象可以包含密钥库（keystore）的位置、密钥库的密码、密钥的别名、密钥的密码等信息。

2. **`initWith`**：这是一个方法，用于初始化一个`signingConfig`对象。它允许你基于另一个`signingConfig`对象来设置当前`signingConfig`的默认值。

3. **`buildTypes.debug.signingConfig`**：这是指`buildTypes`中定义的`debug`构建类型的签名配置。`buildTypes`定义了不同的构建变体（如`debug`和`release`），每个变体可以有自己的签名配置和其他构建设置。默认情况下，Android Studio会为`debug`构建类型自动生成一个签名配置，这个配置通常使用存储在用户目录下的默认debug keystore。

因此，`signingConfig.initWith(buildTypes.debug.signingConfig)`的意思是：将当前`signingConfig`的初始设置设置为与`debug`构建类型相同的签名配置。这在某些情况下很有用，比如当你想要为某个特定的构建变体（不是`debug`也不是`release`）使用与`debug`构建类型相同的签名配置时。

例如，如果你有一个名为`staging`的构建变体，并希望它使用与`debug`构建类型相同的签名配置，你可能会这样做：

```groovy
android {
    ...
    signingConfigs {
        staging {
            initWith(buildTypes.debug.signingConfig)
        }
    }
    ...
    buildTypes {
        staging {
            initWith(buildTypes.debug)
            matchingFallbacks = ['debug', 'release']
            signingConfig signingConfigs.staging
        }
    }
}
```

在这个例子中，`staging`构建变体将使用与`debug`构建类型相同的签名配置。注意，虽然这里使用了`debug`的签名配置，但在实际应用中，对于发布到生产环境或测试环境的构建变体，通常应该使用专门的keystore和签名配置来确保安全。
