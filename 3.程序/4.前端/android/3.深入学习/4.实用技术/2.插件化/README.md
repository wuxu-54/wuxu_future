# 插件化

插件化涉及很多Framework原理：apk安装、解析、包的管理、四大组件的启动调用、资源的获取加载、classLoader的原理、android中dex文件的加载替换合并、插桩技术。我们都需要掌握，因此本节内容比较多，且涉及系统源码的内容会放在【系统源码解析】目录中

## 早知道

需要提前学习：

1. gradle插件制作、使用
2. apk resource资源获取
3. app 冷、热启动流程
4. 四大组件加载、启动流程，生命周期配置。
5. 路由处理机制，仿web式页面跳转框架。

## 整体流程

1. class加载
2. resource加载
3. 四大组件调用
   - Activity
      - 方式1：hook  ，替换intent 瞒过系统，优点是入侵性低，无需特别复杂的代码。缺点是不够稳妥，容易受android版本迭代影响
      - 方式2：Activity ，增加接口标记，优点是稳定，不受android版本影响。缺点是入侵性高，开发时需要手动维护每个页面。（基于此，腾讯的shadow使用插桩技术，在编译时自动插桩，无需人工维护）
   - 其他三个组件，使用代理维护生命周期
