# 组件详细用法

## 通过 Prop 向子组件传递数据

使用Vue对象中的props属性，组件标签里可以有对应的attribute使用

例子：

```html
<script>
Vue.component('blog-post', {
  props: ['title'],//这个属性可以在标签中使用
  template: '<h3>{{ title }}</h3>' // 这里可以直接使用title，在组件中title是Attribute，在模版中作为值使用
})
</script>

<!-- 使用，这里title 对应vue对象里的props -->
<blog-post title="My journey with Vue"></blog-post> 
```

动态加载例子：

```html
<script>
new Vue({
  el: '#blog-post-demo',
  data: {
    posts: [
      { id: 1, title: 'My journey with Vue' },
      { id: 2, title: 'Blogging with Vue' },
      { id: 3, title: 'Why Vue is so fun' }
    ]
  }
})
</script>
<!-- 使用 -->
<!-- 这里就是循环设置此元素，title取的动态元素 -->
<blog-post
  v-for="post in posts"
  v-bind:key="post.id"
  v-bind:title="post.title"
></blog-post>
```

## 单个根元素

组件attribute过多时，可以直接接入一个对象属性。

例子：

```html
<script>
Vue.component('blog-post', {
  props: ['post'],
  template: `
    <div class="blog-post">
      <h3>{{ post.title }}</h3>
      <div v-html="post.content"></div>
    </div>
  `
})
</script>

<!--
    使用 

    现在，不论何时为 post 对象添加一个新的 property，它都会自动地在 <blog-post> 内可用。
-->
 
<blog-post
  v-for="post in posts"
  v-bind:key="post.id"
  v-bind:post="post"
></blog-post> 
```

---

## 组件事件

### 组件监听模版控件事件

`$emit(事件名, 事件值)` 模版控件使用此方法设置一个事件
`v-on:事件名` 组件可以像普通控件一样监听事件

例子：

```html
<!-- 使用button控件，$emit()方法定义一个事件 -->
<script>
Vue.component('blog-post', {
  props: ['post'],
  template: `
    <div class="blog-post">
      <h3>{{ post.title }}</h3>
      // 这里设置的事件是静态的 enlarge-text,也可设置为动态
      <button v-on:click="$emit('enlarge-text', 0.1)">
        Enlarge text
      </button>
      <div v-html="post.content"></div>
    </div>
  `
})
</script>

<!-- 组件监听事件 -->
<blog-post
  v-on:enlarge-text="postFontSize += $event（这是个表达式，也可以写函数）"
></blog-post>

```

### 组件事件与v-model

组件中v-model的使用需要特殊处理

普通控件使用v-model：

```html
<!-- 普通控件使用v-model -->
<input v-model="searchText">

<!-- 等价于下面 -->
<input
  v-bind:value="searchText"
  v-on:input="searchText = $event.target.value"
>
```

上述普通控件代码，变成组件使用v-model：

```html
<!-- 普通控件使用v-model -->
<input v-model="searchText">

<!-- 组件使用v-model -->
<custom-input
  v-bind:value="searchText"
  v-on:input="searchText = $event"
></custom-input>

```

为保证组件可使用v-model标签,这个组件内的 `<input>` 必须：

* 将组件的 `value` attribute 绑定到模版中一个名叫 `value` 的 prop 上
* 在其 `input` 事件被触发时，将新的值通过自定义的 `input` 事件抛出

```html
<custom-input v-model="searchText"></custom-input>
<script>
Vue.component('custom-input', {
  props: ['value'],// 这里是个细节，之前没讲，自定义组件的props 可以在模版中作为值引用
  template: // v-bind:value="value" 这个值value，其实就是定义的prop
  `
    <input
      v-bind:value="value"
      v-on:input="$emit('input', $event.target.value)"
    >
  `
})
</script>
```

总结：组件 `v-model` 双向绑定，涉及事件，组件想使用，在其内部模版里，必须设置一个事件方法对组件发送事件。

---

## 插槽

`<slot>` 起到占位作用，顾名思义，组件设定有控件，会安置到模版`slot`位置处,就像插入一个插槽中，且按顺序匹配，如果没有设置slot，则会丢弃内容。

例子：

```html
<script>
Vue.component('alert-box', {
  template: `
    <div class="demo-alert-box">
      <strong>Error!</strong>
      //这里123 是默认值，如果没有东西插入，默认展示这个
      <slot>123</slot>
    </div>
  `
})
</script>

<!-- 
    使用
    组件内的 div控件，最终会放在组件template slot处，按顺序匹配，如果模版中没有配置slot，丢弃组件内容
-->
<alert-box>
    <div><div>
</alert-box>
```
