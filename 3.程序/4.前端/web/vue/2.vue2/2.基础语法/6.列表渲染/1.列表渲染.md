# 列表渲染

`v-for` 批量渲染

## `v-for`

可以用 `v-for` 指令基于一个数组来渲染一个列表。使用 item in items 形式的特殊语法，其中 items 是源数据数组，而 item 则是被迭代的数组元素的别名。

例子：

```html
<ul id = "test">
    <!-- 写法1 item是数组的元素-->
    <li v-for="item in items" :key="item.message"></li> 

     <!-- 写法2 支持第二个参数，数组索引-->
    <li v-for="(item, index) in items" :key="item.message"></li> 

    <!-- 可以访问所有父作用域的元素 -->
    <li v-for="item in items">
        {{parentMessage}}
    </li> 
</ul>

<script>
new Vue({
    el:'#test'
    data:{
         parentMessage: 'Parent',
        items:[
            {message:'A'},
            {message:'B'},
        ]
    }
})
</script>
```

### 遍历对象属性

v-for可以遍历对象的属性

```html
<ul id="v-for-object">
  <li v-for="value in object">
    {{ value }}
  </li>

    <!-- 支持第二个参数，属性名 -->
   <li v-for="(value,name) in object">
    {{ value }},
    {{ name }}
  </li>


     <!-- 支持第三个参数，索引 -->
   <li v-for="(value,name,index) in object">
    {{ value }},
    {{ name }},
    {{ index }},
  </li>
</ul>

<script>
new Vue({
  el: '#v-for-object',
  data: {
    object: {
      title: 'How to do lists in Vue',
      author: 'Jane Doe',
      publishedAt: '2016-04-10'
    }
  }
})
</script>
```

注意：

在遍历对象时，会按 `Object.keys()` 的结果遍历，但是不能保证它的结果在不同的 JavaScript 引擎下都一致。

---

## 维护状态

当 Vue 正在更新使用 v-for 渲染的元素列表时，它默认使用“就地更新”的策略。如果数据项的顺序被改变，Vue 将不会移动 DOM 元素来匹配数据项的顺序，而是就地更新每个元素，并且确保它们在每个索引位置正确渲染。

这个默认的模式是高效的，但是**只适用于不依赖子组件状态或临时 DOM 状态 (例如：表单输入值) 的列表渲染输出。**

为了给 Vue 一个提示，以便它能跟踪每个节点的身份，从而重用和重新排序现有元素，你需要为每项提供一个唯一 key attribute：

```html
<div v-for="item in items" v-bind:key="item.id">
  <!-- 内容 -->
</div>
```

>建议使用`v-for`,设定key属性
>不要使用对象或数组之类的非基本类型值作为 v-for 的 key。请用字符串或数值类型的值。

---

## `key`指令

在Vue 2中，`:key` 是一个非常重要的指令，主要用于管理可复用的元素或组件的渲染行为。当Vue.js用`v-for`指令渲染一个元素列表时，默认情况下，Vue会尽量高效地更新DOM。这意味着Vue会尝试复用现有元素，而不是销毁它们并重新创建。但是，在某些情况下，这种默认行为可能会导致渲染问题，比如列表的渲染顺序改变时，Vue可能会复用错误的元素，导致渲染结果不符合预期。

这时，`:key` 指令就派上用场了。`:key` 指令的值应该是每个节点的唯一标识，通常是一个字符串或数字，但在Vue 2中，更推荐使用字符串或字符串的复合形式，以确保唯一性。

### 使用场景

- **列表渲染**：当使用`v-for`指令渲染一个元素列表时，应该为每个列表项提供一个唯一的`:key`值。
- **条件渲染**：虽然`:key`主要用于`v-for`，但在某些复杂的条件渲染场景中，它也可以帮助Vue更准确地追踪节点的身份，尽管这种情况较少见。

### 好处

- **提高渲染效率**：通过为每个节点提供一个唯一的`key`，Vue能够更准确地跟踪节点的身份，从而更有效地复用和重新排序现有元素。
- **避免渲染问题**：在列表渲染中，使用`:key`可以避免因Vue复用错误元素而导致的渲染问题。

### 示例

```html
<template>
  <ul>
    <li v-for="item in items" :key="item.id">
      {{ item.text }}
    </li>
  </ul>
</template>

<script>
export default {
  data() {
    return {
      items: [
        { id: 1, text: 'Item 1' },
        { id: 2, text: 'Item 2' },
        // ...
      ],
    };
  },
};
</script>
```

在这个例子中，每个`<li>`元素都被赋予了一个唯一的`:key`值（即`item.id`），这有助于Vue更准确地追踪每个列表项的身份，并在数据变化时高效地更新DOM。
