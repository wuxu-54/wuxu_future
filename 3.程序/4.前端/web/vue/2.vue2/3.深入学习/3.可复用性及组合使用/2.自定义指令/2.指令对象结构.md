# 指令对象结构

定义时结构：

`指令名:{钩子函数(element,binding){}}`

## 指令对象中的钩子函数

1. `bind`：指令与元素成功绑定时调用。
2. `inserted`：指令所在元素被插入页面时调用。
3. `update`：指令所在模板结构被重新解析时调用。
4. `componentUpdated`：指令所在组件的 VNode 及其子 VNode 全部更新后调用。
5. `unbind`：只调用一次，指令与元素解绑时调用。

### 钩子函数参数

* `el`：指令所绑定的元素，可以用来直接操作 DOM。
* `binding`：一个对象，包含以下 property：
    1. `name`：指令名，不包括 `v-` 前缀。
    2. `value`：指令的绑定值，例如：`v-my-directive="1 + 1"` 中，绑定值为 `2`。
    3. `oldValue`：指令绑定的前一个值，仅在 `update` 和 `componentUpdated` 钩子中可用。无论值是否改变都可用。
    4. `expression`：字符串形式的指令表达式。例如 `v-my-directive="1 + 1"` 中，表达式为 `"1 + 1"`。
    5. `arg`：传给指令的参数，可选。例如 `v-my-directive:foo` 中，参数为 `"foo"`。
    6. `modifiers`：一个包含修饰符的对象。例如：`v-my-directive.foo.bar` 中，修饰符对象为 `{ foo: true, bar: true }`。
* `vnode`：Vue 编译生成的虚拟节点。（Vue有虚拟Dom，dom中的节点就是虚拟节点，用于与旧节点通过patch算法做对比更新视图）
* `oldVnode`：上一个虚拟节点，仅在 `update` 和 `componentUpdated` 钩子中可用。

注意：

1. 除了 `el` 之外，其它参数都应该是只读的，切勿进行修改。如果需要在钩子之间共享数据，建议通过元素的 `dataset` 来进行。
2. 指令函数能够接受所有合法的 JavaScript 表达式。如果指令需要多个值，可以向指令的绑定值传入一个 JavaScript 对象字面量。例子：

    ```html
    <div v-demo="{ color: 'white', text: 'hello!' }"></div>
    <script>
    Vue.directive('demo', function (el, binding) {
    console.log(binding.value.color) // => "white"
    console.log(binding.value.text)  // => "hello!"
    })
    </script>
    ```

## 函数简写

在很多时候，你可能想在 `bind` 和 `update` 时触发相同行为，而不关心其它的钩子。可以简写：

```javascript
Vue.directive('color-swatch', function (el, binding) {
  el.style.backgroundColor = binding.value
})
```
