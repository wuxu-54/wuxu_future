# 1. 组件访问

这里有几种组件访问的方式

## 1.1 访问根组件实例

方式：通过`$root`属性，子组件可以直接访问到根。

调用：子组件中使用`this.$root.根组件内容`
>不推荐使用原因：这样使用固然方便，但耦合度太高

---

## 1.2 访问父级组件实例

同根组件实例访问方式类似，把root换成parent，通过`$parent`属性，子组件可以访问父组件内容

调用：子组件中使用`this.$parent.根组件内容`
>不推荐原因：耦合度高，同时，多个组件嵌套使用，最内部的组件单使用`$parent`访问多层外的祖宗组件，会导致使用链调用过长，如：`this.$parent.$parent.data`

基于上述信息，需要想深层组件提供数据时，推荐使用`依赖注入`方式

---

## 1.3 访问子组件实例或元素

使用`ref`属性，给子组件设定id，这个id就是子组件实例的引用。  

调用：父组件`this.refs.设定的ID`
>这里补充个`refs`属性,这个属性是个集合，只在组件渲染完成后生效，其持有所有子组件的实例ID，且不是响应式，所以避免使用访问`$refs`  
>不推荐原因：`$refs` 组件渲染完成后生效，且不是响应式。

* 用在普通DOM标签上，获取的是DOM节点
* 用在组件标签上，获取的是组件实例对象

### 使用场景

1. 引用DOM元素：当你需要直接访问或操作DOM元素时，可以使用ref来获取该元素。
2. 引用子组件：如果你需要与子组件进行交互，可以通过ref来访问子组件的实例。

### 注意事项

* `$refs`是非响应式的。这意味着你应该避免在计算属性或侦听器中使用`$refs`。
* 由于`$refs`是指向DOM元素或组件实例的直接引用，因此在使用它们时应该小心，以避免内存泄漏或意外修改DOM。- 在组件的`mounted`钩子函数中，你可以确保所有的DOM元素和子组件都已经被渲染和挂载，这时使用`$refs`是安全的。

---

## 1.4 依赖注入

`provide` 和 `inject` 两个属性，实现当前组件向深层子组件提供数据，也就是上面`1.2 访问父级组件实例`节点描述的情况的推荐解决方式。
> 依赖注入也会增加耦合性，同时也非响应式。

调用：当前组件使用`provide`，子组件使用`inject`

官方例子：

```html
<google-map>
  <google-map-region v-bind:shape="cityBoundaries">
    <google-map-markers v-bind:places="iceCreamShops"></google-map-markers>
  </google-map-region>
</google-map>
<script>
      Vue.component("google-map", {
        provide: function() {
          return {
            getMap: this.getMap
          };
        },
        data: function() {
          return {
            map: null
          };
        },
        mounted: function() {
          this.map = new google.maps.Map(this.$el, {
            center: { lat: 0, lng: 0 },
            zoom: 1
          });
        },
        methods: {
          getMap: function(found) {
            var vm = this;
            function checkForMap() {
              if (vm.map) {
                found(vm.map);
              } else {
                setTimeout(checkForMap, 50);
              }
            }
            checkForMap();
          }
        },
        template: '<div class="map"><slot></slot></div>'
      });

      Vue.component("google-map-marker", {
        inject: ["getMap"],
        props: ["places"],
        created: function() {
          var vm = this;
          vm.getMap(function(map) {
            vm.places.forEach(function(place) {
              new google.maps.Marker({
                position: place.position,
                map: map
              });
            });
          });
        },
        render(h) {
          return null;
        }
      });

      new Vue({
        el: "#app",
        data: {
          vueConfCities: [
            {
              name: "Wroclaw",
              position: {
                lat: 51.107885,
                lng: 17.038538
              }
            },
            {
              name: "New Orleans",
              position: {
                lat: 29.951066,
                lng: -90.071532
              }
            }
          ]
        }
      });
</script>
```
