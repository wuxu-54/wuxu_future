# 插槽细解

前文组件基础中简单讲了下插槽概念：插槽相当于一个占位，组件标签内容在编译后会替换掉占位插槽。这里再细解下插槽。

## 编译作用域

>本知识属于学习插槽的前置知识。官方解释：**父级模板里的所有内容都是在父级作用域中编译的；子模板里的所有内容都是在子作用域中编译的。**

个人理解：vue编译时，对应组件有作用域限制，子组件与父组件的数据无法直接互相访问，子组件是子作用域、父组件是父作用域。

看下面例子及注释：

```html
  <!-- 这是父组件 ，ttt是子组件-->
  <div id="test">
    <!-- 正常：因为属于父组件作用域，可以获取父组件的数值即Vue对象中的data数据 -->
    <ttt :url1='parentData'>parentData:{{parentData}}</ttt>

    <!-- 报错: 属于父组件作用域，无法获取组件内部即子组件作用域中的data数据 -->
    <ttt url1="1">childData:{{childData}}</ttt>
  </div>
  <script>
    Vue.component('ttt', {
      props: ['url1'],
      data:function(){
        return {
          childData:'222'
        }
      },
      template:
        `<div>
       ppp= {{url1}},
       parent={{parentData}} ,//这里报错，因为此处属于子组件作用域，无法直接使用父组件作用域中的数据
       <slot></slot>
    </div>
    `
    })

    new Vue({
      el: "#test", //组件元素绑定
      data:{
        parentData:'111'
      }
    })

  </script>
```

---

## 插槽默认内容

组件包裹的内容，就是`插槽内容`。插槽默认内容指：在组件没有写内容时，template写的默认内容，其只会在组件没有提供内容的时候被渲染。

例子：

```javascript
Vue.component({
  templates:`
    <div>
    <slot>11111</slot>
    </div>
  `
})
```

上述中的插槽，在组件没有插槽内容时会默认展示一个文本：11111

## 具名插槽

定义：插槽使用 name 属性，例子：`<slot name="header"></slot>`。
>非具名插槽默认名：`default` 所以使用时如果不指名，都会按顺序插入非具名插槽中

使用：在`<template>`元素上使用`v-slot`指令，并将`命名`作为值（可动态命名）,如上面的header。

例子：

```html
<!-- 组件 template -->
<div class="container">
  <header>
    <slot name="header"></slot>
  </header>
  <main>
    <slot></slot>
  </main>
  <footer>
    <slot name="footer"></slot>
  </footer>
</div>

<!-- 使用时 -->
<base-layout>
  <template v-slot:header>
    <h1>这里替换 header 插槽</h1>
  </template>

  <p>A paragraph for the main content.</p>
  <p>And another one.</p>

  <template v-slot:footer>
    <p>Here's some contact info</p>
  </template>
</base-layout>
```

### 缩写（2.6.0新增）

`v-slot:` 可以替换为 `#`,注意必须要有名字

例子：

```html
<!-- 非具名，后面跟default -->
<current-user #default="{ user }">
  {{ user.firstName }}
</current-user>

<!-- 具名，header -->
<current-user #header="{ user }">
  {{ user.firstName }}
</current-user>

<!-- 无效 -->
<current-user #="{ user }">
  {{ user.firstName }}
</current-user>

```

---

## 作用域插槽

作用：父组件作用域可以访问子组件定义的数据
使用：插槽标签中使用`v-bind:属性名="子组件中的数据"` 进行数据关联，这种插槽就是作用域插槽。 这个属性名被称为`插槽prop`

案例:[作用域插槽演示](7.%E6%8F%92%E6%A7%BD-%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD%E6%BC%94%E7%A4%BA.html)

### 独占默认插槽的缩写语法

独占默认插槽：作用域插槽、且是非具名作用域插槽，就是【独占】默认插槽。

按上面案例举例，这种插槽可以有缩写：

原：

```javascript
<demo>
    <template v-slot:default="slotProps">
        {{slotProps.user1.newData}}
    </template>
</demo>
```

缩写后：

```javascript
<demo v-slot:default="slotProps">
    {{slotProps.user1.newData}}
</demo>
```

进一步简写：

```javascript
<demo v-slot="slotProps">
    {{slotProps.user1.newData}}
</demo>
```

注意：

不可与具名插槽混用，因为会导致作用域不明确：

```javascript
<demo v-slot="slotProps">
    {{slotProps.user1.newData}}
    <template v-slot:other="otherSlotProps"></template>
</demo>
```

只要出现多个插槽，写带有template标签完整的插槽语法。

### 解构插槽Prop

作用域插槽原理：插槽内容会被包裹在*单参数的函数*中：`function(插槽对象){ 插槽内容 }`
解构插槽Prop：即插槽对象完全遵循函数参数的各种规则，传给插槽内容，：

```javascript
// 解构，同函数参数
<current-user v-slot="{ user }">
  {{ user.firstName }}
</current-user>

// 插槽对象重命名，同函数参数
<current-user v-slot="{ user: person }">
  {{ person.firstName }}
</current-user>

// 默认值（后备内容），同函数参数
<current-user v-slot="{ user = { firstName: 'Guest' } }">
  {{ user.firstName }}
</current-user>
```

---

### 被废弃的api（知道即可）

`slot` 和 `slot-scope`
>`v-slot` 2.6.0被引入，用于替换这里api

slot：接收父组件内容（同上面学的Attribute : `name` ）  
slot-scope ：作用域（同上面学的作用域插槽）
