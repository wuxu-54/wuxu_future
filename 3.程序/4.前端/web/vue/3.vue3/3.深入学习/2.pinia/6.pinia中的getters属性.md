# getters属性

Pinia中，getters是一种特殊的属性，它们被用来从store的状态（state）中派生出一些新的值。这些值是响应式的，意味着当原始状态发生变化时，依赖于这些状态的getters也会自动更新。

Getters的使用方法和计算属性非常相似，它们提供了一种简洁的方式来访问和操作store中的数据。
>简单理解：Getters属性其实就是依赖于已定义的`state`，定义了一个新的属性。

## 定义Getters

Getters可以在定义store的时候通过getters属性来声明。它们接收state作为第一个参数，推荐使用箭头函数来定义，这样可以避免绑定this上下文的问题。

```js
export const useCounterStore = defineStore('counter', {
  state: () => ({ count: 0 }),
  getters: {
    doubleCount: (state) => state.count * 2,
  },
});
```

## 访问Getters

在组件中，你可以直接通过store实例访问getters，就像访问state属性一样。

```js
<template>
  <p>Double count is: {{ store.doubleCount }}</p>
</template>

<script setup>
import { useCounterStore } from './counterStore';
const store = useCounterStore();
</script>
```

## Getters与State关系

Getters通常只依赖于state，但有时也可能需要使用其他getters。在定义普通函数时，可以通过this访问到整个store实例。不过，如果使用箭头函数定义getter，就不需要担心this的问题。

## Getters的参数

需要注意的是，**getters不能像普通函数那样传递参数**。它们是幕后的计算属性，所以不能向它们传递任何参数。但是，你可以从getter返回一个函数，这个函数可以接受任意参数。

```js
export const useUserListStore = defineStore('userList', {
  getters: {
    getUserById: (state) => (userId) => {
      return state.users.find((user) => user.id === userId);
    },
  },
});

```

在组件中使用时，你需要通过storeToRefs来访问getter函数，并使用`.value`来调用它。

```js
<script setup>
import { useUserListStore } from './store';
const userList = useUserListStore();
const { getUserById } = storeToRefs(userList);
</script>

<template>
  <p>User 2: {{ getUserById.value(2) }}</p>
</template>
```

## Getters的组合使用

与计算属性一样，你可以组合多个getters来创建更复杂的逻辑。

```js
export const useCounterStore = defineStore('counter', {
  state: () => ({ count: 0 }),
  getters: {
    doubleCount: (state) => state.count * 2,
    doubleCountPlusOne: () => {
      return this.doubleCount + 1;
    },
  },
});
```

## 使用TypeScript时的注意事项

1. 使用箭头函数定义的getter，TypeScript可以自动推断出返回类型。
2. 普通函数定义getter，并且需要通过this访问其他getter或state时，就需要明确设置返回类型。

```js
export const useCounterStore = defineStore('counter', {
  state: () => ({ count: 0 }),
  getters: {
    doubleCount: (state: { count: number }) => {
      return state.count * 2;
    },
    doublePlusOne: (): number => {
      return this.doubleCount + 1;
    },
  },
});
```

## 与其他Store的Getters交互

如果你想在一个store的getter中使用另一个store的getter，可以直接通过导入并使用该store来实现。

```js
import { useOtherStore } from './other-store';
export const useMainStore = defineStore('main', {
  state: () => ({ localData: 0 }),
  getters: {
    combinedGetter(state) {
      const otherStore = useOtherStore();
      return state.localData + otherStore.data;
    },
  },
});
```
