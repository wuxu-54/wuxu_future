# pinia常用修改数据方式

在 Pinia 中，修改数据通常涉及到操作 state 中的属性或者调用 actions 中定义的方法。以下是 Pinia 中修改数据的一些常见方式：

## 1. 直接修改 state 属性

在 state 对象中直接修改属性是最简单的方式。这通常在 actions 或 setup 函数中完成，因为这些属性是响应式的，可以直接修改。

```js
// 在定义 Store 时
export const useMyStore = defineStore('myStore', {
  state: () => ({
    message: 'Hello'
  }),
  actions: {
    updateMessage(newMessage) {
      this.message = newMessage;
    }
  }
});

// 在组件中使用
const myStore = useMyStore();
myStore.updateMessage('Goodbye');
```

## 2. 使用 actions 修改数据

actions 是 Store 中定义的方法，可以用来封装修改 state 的逻辑。它们可以是同步或异步的，并且可以触发视图更新。

```js
// 在定义 Store 时
export const useMyStore = defineStore('myStore', {
  state: () => ({
    count: 0
  }),
  actions: {
    increment() {
      this.count++;
    }
  }
});

// 在组件中使用
const myStore = useMyStore();
myStore.increment();
```

## 3. 使用 reactive 或 ref 来修改数据

虽然 Pinia 内部使用 reactive 来处理 state，但通常不需要直接使用 reactive 或 ref 来修改数据。Pinia 提供的 state 和 actions 已经足够处理大多数情况。

## 4. 使用自带方法

在某些情况下，如果你需要更新多个属性或者整个 state 对象，可以使用自带API方法。这些方法允许你传递一个新状态对象或一个函数来计算新状态。

1. update：设置某个数据

    ```js
    // 在定义 Store 时
    export const useMyStore = defineStore('myStore', {
    state: () => ({
        user: { name: 'John', age: 30 }
    }),
    actions: {
        updateUser(newUserData) {
        this.update((state) => {
            state.user = newUserData;
        });
        }
    }
    });

    // 在组件中使用
    const myStore = useMyStore();
    myStore.updateUser({ name: 'Jane', age: 25 });
    ```

2. $patch：批量修改state

    ```js
    import { useStore } from "./store";

    const user = useStore();
    const change = () => {
    //可以批量修改属性
    user.$patch({
        name: "小黑",
        age: 20,
    });
    }; 
    //$patch 方法也接受一个函数来批量修改
    const change = () => {
    user.$patch((state)=>{
        state.name = '小黑'
        state.age = 20
    })
    };
    ```

3. 可以通过将其 `$state` 属性设置为新对象来替换 Store 的整个状态

    ```js
    import { useStore } from "./store";

    const user = useStore();
    const change = () => {
        //直接替换整个state对象
    user.$state = {
        name: '小黑',
        age: 20
    }
    };
    ```

在 Pinia 中，state 和 actions 是修改数据的主要方式。state 是响应式的，所以任何对 state 的修改都会自动反映到视图上。actions 则提供了一个封装异步逻辑和复杂更新逻辑的地方。通过这些方法，你可以灵活地管理 Store 中的数据。
