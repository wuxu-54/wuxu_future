# 路由规则props的配置与接收

在Vue 3中，通过Vue Router配置路由规则时，可以将特定的数据作为props传递给路由组件。这些数据可以是路由参数、查询参数或者静态数据。在组件中接收这些props后，可以更加灵活地构建页面。以下是关于Vue 3路由规则的props配置与接收的详细说明。

## 路由规则中的props配置

## 默认的动态路由参数接收

动态路由参数使用`:param`来定义,默认使用params对象接收：

在路由的组件中，动态参数可以通过`this.$route.params`对象来访问。

```js
export default {
  created() {
    console.log(this.$route.params.id); // 假设路由路径是 /item/:id
  }
};
```

### 布尔模式（Boolean Mode）

当props选项设置为true时，路由的params将作为组件的props传递给组件。这种方式简单直接，但会将所有路由参数作为props传递，可能会导致不必要的数据传递。

```javascript
const routes = [
  {
    path: '/user/:id',
    component: UserComponent,
    props: true // route.params 作为组件的 props
  },
];
```

### 对象模式（Object Mode）

当props选项是一个对象时，这个对象将原样作为组件的props。这种方式适用于传递一些静态数据或者不需要动态变化的值。

```javascript
const routes = [
  {
    path: '/promotion',
    component: PromotionComponent,
    props: { newsletterPopup: false } // 静态对象作为组件的 props
  },
];
```

### 函数模式（Function Mode）

props选项可以是一个函数，该函数接收当前路由的route对象作为参数，并返回一个对象，这个对象的键值对将作为组件的props。这种方式最为灵活，允许你根据路由的不同动态生成props。

```javascript
const routes = [
  {
    path: '/search',
    component: SearchComponent,
    props: (route) => ({ query: route.query.q }) // 动态生成 props
  },
];
```

## 组件中接收props

在组件中，可以通过props选项声明来接收从路由传递过来的数据。这些数据将作为组件的属性可用。

```javascript
export default {
  props: ['id', 'query'], // 声明接收的 props
  setup(props) {
    // 使用 props 中的数据
    console.log(`User ID: ${props.id}`);    console.log(`Search Query: ${props.query}`);
  },
};
```

注意，上述示例，setup语法糖写法中通过`defineProps`接收

## 注意事项

1. **避免过度耦合**：在组件中直接使用$route对象可能会导致组件与路由系统过度耦合，限制了组件的可重用性和灵活性。通过使用props，可以将组件与路由解耦，使得组件可以在不同上下文中使用。
2. **保持函数状态**：在使用函数模式时，应尽量保持返回props的函数为无状态的。这是因为该函数会在每次路由变化时被调用，如果有状态依赖，可能会导致不可预期的行为。
3. **性能考虑**：函数模式下的props函数会在每次路由变化时执行，如果有复杂的计算或状态操作，可能会影响性能。在这种情况下，考虑使用其他模式或适当地缓存计算结果。
4. **命名视图**：对于包含命名视图的路由，需要为每个命名视图单独配置props。通过以上配置和接收方式，Vue 3中的路由props提供了灵活的数据传递机制，使得组件可以更加高效地接收和使用路由数据。这不仅提高了组件的可重用性，也使得路由系统更加强大和灵活。
