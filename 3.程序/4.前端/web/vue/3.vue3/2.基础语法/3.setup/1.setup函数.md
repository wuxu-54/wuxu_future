# setup函数

Vue 3中的setup函数是Composition API的核心，它提供了一种在组件中使用响应式状态、计算属性、方法和生命周期钩子的新方式。setup函数在组件的创建过程中被调用，并且它的作用域是组件的实例。

以下是setup函数的一些关键特性：

1. 响应式状态（Reactive State）
2. 计算属性（Computed Properties）
3. 方法（Methods）
4. 生命周期钩子（Lifecycle Hooks）
5. Props
6. 返回值
7. 使用defineComponent和h

## 1. 响应式状态（Reactive State）

在setup函数中，你可以使用`ref`或`reactive`来创建响应式的数据。`ref`或`reactive`接收一个参数，该参数是响应式引用的值。

注意：

1. setup函数中，变量默认不是响应式的，需要使用`ref`、`reactive`对象设定为响应式。
2. 且无法使用this，其值是`undifined`。
3. 当同时使用选项式和组合式时，选项式中可以使用this访问到组合式中定义的变量，但反过来不行。

```javascript
import { ref,reactive} from 'vue';

export default {
  //这里可以指定组件名
  name:'newName',
  setup() {
    const count = ref(0);
    const count1 = reactive(1);
    return { count };
  }
};
```

## 2. 计算属性（Computed Properties）

使用computed来创建计算属性，它接收一个getter函数，并返回一个响应式的引用。

```javascript
import { ref, computed } from 'vue';

export default {
  setup() {
    const count = ref(0);
    const doubleCount = computed(() => count.value * 2);
    return { count, doubleCount };
  }
};
```

## 3. 方法（Methods）

在setup函数中定义的方法可以直接返回，它们将成为组件实例的一部分。

```javascript
export default {
  setup() {
    const increment = () => {
      count.value++;
    };
    return { increment };
  },
  // ...
};
```

## 4. 生命周期钩子（Lifecycle Hooks）

Vue 3提供了一系列的生命周期钩子函数，如onMounted、onUpdated等，它们可以直接在setup函数中调用。

```javascript
import { onMounted } from 'vue';

export default {
  setup() {
    onMounted(() => {
      console.log('Component is mounted!');
    });
    // ...
  }
};
```

## 5. Props

如果你的组件接收props，你可以在setup函数中访问它们。props是一个对象，其中包含了传递给组件的所有属性。

```javascript
export default {
  setup(props) {
    // 使用props
    console.log(props.message);
    return {};
  },
  props: {
    message: String
  }
};
```

## 6. 返回值

setup函数的返回值会被合并到组件实例中。你可以返回响应式数据、方法、计算属性等。

* setup的返回值可以在模板`template`中被使用；
* 可以通过setup的返回值来替代选项式api中的`data选项`；

```javascript
export default {
  setup() {
    const state = ref({ count: 0 });
    const methods = {
      increment() {
        state.value.count++;
      }
    };
    return { state, ...methods };
  }
};
```

## 7. 使用defineComponent和h

在Vue 3中，你还可以使用defineComponent来定义组件，并使用h函数来创建虚拟DOM节点。

```javascript
import { defineComponent, ref, h } from 'vue';

export default defineComponent({
  setup() {
    const count = ref(0);
    return () => h('div', { class: 'counter' }, [
      h('h1', 'Count is: ' + count.value),
      h('button', { onClick: () => count.value++ }, 'Increment')
    ]);
  }
});
```

## 总结

setup函数是Vue 3 Composition API的入口点，它提供了一种更加灵活和可组合的方式来组织和复用代码。通过使用setup函数，你可以更好地管理组件的状态和逻辑，同时保持代码的清晰和可维护性。
