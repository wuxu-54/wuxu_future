# Native Platform

原地址：<https://reactnative.dev/docs/next/native-platform>

## 概述

React Native 的 **原生平台（Native Platform）** 功能允许应用访问 React Native 框架或社区第三方库未直接提供的平台特性，或复用已有的 Objective-C、Swift、Java、Kotlin 或 C++ 原生代码。其核心通过 **原生模块（Native Modules）** 和 **原生组件（Native Components）** 实现 JavaScript 与原生代码的连接，扩展应用的功能边界。
>类似于Flutter中的插件

## 1. 核心概念：原生模块与原生组件

React Native 原生平台功能的两大核心组成部分：

### 1.1 原生模块（Native Modules）

- **定义**：无用户界面（UI）的原生库，通过 JavaScript 函数和对象的形式供应用调用，用于实现底层功能逻辑。  
- **典型应用场景**：
  - 持久化存储（如本地数据库操作）；
  - 通知功能（如推送通知的接收与处理）；
  - 网络事件（如自定义网络请求处理）等非 UI 相关的原生功能。  
- **跨平台支持**：
  - 基础支持 Android（Java/Kotlin）和 iOS（Objective-C/Swift）；
  - 可通过 C++ 实现跨平台原生模块，减少平台差异开发成本。  
- **高级特性**：支持自定义 C++ 类型，满足复杂数据交互需求。

### 1.2 原生组件（Native Components）

- **定义**：将原生平台的视图（Views）、控件（Widgets）和控制器（Controllers）封装为 React 组件，供 JavaScript 代码直接使用，扩展应用的 UI 能力。  
- **实现方式**：通过 **Fabric Native Components** 实现，Fabric 是 React Native 新架构中的 UI 渲染系统，提供更高效的原生组件集成方式。  
- **作用**：让 JavaScript 代码能够直接操作原生 UI 元素，充分利用平台特定的 UI 特性（如 iOS 的 `UIKit` 控件或 Android 的 `ViewGroup` 组件）。

## 2. 关于旧架构的说明

### 2.1  legacy 版本的 deprecation

网页明确指出，**旧版原生模块（Legacy Native Modules）** 和 **旧版原生组件（Legacy Native Components）** 已被废弃。这些旧 API 虽然目前仍可通过新架构的互操作层（interop layers）与新架构兼容，但不建议继续依赖。

### 2.2 迁移建议

对于依赖旧版原生功能的应用，建议采取以下措施：

- **使用替代库**：选择已支持新架构的第三方库替代旧版库；
- **升级库版本**：将现有库升级到对新架构有一等支持（first-class support）的版本；
- **自行迁移**：将旧版库手动迁移至新架构支持的 **Turbo Native Modules**（新架构原生模块）或 **Fabric Native Components**（新架构原生组件）。

## 3. 原生平台功能的分类与扩展方向

网页提及的原生平台功能扩展方向包括：

- **原生模块细分**：
  - Android & iOS 平台专属原生模块；
  - 基于 C++ 的跨平台原生模块；
  - 高级场景：自定义 C++ 类型的原生模块。
- **原生组件细分**：
  - Android & iOS 平台的 Fabric 原生组件（基于新架构的 UI 组件系统）。

## 原生平台功能工作流程（流程图）

```mermaid
graph TD
    A[应用需求场景] --> B{是否需要原生功能?}
    B -->|否| C[使用 React Native 框架或社区库]
    B -->|是| D{功能类型?}
    D -->|非 UI 功能| E[选择/开发 Native Modules]
    D -->|UI 组件功能| F[选择/开发 Native Components]
    E --> G{平台支持需求?}
    G -->|单平台| H[开发 Android(Java/Kotlin)或 iOS(Objective-C/Swift)原生模块]
    G -->|跨平台| I[开发 C++ 跨平台原生模块]
    F --> J[基于 Fabric 开发 Android/iOS 原生组件]
    E --> K[通过 JavaScript 调用原生模块 API]
    F --> L[通过 React 组件使用原生组件]
    K --> M[实现原生功能逻辑]
    L --> N[渲染原生 UI 元素]
    M --> O[应用功能扩展完成]
    N --> O
    note[注意：旧版原生功能需迁移至新架构] --> E
    note --> F
```

## 总结

React Native 的原生平台功能是扩展应用能力的关键，通过原生模块和原生组件连接 JavaScript 与原生代码，支持访问平台特性或复用原生代码。核心需区分无 UI 的原生模块（用于逻辑功能）和有 UI 的原生组件（用于界面元素），并注意旧版 API 的 deprecation 状态，优先采用新架构支持的 Turbo Native Modules 和 Fabric Native Components。跨平台需求可通过 C++ 实现原生模块，减少重复开发成本。
