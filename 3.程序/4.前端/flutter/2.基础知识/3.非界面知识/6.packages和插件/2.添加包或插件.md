# 使用package

插件是特殊的package，用法一样，这里只讲package了。
>具体配置等等，请看dart 官方文档-[传送门](/3.%E7%A8%8B%E5%BA%8F/1.%E5%9F%BA%E7%A1%80/2.%E5%9F%BA%E7%A1%80%E8%AF%AD%E8%A8%80/Dart/README.md)。

[TOC]

## 添加package到应用

举例：将‘css_colors’ 添加到应用。

### 方式一：配置文件添加

步骤如下:

1. 添加依赖
打开应用文件夹下的 `pubspec.yaml` 文件，然后在 `pubspec.yaml` 下添加 `css_colors:`。

2. 安装/同步
    * 命令行运行`flutter pub get`
    * 在 VS Code 中点击位于 `pubspec.yaml` 文件顶部操作功能区右侧的 `Get Packages`
      >在 Android Studio/IntelliJ 中点击 pubspec.yaml 文件顶部操作功能区的 Packages get
3. 导入
代码需要使用时，直接通过import引入。
4. 如果有必要，停止并重启应用
如果 package 内有特定平台的代码（Android 的 Java/Kotlin, iOS 的 Swift/Objective-C），代码必须内置到你的应用内。热重载和热重启只对 package 的 Dart 代码执行此操作，所以你需要完全重启应用以避免使用 package 时出现 `MissingPluginException` 错误。

### 方式二：命令添加

1. 使用命令 `flutter pub add` 添加一个 package 依赖

    ```shell
    flutter pub add css_colors
    ```

2. 使用 `flutter pub remove` 命令移除一个 package 依赖

    ```shell
    flutter pub remove css_colors
    ```

---

## 配置文件依赖详解

在 Flutter 开发中，依赖是指项目所需要的外部库或插件。这些依赖可以帮助开发者快速实现各种功能，避免重复造轮子。下面将详细介绍 Flutter 依赖的相关内容。

### 1. 依赖管理文件

Flutter 使用 `pubspec.yaml` 文件来管理项目的依赖。该文件位于项目的根目录下，包含了项目的基本信息（如名称、描述、版本等）以及依赖项列表。以下是一个简单的 `pubspec.yaml` 文件示例：

```yaml
name: my_flutter_app
description: A new Flutter application.
version: 1.0.0+1

environment:
  sdk: ">=2.12.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter
  cupertino_icons: ^1.0.2
  http: ^0.13.4

dev_dependencies:
  flutter_test:
    sdk: flutter
```

* `dependencies`：这里列出的是项目运行时所需要的依赖。
* `dev_dependencies`：列出的是开发过程中需要的依赖，如测试框架等，这些依赖在项目发布时不会被包含。

### 2. 依赖类型

#### 2.1 SDK 依赖

SDK 依赖是指依赖于 Flutter 或 Dart SDK 提供的库。例如：

```yaml
dependencies:
  flutter:
    sdk: flutter
```

这里的 `flutter` 依赖就是一个 SDK 依赖，它表示项目依赖于 Flutter SDK 提供的库。

#### 2.2 Pub 依赖

Pub 是 Dart 和 Flutter 的包管理系统，许多开源库都发布在 Pub 上。可以通过指定包名和版本号来引入 Pub 依赖。例如：

```yaml
dependencies:
  http: ^0.13.4
```

`^` 符号表示版本范围，`^0.13.4` 表示可以使用 `0.13.4` 及以上，但小于 `0.14.0` 的版本。

#### 2.3 Git 依赖

如果某个库没有发布到 Pub 上，或者你想使用某个库的特定分支或提交，可以使用 Git 依赖。例如：

```yaml
dependencies:
  my_custom_library:
    git:
      url: https://github.com/user/my_custom_library.git
      ref: master
```

  smart_home:
    version: 9.3.0+2025030505
    hosted:
      name: smart_home
      url: <http://10.163.205.239:8083>

* `url`：指定 Git 仓库的 URL。

* `ref`：指定要使用的分支、标签或提交哈希。

#### 2.4 路径依赖

当你在本地开发一个库，并且想在另一个项目中使用它时，可以使用路径依赖。例如：

```yaml
dependencies:
  my_local_library:
    path: ../my_local_library
```

`path` 指定了本地库的路径。

### 3. 依赖版本管理

#### 3.1 版本号格式

Dart 和 Flutter 使用语义化版本号，格式为 `MAJOR.MINOR.PATCH`。

* `MAJOR`：主版本号，当有不兼容的 API 更改时增加。
* `MINOR`：次版本号，当有向后兼容的功能添加时增加。
* `PATCH`：修订号，当有向后兼容的 bug 修复时增加。

#### 3.2 版本范围

除了使用具体的版本号，还可以使用版本范围来指定依赖的版本。常见的版本范围符号有：

* `^`：表示可以使用指定版本及以上，但小于下一个主版本的版本。例如 `^1.2.3` 表示可以使用 `1.2.3` 到 `2.0.0` 之间的版本。
* `>`、`<`、`>=`、`<=`：用于指定具体的版本范围。例如 `>=1.2.3 <1.3.0` 表示可以使用 `1.2.3` 到 `1.3.0` 之间的版本。

### 4. 获取依赖

在修改 `pubspec.yaml` 文件后，需要运行以下命令来获取项目的依赖：

```bash
flutter pub get
```

该命令会根据 `pubspec.yaml` 文件中的依赖信息，从 Pub 或 Git 仓库下载所需的库，并将其安装到项目的 `pubspec.lock` 文件中。

### 5. 更新依赖

如果想更新项目的依赖到最新版本，可以运行以下命令：

```bash
flutter pub upgrade
```

该命令会尝试将所有依赖更新到符合 `pubspec.yaml` 文件中指定版本范围的最新版本。

### 6. 锁定依赖版本

`pubspec.lock` 文件会锁定项目所使用的依赖的具体版本。这可以确保项目在不同环境中使用相同版本的依赖，避免因依赖版本不一致而导致的问题。在团队协作或持续集成环境中，建议将 `pubspec.lock` 文件提交到版本控制系统中
