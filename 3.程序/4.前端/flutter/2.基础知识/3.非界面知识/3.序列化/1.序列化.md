# 序列化

在Flutter中，序列化是指将数据结构转换为可传输或可存储的格式（通常是JSON或XML格式的字符串）的过程。反序列化则是将这些格式的字符串转换回原始数据结构的过程。
>flutter中的序列化，不同于android，这里是指将字符串转换为对象数据，简单来说就是json或xml的解析与生成

以下是Flutter中序列化的几种常用方法：

## 使用`dart:convert`库进行手动序列化

这是最基本的方法，适用于小型项目或快速原型开发。使用`dart:convert`库中的`jsonEncode()`和`jsonDecode()`方法。

```dart
// 序列化
String jsonString = jsonEncode(someMap);

// 反序列化
Map<String, dynamic> someMap = jsonDecode(jsonString);
```

## 使用`json_serializable`进行自动序列化

对于中到大型项目，手动编写序列化代码可能会变得繁琐且容易出错。`json_serializable`是一个自动生成序列化代码的库，它使用Dart的源代码生成功能。

添加依赖：在`pubspec.yaml`文件中添加`json_serializable`和相关依赖。

```python
dependencies:
  json_annotation: ^4.4.0

dev_dependencies:
  build_runner: ^2.1.8
  json_serializable: ^6.0.1
```

创建模型类：使用`@JsonSerializable()`注解来标记需要自动生成序列化代码的类。

```dart
import 'package:json_annotation/json_annotation.dart';

part 'user.g.dart';

@JsonSerializable()
class User {
  final String name;
  final int age;

  User(this.name, this.age);

  factory User.fromJson(Map<String, dynamic> json) => _$UserFromJson(json);
  Map<String, dynamic> toJson() => _$UserToJson(this);
}
```

生成代码：运行`flutter pub run build_runner build`来生成序列化代码。

## 使用第三方序列化库

除了json_serializable，还有其他一些库提供了类似的功能，如`built_value`。

## 注意事项

* 选择哪种序列化方法取决于项目的大小和复杂性。
* 手动序列化简单但容易出错，适合小型项目。
* 自动序列化减少了手写样板代码的工作量，适合大型项目，但需要一些初始设置。

在Flutter中，由于禁用了运行时反射，因此无法使用类似GSON/Jackson/Moshi这样的库。
