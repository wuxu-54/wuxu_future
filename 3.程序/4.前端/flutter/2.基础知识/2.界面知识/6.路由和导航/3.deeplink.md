# deeplink

在Flutter中，深度链接（Deep Link）是一种让用户能够直接跳转到应用内特定页面的技术。深度链接对于提升用户体验和应用的可发现性非常重要，尤其是在用户通过URL、二维码或其他方式访问应用内容时。

## 如何使用深度链接

### 1.定义深度链接（在Android中）

在AndroidManifest.xml文件中，定义一个Intent-filter来声明你的应用可以处理的深度链接。

```xml
<activity android:name=".MainActivity">
  <intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data android:scheme="your_custom_scheme" />
  </intent-filter>
</activity>
```

这里的your_custom_scheme是你自定义的scheme，比如myapp。

### 2.定义深度链接（在iOS中）

在Info.plist文件中，添加一个URL type并指定你的自定义scheme。

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>your_custom_scheme</string>
    </array>
  </dict>
</array>
```

### 3.在Flutter中处理深度链接

使用`uni_links`或`deep_link_navigation`这样的包可以帮助你在Flutter中处理深度链接。

```dart
import 'package:uni_links/uni_links.dart';

void initUniLinks() {
  getUniLinks()
    ..initialize()
    ..setDebugMode(true)
    ..firstLink.then((link) {
      // Handle the first deep link
    });

  getDeviceInfoLinksStream().listen((String link) {
    // Listen to incoming links
  });
}
```

### 4.在启动应用时处理深度链接

当应用通过深度链接启动时，你可以在main.dart中处理这个链接。

```dart
void main() {
  WidgetsFlutterBinding.ensureInitialized();
  initUniLinks(); // 初始化深度链接监听
  runApp(MyApp());
}
```

### 5.导航到特定页面

根据深度链接中包含的信息，你可以使用Navigator来导航到应用内的特定页面。

```dart
Future<void> handleDeepLink(String link) async {
  if (link.startsWith('your_custom_scheme://')) {
    // 解析链接并获取参数
    final page = link.split('://')[1];
    switch (page) {
      case 'somePage':
        // 导航到somePage
        break;
      // 其他页面...
    }
  }
}
```

### 6.测试深度链接

你可以使用adb命令来测试Android设备上的深度链接。

```shell
adb shell am start -W -a android.intent.action.VIEW -d "your_custom_scheme://somePage" com.example.yourapp
```

对于iOS，你可以使用Xcode的Scheme设置，或者使用CocoaPods的urlscheme来测试。

## 注意事项

* 确保你的应用支持通过深度链接启动，并且在应用商店的描述中提及这一点。
* 深度链接的scheme应该是唯一的，以避免与其他应用冲突。
* 深度链接的实现可能因平台（Android或iOS）而异，需要分别配置。
* 测试深度链接非常重要，确保它们在不同的场景下都能正常工作。

通过深度链接，你可以让用户或系统更容易地访问应用的特定功能或内容，从而提升用户体验。
