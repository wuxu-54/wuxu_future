# 焦点常用API

以下是一些核心的 `Focus` API：

## FocusNode 类

`FocusNode` 是 Flutter 中用于管理焦点状态的对象。每个 `FocusNode` 可以独立管理其焦点状态，并且可以附加到一个或多个 `Focus` widget 上。

- **创建和配置**

  ```dart
  FocusNode myFocusNode = FocusNode(
    debugLabel: 'My Focus Node', // 用于调试的标签
    skipTraversal: false, // 是否跳过焦点遍历
    onKey: (node, event) => false, // 处理按键事件
  );
  ```

- **请求焦点**

  ```dart
  myFocusNode.requestFocus();
  ```

- **释放焦点**:

  ```dart
  myFocusNode.unfocus();
  ```

- **检查焦点状态**:

  ```dart
  bool hasFocus = myFocusNode.hasFocus();
  ```

- **添加和移除监听器**:

  ```dart
  myFocusNode.addListener(listener);
  myFocusNode.removeListener(listener);
  ```

- **销毁 FocusNode**:

  ```dart
  myFocusNode.dispose();
  ```

## Focus Widget

`Focus` widget 用于将 `FocusNode` 与实际的 UI 组件关联起来。它不直接显示任何内容，但可以用来包装其他 widgets，使它们能够接收焦点。

- **使用 Focus widget**:

  ```dart
  Focus(
    child: TextField(
      decoration: InputDecoration(labelText: 'Enter your name'),
    ),
    focusNode: myFocusNode, // 将 FocusNode 与 TextField 关联
  );
  ```

## FocusScope Widget

`FocusScope` 是一个 widget，它提供了一个作用域，在这个作用域内可以管理多个 `FocusNode`。它允许你获取当前焦点、请求焦点、以及遍历焦点。

- **获取当前 FocusScope**:

  ```dart
  FocusScopeNode currentFocusScope = FocusScope.of(context);
  ```

- **请求焦点**:

  ```dart
  currentFocusScope.requestFocus(myFocusNode);
  ```

- **遍历焦点**:

  ```dart
  currentFocusScope.nextFocus(); // 移动到下一个可聚焦的 widget
  ```

- **清除焦点**:

  ```dart
  currentFocusScope.unfocus();
  ```

## FocusManager

`FocusManager` 是一个全局单例，它负责管理应用程序中的所有焦点节点。它提供了一些全局的方法来管理焦点。

- **获取当前聚焦的节点**:

  ```dart
  FocusNode currentlyFocusedNode = FocusManager.instance.primaryFocus;
  ```

- **获取下一个或上一个可聚焦的节点**:

  ```dart
  FocusNode nextFocusNode = FocusManager.instance.getNextFocus();
  ```

## 示例

以下是一个简单的示例，展示如何在 Flutter 应用中使用 `Focus` 和 `FocusNode`：

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        appBar: AppBar(
          title: Text('Focus API Example'),
        ),
        body: MyFocusWidget(),
      ),
    );
  }
}

class MyFocusWidget extends StatefulWidget {
  @override
  _MyFocusWidgetState createState() => _MyFocusWidgetState();
}

class _MyFocusWidgetState extends State<MyFocusWidget> {
  FocusNode myFocusNode = FocusNode();

  @override
  void initState() {
    super.initState();
    myFocusNode.addListener(_handleFocusChange);
  }

  void _handleFocusChange() {
    if (myFocusNode.hasFocus) {
      print('The TextField is focused.');
    }
  }

  @override
  void dispose() {
    myFocusNode.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Focus(
      child: TextField(
        decoration: InputDecoration(labelText: 'Focus on me'),
        focusNode: myFocusNode,
      ),
    );
  }
}
```

在这个示例中，我们创建了一个 `FocusNode` 并将其与一个 `TextField` 关联。我们添加了一个监听器来监听焦点变化，并在控制台打印出焦点状态。最后，我们在组件销毁时释放了 `FocusNode`。

`Focus` API 提供了丰富的方法来处理焦点逻辑，使得开发者可以构建出响应用户输入和交互的应用程序。
