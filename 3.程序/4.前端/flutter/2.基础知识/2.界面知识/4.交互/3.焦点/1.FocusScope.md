# FocusScope

`FocusScope` 是 Flutter 中管理焦点范围的组件，它提供了一种机制来组织和控制焦点行为。焦点（Focus）是用户界面中的一个概念，用于指示哪个输入字段或元素当前可以接受用户输入。

以下是 `FocusScope` 的一些关键特性和用法：

## 主要特性

1. **焦点管理**：`FocusScope` 允许你管理焦点行为，例如获取当前焦点的节点、移动焦点等。

2. **自动焦点**：当键盘弹出时，`FocusScope` 可以自动将焦点移动到第一个可聚焦的节点。

3. **焦点导航**：使用键盘的方向键可以在焦点节点之间导航。

4. **焦点范围**：`FocusScope` 可以包含多个子节点，每个子节点都可以有自己的焦点顺序。

## 隐藏软键盘

```dart
var focus1 = FocusNode();
var focus2 = FocusNode();
var text1 = TextField(
    focusNode: focus1,
  );

var text2 = TextField(
    focusNode: focus2,
  );

/*设置 获取焦点*/
FocusScope.of(context).requestFocus(focus1);
/*传入空的焦点 则隐藏键盘*/
FocusScope.of(context).requestFocus(FocusNode());
```

## 使用示例

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: FocusScope(
        child: Scaffold(
          appBar: AppBar(
            title: Text('FocusScope Example'),
          ),
          body: Column(
            children: <Widget>[
              TextFormField(
                decoration: InputDecoration(labelText: 'Field 1'),
              ),
              TextFormField(
                decoration: InputDecoration(labelText: 'Field 2'),
              ),
              ElevatedButton(
                onPressed: () {
                  // 打印当前焦点节点的信息
                  // ...
                  FocusScope.of(context).requestFocus(FocusNode());//清除焦点的一种方式
                },
                child: Text('Clear Focus'),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```

在这个示例中，`FocusScope` 包裹了整个 `Scaffold` 的主体内容，允许在其中的 `TextFormField` 之间进行焦点导航。`ElevatedButton` 的点击事件中使用了 `FocusScope.of(context).requestFocus(FocusNode())` 来清除当前的焦点，这是一种将焦点从当前节点移除的方法（或`FocusScope.of(context).unfocus();`）。

## 注意事项

- `FocusScope` 是一个抽象类，你需要使用它的具体实现，如 `Focus`。
- 使用 `FocusScope.of(context)` 可以获取给定上下文中的焦点范围。
- 焦点管理对于表单和输入字段非常重要，特别是在需要处理键盘交互时。
- 焦点顺序由 `FocusOrder` 属性控制，你可以在 `FocusScope` 中设置它来定义子节点的焦点顺序。

`FocusScope` 是 Flutter 中处理焦点逻辑的重要工具，特别是在构建需要复杂焦点交互的表单和对话框时。通过合理使用 `FocusScope`，你可以提高应用的可用性和无障碍性。

## 常用API

以下是一些常用的 `FocusScope` API 和它们的用法：

1. `FocusScope.of(BuildContext context)`
这个静态方法用于获取给定上下文中的 `FocusScope`。这通常用于与当前焦点作用域交互，例如请求或释放焦点。

    ```dart
    FocusScopeNode focusScopeNode = FocusScope.of(context);
    ```

2. `FocusScopeNode`
`FocusScopeNode` 是管理焦点的逻辑节点。它是 `FocusScope` widget 的模型部分，与之配合使用来管理焦点状态。

    - `bool hasFocus()`: 检查焦点范围是否当前具有焦点。
    - `FocusNode currentFocus()`: 获取当前焦点的节点。
    - `void unfocus()`: 清除当前焦点范围内的所有焦点。

3. `FocusScopeWidget`
`FocusScopeWidget` 是实际的 widget，它创建了一个焦点作用域。通常你不需要直接使用这个 widget，而是通过 `FocusScope.of(context)` 来与其交互。

4. `FocusScopeNode([String debugLabel = ''])`
创建一个新的 `FocusScopeNode` 实例。`debugLabel` 是一个可选参数，用于提供焦点作用域的调试标签。

5. `void setFirstFocus(FocusNode node)`
设置当前焦点作用域中的第一个焦点节点。这通常在焦点作用域首次获得焦点时调用。

6. `void dispose()`
当焦点作用域不再需要时，调用此方法来清理资源。

7. `void setFocused(bool focused)`
设置焦点作用域是否应该被认为是“聚焦”的。这会影响键盘的显示。

8. `void autofocus()`
使焦点作用域自动获得焦点。
