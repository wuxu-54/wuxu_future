# RichText

在 Flutter 中，`RichText` 是一个强大的 widget，允许你在单个文本中组合多种样式（如颜色、字体、大小、下划线等）。它通过嵌套 `TextSpan` 实现多样式文本的灵活组合。以下是 `RichText` 的详细解析和使用示例：

---

## **RichText 基础结构**

```dart
RichText(
  text: TextSpan(
    style: DefaultTextStyle.of(context).style, // 默认继承上下文样式
    children: <TextSpan>[
      TextSpan(text: 'Hello', style: TextStyle(color: Colors.red)),
      TextSpan(text: ' Flutter', style: TextStyle(fontWeight: FontWeight.bold)),
    ],
  ),
)
```

---

## **核心属性**

1. **`text`**  
   类型为 `TextSpan`，表示文本内容的根节点，可以包含子 `TextSpan`。
   - 如果同时指定 `text` 和 `children`，Flutter 会优先使用 `text`，忽略 `children`。

2. **`TextSpan` 的属性**  
   - `text`: 文本内容。
   - `style`: 文本样式（`TextStyle`），可覆盖父 `TextSpan` 的样式。
   - `recognizer`: 手势识别器（如 `TapGestureRecognizer`），用于处理点击事件。
   - `children`: 子 `TextSpan` 列表，支持嵌套结构。

---

## **示例代码**

### 1. 基础用法：多颜色和字体样式

```dart
RichText(
  text: TextSpan(
    children: [
      TextSpan(
        text: 'Hello ',
        style: TextStyle(color: Colors.red, fontSize: 20),
      ),
      TextSpan(
        text: 'Flutter ',
        style: TextStyle(
          color: Colors.blue,
          fontWeight: FontWeight.bold,
          fontStyle: FontStyle.italic,
        ),
      ),
      TextSpan(
        text: 'World!',
        style: TextStyle(
          decoration: TextDecoration.underline,
          decorationColor: Colors.green,
        ),
      ),
    ],
  ),
)
```

### 2. 点击事件处理

```dart
RichText(
  text: TextSpan(
    children: [
      TextSpan(text: '普通文本 '),
      TextSpan(
        text: '可点击文本',
        style: TextStyle(
          color: Colors.blue,
          decoration: TextDecoration.underline,
        ),
        recognizer: TapGestureRecognizer()
          ..onTap = () {
            print('文本被点击！');
            // 例如：跳转链接
            // launchUrl(Uri.parse('https://flutter.dev'));
          },
      ),
    ],
  ),
)
```

### 3. 嵌套子 TextSpan

```dart
RichText(
  text: TextSpan(
    style: TextStyle(fontSize: 16, color: Colors.black),
    children: [
      TextSpan(text: '父文本 '),
      TextSpan(
        text: '子文本1 ',
        style: TextStyle(color: Colors.orange),
        children: [
          TextSpan(
            text: '孙子文本',
            style: TextStyle(fontWeight: FontWeight.bold),
          ),
        ],
      ),
      TextSpan(text: '子文本2'),
    ],
  ),
)
```

---

## **关键注意事项**

1. **样式继承**  
   子 `TextSpan` 默认继承父 `TextSpan` 的样式，但可以通过自身的 `style` 覆盖父样式。  
   例如：父 `TextSpan` 设置 `color: Colors.red`，子 `TextSpan` 可单独设置 `color: Colors.blue`。

2. **点击事件**  
   - 必须为 `TextSpan` 设置 `recognizer`（如 `TapGestureRecognizer`）才能响应点击。
   - 确保父 widget 没有阻止事件传递（如被 `IgnorePointer` 包裹）。

3. **性能优化**  
   - 避免在频繁重建的 widget 中创建大量 `TextSpan`。
   - 复杂样式可考虑预定义 `TextStyle` 常量复用。

---

## **RichText 与 Text.rich 的关系**

`Text.rich` 是 `RichText` 的语法糖，两者功能等价：

```dart
Text.rich(
  TextSpan(
    children: [/* ... */],
  ),
)
```

---

## **适用场景**

- 需要在一行内混合不同样式的文本（如高亮关键词、链接）。
- 实现自定义文本交互（如点击部分文本跳转）。
- 构建复杂文本布局（如带图标的文本组合）。

通过 `RichText`，你可以轻松实现灵活且富有表现力的文本效果！
