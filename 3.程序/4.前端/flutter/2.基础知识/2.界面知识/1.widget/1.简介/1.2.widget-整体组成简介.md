# Widget组成

以下是 Flutter Widget 的全面详解，涵盖核心 Widget 分类、样式、属性及使用场景，帮助开发者快速掌握 Flutter UI 开发的核心工具。

---

## **一、Widget 分类**

Flutter Widget 分为 **StatelessWidget**（无状态）和 **StatefulWidget**（有状态），按功能可分为以下大类（仅是常见的，更多情况官方文档）：

| **类别**        | **核心 Widget**                          | **用途**                                  |
|------------------|------------------------------------------|------------------------------------------|
| **基础组件**     | `Text`, `Image`, `Icon`, `Container`     | 显示文本、图片、图标和容器布局             |
| **布局组件**     | `Row`, `Column`, `Stack`, `Expanded`     | 控制子 Widget 的排列方式                   |
| **交互组件**     | `ElevatedButton`, `TextButton`, `Checkbox` | 用户点击、输入等交互行为                   |
| **表单组件**     | `TextField`, `Form`, `Radio`, `Switch`    | 数据输入与验证                             |
| **滚动组件**     | `ListView`, `GridView`, `ScrollView`      | 处理长内容滚动                             |
| **容器组件**     | `Padding`, `Margin`, `Align`, `Positioned` | 调整 Widget 的位置、间距和对齐             |
| **动画组件**     | `AnimatedContainer`, `Hero`               | 实现动态过渡和复杂动画效果                 |
| **导航组件**     | `Navigator`, `PageRoute`                  | 页面跳转和管理路由堆栈                     |

---

## **二、核心 Widget 详解**

### **1. 基础组件**

#### **(1) `Text`**

- **用途**：显示简单或样式化文本。
- **核心属性**：

  ```dart
  Text(
    'Hello Flutter',
    style: TextStyle(
      fontSize: 20,
      fontWeight: FontWeight.bold,
      color: Colors.blue,
      fontFamily: 'Roboto',
    ),
    textAlign: TextAlign.center,
    maxLines: 2,
    overflow: TextOverflow.ellipsis,
  )
  ```

#### **(2) `Image`**

- **用途**：显示本地或网络图片。
- **加载方式**：

  ```dart
  Image.asset('assets/logo.png'),       // 本地资源
  Image.network('https://example.com/image.jpg'), // 网络图片
  Image.file(File('path/to/file')),     // 本地文件
  ```

- **属性**：

  ```dart
  width: 100,
  height: 100,
  fit: BoxFit.cover, // 填充模式（contain, fill, fitWidth等）
  color: Colors.blue.withOpacity(0.5), // 颜色叠加
  ```

#### **(3) `Icon`**

- **用途**：显示 Material 或自定义图标。
- **代码示例**：

  ```dart
  Icon(
    Icons.favorite,
    color: Colors.red,
    size: 30,
  )
  ```

---

### **2. 布局组件**

#### **(1) `Row` 和 `Column`**

- **用途**：水平（Row）或垂直（Column）排列子 Widget。
- **关键属性**：

  ```dart
  Row(
    mainAxisAlignment: MainAxisAlignment.spaceBetween, // 主轴对齐
    crossAxisAlignment: CrossAxisAlignment.center,      // 交叉轴对齐
    children: [Widget1, Widget2],
  )
  ```

- **搭配 Widget**：
  - `Expanded`：占满剩余空间。
  - `Spacer`：填充空白区域。
  - `Flexible`：按比例分配空间。

#### **(2) `Stack`**

- **用途**：层叠布局（类似 CSS 的绝对定位）。
- **代码示例**：

  ```dart
  Stack(
    alignment: Alignment.center, // 子 Widget 默认对齐方式
    children: [
      Container(color: Colors.blue, width: 200, height: 200),
      Positioned( // 精确控制位置
        top: 10,
        left: 10,
        child: Icon(Icons.star),
      ),
    ],
  )
  ```

---

### **3. 容器组件**

#### **(1) `Container`**

- **用途**：多功能容器，可设置尺寸、装饰、边距等。
- **核心属性**：

  ```dart
  Container(
    width: 100,
    height: 100,
    margin: EdgeInsets.all(10),      // 外边距
    padding: EdgeInsets.symmetric(vertical: 5), // 内边距
    decoration: BoxDecoration(
      color: Colors.blue,
      borderRadius: BorderRadius.circular(10),
      boxShadow: [BoxShadow(blurRadius: 5)],
    ),
    child: Text('Container'),
  )
  ```

#### **(2) `Padding`**

- **用途**：为子 Widget 添加内边距。

  ```dart
  Padding(
    padding: EdgeInsets.all(20),
    child: Text('Padded Text'),
  )
  ```

---

### **4. 交互组件**

#### **(1) `ElevatedButton`**

- **用途**：凸起的 Material 风格按钮。
- **代码示例**：

  ```dart
  ElevatedButton(
    onPressed: () => print('点击'),
    child: Text('按钮'),
    style: ElevatedButton.styleFrom(
      primary: Colors.blue,     // 背景色
      padding: EdgeInsets.all(15),
      shape: RoundedRectangleBorder( // 圆角
        borderRadius: BorderRadius.circular(10),
      ),
    ),
  )
  ```

#### **(2) `TextField`**

- **用途**：文本输入框。
- **核心属性**：

  ```dart
  TextField(
    decoration: InputDecoration(
      labelText: '用户名',
      hintText: '请输入',
      border: OutlineInputBorder(),
      prefixIcon: Icon(Icons.person),
    ),
    onChanged: (value) => print(value),
    obscureText: true, // 密码输入
    keyboardType: TextInputType.emailAddress,
  )
  ```

---

## **三、样式与主题**

### **1. 全局主题**

通过 `ThemeData` 统一应用样式：

```dart
MaterialApp(
  theme: ThemeData(
    primaryColor: Colors.blue,
    textTheme: TextTheme(
      headline1: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
    ),
    buttonTheme: ButtonThemeData(
      buttonColor: Colors.green,
    ),
  ),
)
```

### **2. 局部样式覆盖**

使用 `Theme` 组件局部修改样式：

```dart
Theme(
  data: Theme.of(context).copyWith(
    cardColor: Colors.red,
  ),
  child: Card(child: Text('局部样式')),
)
```

---

## **四、高级 Widget**

### **1. `CustomPaint`**

绘制自定义图形（如折线图、签名板）：

```dart
CustomPaint(
  painter: MyPainter(), // 实现 CustomPainter 类
  size: Size(200, 200),
)
```

### **2. `Hero`**

实现页面间共享元素的过渡动画：

```dart
// 页面1
Hero(
  tag: 'avatar',
  child: Image.asset('assets/user.png'),
)

// 页面2
Hero(
  tag: 'avatar',
  child: Image.asset('assets/user.png'),
)
```

---

## **五、性能优化**

1. **使用 `const` 构造函数**：

   ```dart
   const Text('不可变文本') // 减少 Widget 重建
   ```

2. **避免过度重建**：通过 `const`、`shouldRepaint` 或 `shouldRebuild` 优化。

3. **懒加载列表**：使用 `ListView.builder` 替代 `ListView`。

---

## **六、常见 Widget 组合示例**

### **1. 卡片列表**

```dart
ListView.builder(
  itemCount: 10,
  itemBuilder: (context, index) => Card(
    child: ListTile(
      leading: Icon(Icons.person),
      title: Text('用户 $index'),
      trailing: Icon(Icons.arrow_forward),
    ),
  ),
)
```

### **2. 表单验证**

```dart
final _formKey = GlobalKey<FormState>();

Form(
  key: _formKey,
  child: Column(
    children: [
      TextFormField(
        validator: (value) => value!.isEmpty ? '必填字段' : null,
      ),
      ElevatedButton(
        onPressed: () => _formKey.currentState!.validate(),
        child: Text('提交'),
      ),
    ],
  ),
)
```

---

## **七、常见问题**

### **1. 如何实现圆角图片？**

```dart
Container(
  width: 100,
  height: 100,
  decoration: BoxDecoration(
    borderRadius: BorderRadius.circular(10),
    image: DecorationImage(
      image: NetworkImage('https://example.com/image.jpg'),
      fit: BoxFit.cover,
    ),
  ),
)
```

### **2. 如何处理 Widget 溢出？**

- 使用 `SingleChildScrollView` 包裹内容。
- 限制父容器尺寸（如 `SizedBox`）。

---

## **总结**

- **核心原则**：Flutter 一切皆 Widget，通过组合实现复杂 UI。
- **灵活定制**：利用 `decoration`、`style` 和主题系统调整样式。
- **性能优先**：合理使用 `const` 和懒加载优化应用性能。

掌握这些 Widget 及其属性，可以高效构建美观且流畅的 Flutter 应用。
